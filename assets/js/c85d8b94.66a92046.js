"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[3040],{5943:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"fixes/WRITEBACK_CONFIGURATION_TODO","title":"WriteBack Configuration Refactoring TODO","description":"Overview","source":"@site/docs/fixes/WRITEBACK_CONFIGURATION_TODO.md","sourceDirName":"fixes","slug":"/fixes/WRITEBACK_CONFIGURATION_TODO","permalink":"/docs/fixes/WRITEBACK_CONFIGURATION_TODO","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/fixes/WRITEBACK_CONFIGURATION_TODO.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Styling Consolidation Summary","permalink":"/docs/fixes/STYLING_CONSOLIDATION"},"next":{"title":"Fix voor saveObjects inversedBy relaties","permalink":"/docs/fixes/fix_saveObjects_inversedBy"}}');var t=r(74848),s=r(28453);const c={},d="WriteBack Configuration Refactoring TODO",o={},l=[{value:"Overview",id:"overview",level:2},{value:"Current Issue",id:"current-issue",level:2},{value:"Files Modified with TODO Comments",id:"files-modified-with-todo-comments",level:2},{value:"1. <code>lib/Service/ObjectService.php</code>",id:"1-libserviceobjectservicephp",level:3},{value:"2. <code>lib/Service/ObjectHandlers/SaveObject.php</code>",id:"2-libserviceobjecthandlerssaveobjectphp",level:3},{value:"3. <code>lib/Service/ObjectHandlers/RenderObject.php</code>",id:"3-libserviceobjecthandlersrenderobjectphp",level:3},{value:"4. <code>lib/Service/ObjectHandlers/ValidateObject.php</code>",id:"4-libserviceobjecthandlersvalidateobjectphp",level:3},{value:"5. <code>lib/Db/Schema.php</code>",id:"5-libdbschemaphp",level:3},{value:"Properties to Move",id:"properties-to-move",level:2},{value:"Current Structure (to be changed)",id:"current-structure-to-be-changed",level:2},{value:"Target Structure (after refactoring)",id:"target-structure-after-refactoring",level:2},{value:"Impact",id:"impact",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"writeback-configuration-refactoring-todo",children:"WriteBack Configuration Refactoring TODO"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["The current implementation stores ",(0,t.jsx)(n.code,{children:"writeBack"}),", ",(0,t.jsx)(n.code,{children:"removeAfterWriteBack"}),", and ",(0,t.jsx)(n.code,{children:"inversedBy"})," properties in the ",(0,t.jsx)(n.code,{children:"items"})," property of array-type schema properties. However, these configuration values should be moved to a dedicated ",(0,t.jsx)(n.code,{children:"configuration"})," property for better organization and consistency."]}),"\n",(0,t.jsx)(n.h2,{id:"current-issue",children:"Current Issue"}),"\n",(0,t.jsxs)(n.p,{children:["Looking at the ",(0,t.jsx)(n.code,{children:"EditSchema.vue"})," component, it's clear that these configuration options are not available in the UI for array properties, and the current schema structure is inconsistent."]}),"\n",(0,t.jsx)(n.h2,{id:"files-modified-with-todo-comments",children:"Files Modified with TODO Comments"}),"\n",(0,t.jsxs)(n.h3,{id:"1-libserviceobjectservicephp",children:["1. ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectService.php"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 823"}),": Added TODO comment for pre-validation cascading"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 2438"}),": Added TODO comment in ",(0,t.jsx)(n.code,{children:"handlePreValidationCascading"})," method docblock"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 2469"}),": Added TODO comment for inversedBy properties filtering"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"2-libserviceobjecthandlerssaveobjectphp",children:["2. ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/SaveObject.php"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 415"}),": Added TODO comment in ",(0,t.jsx)(n.code,{children:"cascadeObjects"})," method docblock"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 433"}),": Added TODO comment for cascade objects logic"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 450"}),": Added TODO comment for array properties logic"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 708"}),": Added TODO comment in ",(0,t.jsx)(n.code,{children:"handleInverseRelationsWriteBack"})," method docblock"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 718"}),": Added TODO comment for writeBack properties filtering"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"3-libserviceobjecthandlersrenderobjectphp",children:["3. ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/RenderObject.php"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 777"}),": Added TODO comment in ",(0,t.jsx)(n.code,{children:"getInversedProperties"})," method docblock"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 785"}),": Added TODO comment for inversedBy properties filtering"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"4-libserviceobjecthandlersvalidateobjectphp",children:["4. ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/ValidateObject.php"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 268"}),": Added TODO comment in ",(0,t.jsx)(n.code,{children:"transformPropertyForOpenRegister"})," method docblock"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 269"}),": Added TODO comment for inversedBy relationships handling"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 342"}),": Added TODO comment for array items inversedBy handling"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"5-libdbschemaphp",children:["5. ",(0,t.jsx)(n.code,{children:"lib/Db/Schema.php"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 340"}),": Added TODO comment for inversedBy properties normalization"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 465"}),": Added TODO comment in ",(0,t.jsx)(n.code,{children:"normalizeInversedByProperties"})," method docblock"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 473"}),": Added TODO comment for regular object properties handling"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Line 482"}),": Added TODO comment for array items handling"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"properties-to-move",children:"Properties to Move"}),"\n",(0,t.jsxs)(n.p,{children:["The following properties should be moved from ",(0,t.jsx)(n.code,{children:"items"})," to ",(0,t.jsx)(n.code,{children:"configuration"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"writeBack"})})," - Controls whether the property should be processed by write-back logic"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"removeAfterWriteBack"})})," - Controls whether the property should be removed from source after write-back"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"inversedBy"})})," - Specifies the property name on the target object for inverse relationships"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"current-structure-to-be-changed",children:"Current Structure (to be changed)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "properties": {\n    "deelnemers": {\n      "type": "array",\n      "items": {\n        "writeBack": true,\n        "removeAfterWriteBack": true,\n        "inversedBy": "deelnames"\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"target-structure-after-refactoring",children:"Target Structure (after refactoring)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "properties": {\n    "deelnemers": {\n      "type": "array",\n      "configuration": {\n        "writeBack": true,\n        "removeAfterWriteBack": true,\n        "inversedBy": "deelnames"\n      },\n      "items": {\n        "type": "object",\n        "$ref": "#/components/schemas/organisatie"\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"impact",children:"Impact"}),"\n",(0,t.jsx)(n.p,{children:"This refactoring will:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Make the schema structure more consistent"}),"\n",(0,t.jsxs)(n.li,{children:["Enable proper UI configuration in ",(0,t.jsx)(n.code,{children:"EditSchema.vue"})]}),"\n",(0,t.jsx)(n.li,{children:"Separate configuration from data structure"}),"\n",(0,t.jsx)(n.li,{children:"Improve code maintainability"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Update the frontend ",(0,t.jsx)(n.code,{children:"EditSchema.vue"})," component to support configuration properties"]}),"\n",(0,t.jsxs)(n.li,{children:["Update all backend handlers to read from ",(0,t.jsx)(n.code,{children:"configuration"})," instead of ",(0,t.jsx)(n.code,{children:"items"})]}),"\n",(0,t.jsx)(n.li,{children:"Create migration script for existing schemas"}),"\n",(0,t.jsx)(n.li,{children:"Update documentation"}),"\n",(0,t.jsx)(n.li,{children:"Add comprehensive tests for the new structure"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>d});var i=r(96540);const t={},s=i.createContext(t);function c(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);