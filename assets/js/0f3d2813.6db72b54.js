"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[6670],{16767:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"development/api/files","title":"File Upload API","description":"Multipart File Upload Endpoint","source":"@site/docs/development/api/files.md","sourceDirName":"development/api","slug":"/development/api/files","permalink":"/docs/development/api/files","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/development/api/files.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Text Extraction Refactoring Summary","permalink":"/docs/development/text-extraction-refactoring"},"next":{"title":"Bulk Import Deduplication System","permalink":"/docs/development/bulk-import-deduplication"}}');var l=n(74848),s=n(28453);const t={},a="File Upload API",o={},d=[{value:"Multipart File Upload Endpoint",id:"multipart-file-upload-endpoint",level:2},{value:"Endpoint",id:"endpoint",level:3},{value:"Required Parameters",id:"required-parameters",level:3},{value:"Usage Example (Frontend)",id:"usage-example-frontend",level:3},{value:"Why This Change?",id:"why-this-change",level:3},{value:"Expected Behavior",id:"expected-behavior",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Upload Validation",id:"upload-validation",level:4},{value:"Error Messages",id:"error-messages",level:4},{value:"Best Practices",id:"best-practices",level:4}];function c(e){const i={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.header,{children:(0,l.jsx)(i.h1,{id:"file-upload-api",children:"File Upload API"})}),"\n",(0,l.jsx)(i.h2,{id:"multipart-file-upload-endpoint",children:"Multipart File Upload Endpoint"}),"\n",(0,l.jsx)(i.p,{children:"The frontend now uses the '/filesMultipart' endpoint for uploading files to objects. This change ensures compatibility with the backend's 'createMultipart' method in the FilesController, which is designed to handle multipart file uploads."}),"\n",(0,l.jsx)(i.h3,{id:"endpoint",children:"Endpoint"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["POST ",(0,l.jsx)(i.code,{children:"/index.php/apps/openregister/api/objects/{register}/{schema}/{objectId}/filesMultipart"})]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"required-parameters",children:"Required Parameters"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"'register': Register ID (string or number)"}),"\n",(0,l.jsx)(i.li,{children:"'schema': Schema ID (string or number)"}),"\n",(0,l.jsx)(i.li,{children:"'objectId': Object ID (string or number)"}),"\n",(0,l.jsx)(i.li,{children:"'files': Array of File objects (multipart form-data)"}),"\n",(0,l.jsx)(i.li,{children:"'tags': Optional, comma-separated string of tags"}),"\n",(0,l.jsx)(i.li,{children:"'share': Optional, boolean (true/false)"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"usage-example-frontend",children:"Usage Example (Frontend)"}),"\n",(0,l.jsx)(i.p,{children:"Use FormData to append files, tags, and share flag, then POST to the endpoint. The frontend store's 'uploadFiles' action handles this automatically."}),"\n",(0,l.jsx)(i.h3,{id:"why-this-change",children:"Why This Change?"}),"\n",(0,l.jsx)(i.p,{children:"The previous endpoint ('/files') did not support multipart file uploads as required by the backend. The '/filesMultipart' endpoint is mapped to the 'createMultipart' method in the FilesController, which processes uploaded files correctly."}),"\n",(0,l.jsx)(i.h3,{id:"expected-behavior",children:"Expected Behavior"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Files are uploaded and attached to the specified object."}),"\n",(0,l.jsx)(i.li,{children:"Tags and share flag are processed if provided."}),"\n",(0,l.jsx)(i.li,{children:"The backend returns a JSON response with the upload result."}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(i.p,{children:"The file upload endpoint includes comprehensive error handling to prevent data corruption and provide clear feedback:"}),"\n",(0,l.jsx)(i.h4,{id:"upload-validation",children:"Upload Validation"}),"\n",(0,l.jsx)(i.p,{children:"Before processing any file, the system validates:"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Upload Errors"}),": Checks for PHP upload errors (size limits, partial uploads, etc.)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"File Existence"}),": Verifies the temporary file exists and is readable"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Content Reading"}),": Ensures file content can be read successfully"]}),"\n"]}),"\n",(0,l.jsx)(i.h4,{id:"error-messages",children:"Error Messages"}),"\n",(0,l.jsx)(i.p,{children:"If an error occurs during upload, you'll receive a detailed error message:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.code,{children:"File upload error for {filename}: The uploaded file exceeds the upload_max_filesize directive in php.ini"})}),"\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.code,{children:"Temporary file not found or not readable for: {filename}"})}),"\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.code,{children:"Failed to read uploaded file content for: {filename}"})}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"These validations prevent issues such as:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Database constraint violations in the versioning system"}),"\n",(0,l.jsx)(i.li,{children:"Corruption from partial file uploads"}),"\n",(0,l.jsx)(i.li,{children:"Silent failures when temporary files are inaccessible"}),"\n"]}),"\n",(0,l.jsx)(i.h4,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Always check the response for error messages"}),"\n",(0,l.jsx)(i.li,{children:"Handle errors gracefully in your frontend application"}),"\n",(0,l.jsx)(i.li,{children:"Consider implementing retry logic for transient failures"}),"\n",(0,l.jsx)(i.li,{children:"Monitor server logs for patterns in upload failures"}),"\n"]}),"\n",(0,l.jsx)(i.hr,{}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.em,{children:"This documentation was last updated to reflect improved error handling in the file upload process."})})]})}function p(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>t,x:()=>a});var r=n(96540);const l={},s=r.createContext(l);function t(e){const i=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(s.Provider,{value:i},e.children)}}}]);