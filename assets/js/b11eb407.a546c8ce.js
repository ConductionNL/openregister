(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[2119],{7411:()=>{},28453:(e,n,i)=>{"use strict";i.d(n,{R:()=>a,x:()=>c});var s=i(96540);const t={},r=s.createContext(t);function a(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(r.Provider,{value:n},e.children)}},28825:()=>{},35920:(e,n,i)=>{"use strict";i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Features/objects","title":"Objects","description":"An overview of how core concepts in Open Register interact with each other.","source":"@site/docs/Features/objects.md","sourceDirName":"Features","slug":"/Features/objects","permalink":"/docs/Features/objects","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/Features/objects.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Objects","sidebar_position":3,"description":"An overview of how core concepts in Open Register interact with each other.","keywords":["Open Register","Core Concepts","Relationships"]},"sidebar":"tutorialSidebar","previous":{"title":"Schemas","permalink":"/docs/Features/schemas"},"next":{"title":"Sources","permalink":"/docs/Features/sources"}}');var t=i(74848),r=i(28453);i(45673),i(65537),i(79329);const a={title:"Objects",sidebar_position:3,description:"An overview of how core concepts in Open Register interact with each other.",keywords:["Open Register","Core Concepts","Relationships"]},c="Objects",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Object Structure",id:"object-structure",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Schema Validation",id:"schema-validation",level:3},{value:"Relations &amp; Nesting",id:"relations--nesting",level:3},{value:"Version Control",id:"version-control",level:3},{value:"Access Control",id:"access-control",level:3},{value:"File Attachments",id:"file-attachments",level:3},{value:"API Operations",id:"api-operations",level:2},{value:"Object Locking and Versioning",id:"object-locking-and-versioning",level:2},{value:"Version Control and Revert Functionality",id:"version-control-and-revert-functionality",level:3},{value:"Locking Objects",id:"locking-objects",level:3},{value:"Object Locking Sequence",id:"object-locking-sequence",level:4},{value:"Object Deletion States",id:"object-deletion-states",level:3},{value:"Object Relations",id:"object-relations",level:2},{value:"Schema Property Configuration Options",id:"schema-property-configuration-options",level:3},{value:"For Single Objects (type: &#39;object&#39;)",id:"for-single-objects-type-object",level:4},{value:"For Arrays of Objects (type: &#39;array&#39;)",id:"for-arrays-of-objects-type-array",level:4},{value:"Schema Reference Configuration (<code>$ref</code> and <code>register</code>)",id:"schema-reference-configuration-ref-and-register",level:2},{value:"<code>$ref</code> Property",id:"ref-property",level:3},{value:"<code>register</code> Property",id:"register-property",level:3},{value:"Complete Configuration Example",id:"complete-configuration-example",level:3},{value:"Use Cases",id:"use-cases",level:3},{value:"Object Handling Types",id:"object-handling-types",level:2},{value:"1. Nested Object (<code>nested-object</code>)",id:"1-nested-object-nested-object",level:3},{value:"2. Nested Schema (<code>nested-schema</code>)",id:"2-nested-schema-nested-schema",level:3},{value:"3. Related Schema (<code>related-schema</code>)",id:"3-related-schema-related-schema",level:3},{value:"4. URI Reference (<code>uri</code>)",id:"4-uri-reference-uri",level:3},{value:"Handling Type Comparison",id:"handling-type-comparison",level:2},{value:"When to Use Each Type",id:"when-to-use-each-type",level:2},{value:"Use <strong>Nested Object</strong> when:",id:"use-nested-object-when",level:3},{value:"Use <strong>Nested Schema</strong> when:",id:"use-nested-schema-when",level:3},{value:"Use <strong>Related Schema</strong> when:",id:"use-related-schema-when",level:3},{value:"Use <strong>URI Reference</strong> when:",id:"use-uri-reference-when",level:3},{value:"Inverse Relations",id:"inverse-relations",level:2},{value:"How Inverse Relations Work",id:"how-inverse-relations-work",level:3},{value:"Basic Example: Person and Addresses",id:"basic-example-person-and-addresses",level:3},{value:"Advanced Example: Organisation Communities",id:"advanced-example-organisation-communities",level:3},{value:"Inverse Relations with Write-Back",id:"inverse-relations-with-write-back",level:2},{value:"How Inverse Relations Write-Back Works",id:"how-inverse-relations-write-back-works",level:3},{value:"Community/Deelnemers Example",id:"communitydeelnemers-example",level:3},{value:"Import Process Benefits",id:"import-process-benefits",level:3},{value:"Backend Implementation Details",id:"backend-implementation-details",level:3},{value:"Relation Types Summary",id:"relation-types-summary",level:2},{value:"1. Inverse Relations (<code>inversedBy</code>)",id:"1-inverse-relations-inversedby",level:3},{value:"2. Inverse Relations with Write-Back (<code>inversedBy</code> + <code>writeBack: true</code>)",id:"2-inverse-relations-with-write-back-inversedby--writeback-true",level:3},{value:"3. Cascade Relations (<code>inversedBy</code> with <code>objectConfiguration</code>)",id:"3-cascade-relations-inversedby-with-objectconfiguration",level:3},{value:"When to Use Each Type",id:"when-to-use-each-type-1",level:3},{value:"Benefits of Inverse Relations",id:"benefits-of-inverse-relations",level:3},{value:"Backend Implementation Details",id:"backend-implementation-details-1",level:3},{value:"Core Files and Their Responsibilities",id:"core-files-and-their-responsibilities",level:4},{value:"How Inverse Relations Are Processed",id:"how-inverse-relations-are-processed",level:4},{value:"Development Notes for Future Work",id:"development-notes-for-future-work",level:4},{value:"UUID Relations and Automatic Detection",id:"uuid-relations-and-automatic-detection",level:2},{value:"Automatic Relation Detection",id:"automatic-relation-detection",level:3},{value:"Relations Storage",id:"relations-storage",level:3},{value:"Extending Objects with Related Data",id:"extending-objects-with-related-data",level:2},{value:"Basic Extension",id:"basic-extension",level:3},{value:"Nested Extension",id:"nested-extension",level:3},{value:"Cascade Delete",id:"cascade-delete",level:2},{value:"Complete Example: Blog System",id:"complete-example-blog-system",level:2},{value:"Blog Schema",id:"blog-schema",level:3},{value:"Post Schema",id:"post-schema",level:3},{value:"Creating a Blog",id:"creating-a-blog",level:3},{value:"Summary",id:"summary",level:2},{value:"Technical Implementation",id:"technical-implementation",level:2},{value:"Architecture Overview",id:"architecture-overview",level:3},{value:"Object Lifecycle",id:"object-lifecycle",level:3},{value:"Object Creation Flow",id:"object-creation-flow",level:4},{value:"Object Update Flow",id:"object-update-flow",level:4},{value:"Object Retrieval Flow",id:"object-retrieval-flow",level:4},{value:"Database Schema",id:"database-schema",level:3},{value:"Relations Storage",id:"relations-storage-1",level:3},{value:"Event System",id:"event-system",level:3},{value:"Solr Integration",id:"solr-integration",level:3},{value:"Performance Optimizations",id:"performance-optimizations",level:3},{value:"Bulk Operations",id:"bulk-operations",level:4},{value:"Smart Deduplication System",id:"smart-deduplication-system",level:4},{value:"Bulk Import Performance",id:"bulk-import-performance",level:4},{value:"Caching",id:"caching",level:4},{value:"Validation System",id:"validation-system",level:3},{value:"Metadata Extraction",id:"metadata-extraction",level:3},{value:"File Attachments",id:"file-attachments-1",level:3},{value:"Access Control",id:"access-control-1",level:3},{value:"Code Examples",id:"code-examples",level:3},{value:"Creating an Object",id:"creating-an-object",level:4},{value:"Querying Objects",id:"querying-objects",level:4},{value:"Updating an Object",id:"updating-an-object",level:4},{value:"Deleting an Object",id:"deleting-an-object",level:4},{value:"Testing",id:"testing",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"objects",children:"Objects"})}),"\n",(0,t.jsx)(n.p,{children:"Objects are the core data entities in OpenRegister that store and manage structured information. This document explains everything you need to know about working with objects."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"An object in OpenRegister represents a single record of data that:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Conforms to a defined schema"}),"\n",(0,t.jsx)(n.li,{children:"Belongs to a specific register"}),"\n",(0,t.jsx)(n.li,{children:"Has a unique UUID identifier"}),"\n",(0,t.jsx)(n.li,{children:"Can contain nested objects and file attachments"}),"\n",(0,t.jsx)(n.li,{children:"Maintains version history through audit logs"}),"\n",(0,t.jsx)(n.li,{children:"Can be linked to other objects via relations"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"object-structure",children:"Object Structure"}),"\n",(0,t.jsx)(n.p,{children:"Each object contains:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"id"}),": Unique UUID identifier"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"uri"}),": Absolute URL to access the object"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"version"}),": Semantic version number (e.g. 1.0.0)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"register"}),": The register this object belongs to"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"schema"}),": The schema this object must conform to"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"object"}),": The actual data payload as JSON"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"files"}),": Array of related file IDs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"relations"}),": Array of related object IDs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"textRepresentation"}),": Text representation of the object"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"locked"}),": Lock status and details"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"owner"}),": Nextcloud user that owns the object"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"authorization"}),": JSON object describing access permissions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"updated"}),": Last modification timestamp"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"created"}),": Creation timestamp"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,t.jsx)(n.h3,{id:"schema-validation",children:"Schema Validation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Objects are validated against their schema definition"}),"\n",(0,t.jsx)(n.li,{children:"Supports both soft and hard validation modes"}),"\n",(0,t.jsx)(n.li,{children:"Ensures data integrity and consistency"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"relations--nesting",children:"Relations & Nesting"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Objects can reference other objects via UUIDs or URLs"}),"\n",(0,t.jsx)(n.li,{children:"Supports nested object structures up to configured depth"}),"\n",(0,t.jsx)(n.li,{children:"Maintains bidirectional relationship tracking"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"version-control",children:"Version Control"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Automatic version incrementing"}),"\n",(0,t.jsx)(n.li,{children:"Full audit trail of changes"}),"\n",(0,t.jsx)(n.li,{children:"Historical version access"}),"\n",(0,t.jsx)(n.li,{children:"Ability to revert to any previous version"}),"\n",(0,t.jsx)(n.li,{children:"Detailed change tracking between versions"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"access-control",children:"Access Control"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Object-level ownership"}),"\n",(0,t.jsx)(n.li,{children:"Granular authorization rules"}),"\n",(0,t.jsx)(n.li,{children:"Lock mechanism for concurrent access control"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"file-attachments",children:"File Attachments"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Support for file attachments"}),"\n",(0,t.jsx)(n.li,{children:"Secure file storage integration"}),"\n",(0,t.jsx)(n.li,{children:"File metadata tracking"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"api-operations",children:"API Operations"}),"\n",(0,t.jsx)(n.p,{children:"Objects support standard CRUD operations:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Create new objects"}),"\n",(0,t.jsx)(n.li,{children:"Read existing objects"}),"\n",(0,t.jsx)(n.li,{children:"Update object data"}),"\n",(0,t.jsx)(n.li,{children:"Delete objects"}),"\n",(0,t.jsx)(n.li,{children:"Search and filter objects"}),"\n",(0,t.jsx)(n.li,{children:"Export object data"}),"\n",(0,t.jsx)(n.li,{children:"Revert to previous versions"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"object-locking-and-versioning",children:"Object Locking and Versioning"}),"\n",(0,t.jsx)(n.h3,{id:"version-control-and-revert-functionality",children:"Version Control and Revert Functionality"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister provides comprehensive version control capabilities:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Every change creates a new version with full audit trail"}),"\n",(0,t.jsx)(n.li,{children:"Changes are tracked at the field level"}),"\n",(0,t.jsx)(n.li,{children:"Previous versions can be viewed and compared"}),"\n",(0,t.jsx)(n.li,{children:"Objects can be reverted to any historical version"}),"\n",(0,t.jsx)(n.li,{children:"Revert operation creates new version rather than overwriting"}),"\n",(0,t.jsx)(n.li,{children:"Audit logs maintain full history of all changes including reverts"}),"\n",(0,t.jsx)(n.li,{children:"Revert includes all object properties including relations and files"}),"\n",(0,t.jsx)(n.li,{children:"Batch revert operations supported for related objects"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"locking-objects",children:"Locking Objects"}),"\n",(0,t.jsx)(n.p,{children:"Objects can be locked to prevent concurrent modifications. This is useful when:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Long-running processes need exclusive access"}),"\n",(0,t.jsx)(n.li,{children:"Multiple users/systems are working on the same object"}),"\n",(0,t.jsx)(n.li,{children:"Ensuring data consistency during complex updates"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"object-locking-sequence",children:"Object Locking Sequence"}),"\n",(0,t.jsx)(n.p,{children:"The following diagram illustrates the object locking process:"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant User\n    participant API\n    participant Service as ObjectService\n    participant Entity as ObjectEntity\n    participant DB as Database\n\n    Note over User,DB: Lock Object\n    User->>API: Request lock object\n    activate API\n    API->>Service: lockObject(id, process?, duration?)\n    activate Service\n    Service->>DB: find object\n    activate DB\n    DB--\x3e>Service: return object\n    deactivate DB\n    Service->>Entity: lock(user, process?, duration?)\n    activate Entity\n    Entity->>Entity: check if already locked\n    Entity->>Entity: validate user permissions\n    Entity->>Entity: create/update lock metadata\n    Entity--\x3e>Service: return success\n    deactivate Entity\n    Service->>DB: update object\n    activate DB\n    DB--\x3e>Service: confirm update\n    deactivate DB\n    Service--\x3e>API: return locked object\n    deactivate Service\n    API--\x3e>User: return success\n    deactivate API\n\n    Note over Entity: Lock automatically expires<br/>after duration passes\n\n    Note over User,DB: Update Locked Object\n    User->>API: Update object\n    activate API\n    API->>Service: updateObject(id, data)\n    activate Service\n    Service->>DB: find object\n    activate DB\n    DB--\x3e>Service: return object\n    deactivate DB\n    Service->>Entity: validate lock\n    activate Entity\n    Entity->>Entity: check lock ownership\n    Entity->>Entity: extend lock duration\n    Entity--\x3e>Service: validation ok\n    deactivate Entity\n    Service->>DB: update object\n    activate DB\n    DB--\x3e>Service: confirm update\n    deactivate DB\n    Service--\x3e>API: return updated object\n    deactivate Service\n    API--\x3e>User: return success\n    deactivate API\n\n    Note over User,DB: Unlock Object\n    User->>API: Request unlock object\n    activate API\n    API->>Service: unlockObject(id)\n    activate Service\n    Service->>DB: find object\n    activate DB\n    DB--\x3e>Service: return object\n    deactivate DB\n    Service->>Entity: unlock(user)\n    activate Entity\n    Entity->>Entity: validate lock ownership\n    Entity->>Entity: remove lock metadata\n    Entity--\x3e>Service: return success\n    deactivate Entity\n    Service->>DB: update object\n    activate DB\n    DB--\x3e>Service: confirm update\n    deactivate DB\n    Service--\x3e>API: return unlocked object\n    deactivate Service\n    API--\x3e>User: return success\n    deactivate API"}),"\n",(0,t.jsx)(n.h3,{id:"object-deletion-states",children:"Object Deletion States"}),"\n",(0,t.jsx)(n.p,{children:"Objects in OpenRegister follow a lifecycle with soft deletion and purging capabilities:"}),"\n",(0,t.jsx)(n.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e Active\n    Active --\x3e SoftDeleted: delete()\n    SoftDeleted --\x3e Active: restore()\n    SoftDeleted --\x3e PendingPurge: retention period expired\n    PendingPurge --\x3e [*]: purge()\n    \n    note right of Active\n        Object is fully accessible\n        deleted = null\n    end note\n    \n    note right of SoftDeleted\n        Object hidden from queries\n        deleted = timestamp\n    end note\n    \n    note right of PendingPurge\n        Object ready for removal\n        current date > purgeDate\n    end note"}),"\n",(0,t.jsx)(n.h2,{id:"object-relations",children:"Object Relations"}),"\n",(0,t.jsx)(n.p,{children:"Objects in OpenRegister support sophisticated relationships through schema definitions. The way objects relate to each other depends on how you configure properties in your schema."}),"\n",(0,t.jsx)(n.h3,{id:"schema-property-configuration-options",children:"Schema Property Configuration Options"}),"\n",(0,t.jsx)(n.p,{children:"When defining a property in a schema that references other objects, you have several configuration options:"}),"\n",(0,t.jsx)(n.h4,{id:"for-single-objects-type-object",children:"For Single Objects (type: 'object')"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "type": "object",\n  "objectConfiguration": {\n    "handling": "nested-object" // or "nested-schema", "related-schema", "uri"\n  },\n  "$ref": "schema-id-or-slug",\n  "inversedBy": "property-name",\n  "register": "register-id-or-slug",\n  "cascadeDelete": true\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"for-arrays-of-objects-type-array",children:"For Arrays of Objects (type: 'array')"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "type": "array",\n  "items": {\n    "type": "object",\n    "$ref": "schema-id-or-slug",\n    "inversedBy": "property-name",\n    "register": "register-id-or-slug",\n    "cascadeDelete": true\n  },\n  "objectConfiguration": {\n    "handling": "nested-object" // or "nested-schema", "related-schema", "uri"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"schema-reference-configuration-ref-and-register",children:["Schema Reference Configuration (",(0,t.jsx)(n.code,{children:"$ref"})," and ",(0,t.jsx)(n.code,{children:"register"}),")"]}),"\n",(0,t.jsx)(n.p,{children:"When defining object relationships in your schema properties, OpenRegister uses two key configuration options to determine where and how to store or reference related objects:"}),"\n",(0,t.jsxs)(n.h3,{id:"ref-property",children:[(0,t.jsx)(n.code,{children:"$ref"})," Property"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"$ref"})," property specifies which schema the related object should conform to. The backend supports two formats:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Simple schema reference"}),": Just the schema ID or name"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'"$ref": "organisation-schema"\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Path-based reference"}),": A path where the schema name is extracted from the last segment"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'"$ref": "path/to/organisation-schema"\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Backend Resolution Logic:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If ",(0,t.jsx)(n.code,{children:"$ref"})," contains a ",(0,t.jsx)(n.code,{children:"/"}),", the backend extracts everything after the last slash"]}),"\n",(0,t.jsx)(n.li,{children:"Otherwise, it uses the value directly as the schema identifier"}),"\n",(0,t.jsxs)(n.li,{children:["This value is passed as the ",(0,t.jsx)(n.code,{children:"schema"})," parameter when creating or updating related objects"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"register-property",children:[(0,t.jsx)(n.code,{children:"register"})," Property"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"register"})," property specifies which register the related object belongs to:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'"register": "my-register-id"\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Backend Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If ",(0,t.jsx)(n.code,{children:"register"})," is specified, related objects are created/updated in that register"]}),"\n",(0,t.jsxs)(n.li,{children:["If ",(0,t.jsx)(n.code,{children:"register"})," is omitted, the current object's register is used as the default"]}),"\n",(0,t.jsx)(n.li,{children:"This ensures related objects can be stored in different registers if needed"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"complete-configuration-example",children:"Complete Configuration Example"}),"\n",(0,t.jsx)(n.p,{children:"Here's how these properties work together in a schema configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "properties": {\n    "deelnemers": {\n      "type": "array",\n      "items": {\n        "$ref": "organisation-schema",\n        "register": "organisations-register",\n        "inversedBy": "deelnames",\n        "writeBack": true,\n        "removeAfterWriteBack": true\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What happens when saving:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Backend identifies that ",(0,t.jsx)(n.code,{children:"deelnemers"})," contains organization objects"]}),"\n",(0,t.jsxs)(n.li,{children:["Uses ",(0,t.jsx)(n.code,{children:"organisation-schema"})," to validate and structure the objects"]}),"\n",(0,t.jsxs)(n.li,{children:["Stores/updates objects in the ",(0,t.jsx)(n.code,{children:"organisations-register"})]}),"\n",(0,t.jsxs)(n.li,{children:["Sets up inverse relations via the ",(0,t.jsx)(n.code,{children:"deelnames"})," property"]}),"\n",(0,t.jsx)(n.li,{children:"Handles write-back operations as configured"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Same Register Relations:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "community": {\n    "type": "object",\n    "$ref": "community-schema"\n    // register omitted - uses current object\'s register\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cross-Register Relations:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "members": {\n    "type": "array",\n    "items": {\n      "$ref": "person-schema",\n      "register": "people-register",\n      "inversedBy": "communities"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"This configuration system allows for flexible object relationships while maintaining proper data organization across different registers and schemas."}),"\n",(0,t.jsx)(n.h2,{id:"object-handling-types",children:"Object Handling Types"}),"\n",(0,t.jsxs)(n.p,{children:["When defining object relationships in your schema properties, you can specify how related objects should be handled using the ",(0,t.jsx)(n.code,{children:"handling"})," configuration option within ",(0,t.jsx)(n.code,{children:"objectConfiguration"}),". OpenRegister supports four different handling types, each with specific behaviors for storage and retrieval:"]}),"\n",(0,t.jsxs)(n.h3,{id:"1-nested-object-nested-object",children:["1. Nested Object (",(0,t.jsx)(n.code,{children:"nested-object"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Stores object data directly within the parent object as embedded JSON data."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Behavior"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Object data is stored inline within the parent object's JSON structure"}),"\n",(0,t.jsx)(n.li,{children:"No separate database entity is created for the nested object"}),"\n",(0,t.jsx)(n.li,{children:"Changes to the nested object are saved as part of the parent object"}),"\n",(0,t.jsx)(n.li,{children:"Best for simple, tightly coupled data that doesn't need independent lifecycle management"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example Schema Configuration"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "address": {\n    "type": "object",\n    "objectConfiguration": {\n      "handling": "nested-object"\n    },\n    "properties": {\n      "street": {"type": "string"},\n      "city": {"type": "string"},\n      "zipCode": {"type": "string"}\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Resulting Data Structure"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "123e4567-e89b-12d3-a456-426614174000",\n  "name": "John Doe",\n  "address": {\n    "street": "Main Street 1",\n    "city": "Amsterdam", \n    "zipCode": "1000 AA"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"2-nested-schema-nested-schema",children:["2. Nested Schema (",(0,t.jsx)(n.code,{children:"nested-schema"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Stores object as a separate entity in the database but embeds the full object data in API responses."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Behavior"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates a separate ",(0,t.jsx)(n.code,{children:"ObjectEntity"})," in the database with its own UUID"]}),"\n",(0,t.jsxs)(n.li,{children:["Object follows the schema specified in ",(0,t.jsx)(n.code,{children:"$ref"})]}),"\n",(0,t.jsx)(n.li,{children:"During rendering, the full nested object data is included in the response"}),"\n",(0,t.jsx)(n.li,{children:"Allows independent lifecycle management while providing convenient access to nested data"}),"\n",(0,t.jsxs)(n.li,{children:["Supports cascade operations when configured with ",(0,t.jsx)(n.code,{children:"inversedBy"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example Schema Configuration"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "profile": {\n    "type": "object",\n    "$ref": "profile-schema",\n    "objectConfiguration": {\n      "handling": "nested-schema"\n    },\n    "inversedBy": "owner",\n    "register": "users"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Resulting Data Structure"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "123e4567-e89b-12d3-a456-426614174000", \n  "name": "John Doe",\n  "profile": {\n    "id": "987fcdeb-51a2-43d7-8f9e-123456789abc",\n    "bio": "Software developer",\n    "skills": ["PHP", "JavaScript", "Vue.js"],\n    "owner": "123e4567-e89b-12d3-a456-426614174000"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"3-related-schema-related-schema",children:["3. Related Schema (",(0,t.jsx)(n.code,{children:"related-schema"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Stores object as a separate entity and references it by UUID/ID only."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Behavior"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates a separate ",(0,t.jsx)(n.code,{children:"ObjectEntity"})," in the database with its own UUID"]}),"\n",(0,t.jsx)(n.li,{children:"Only the UUID reference is stored in the parent object"}),"\n",(0,t.jsx)(n.li,{children:"Client must make additional API calls to retrieve the full nested object data"}),"\n",(0,t.jsx)(n.li,{children:"Provides the most separation and independence between objects"}),"\n",(0,t.jsx)(n.li,{children:"Optimal for loosely coupled relationships and large datasets"}),"\n",(0,t.jsxs)(n.li,{children:["Supports cascade operations when configured with ",(0,t.jsx)(n.code,{children:"inversedBy"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example Schema Configuration"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "department": {\n    "type": "object", \n    "$ref": "department-schema",\n    "objectConfiguration": {\n      "handling": "related-schema"\n    },\n    "inversedBy": "employees",\n    "register": "organization"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Resulting Data Structure"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "123e4567-e89b-12d3-a456-426614174000",\n  "name": "John Doe", \n  "department": "456e7890-e12b-34c5-d678-901234567890"\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"4-uri-reference-uri",children:["4. URI Reference (",(0,t.jsx)(n.code,{children:"uri"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": References external objects by URI/URL without local storage."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Behavior"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["No local ",(0,t.jsx)(n.code,{children:"ObjectEntity"})," is created"]}),"\n",(0,t.jsx)(n.li,{children:"Stores only the URI reference as a string"}),"\n",(0,t.jsx)(n.li,{children:"External object is not managed by OpenRegister"}),"\n",(0,t.jsx)(n.li,{children:"Useful for referencing objects in external systems or APIs"}),"\n",(0,t.jsx)(n.li,{children:"No cascade operations or local validation"}),"\n",(0,t.jsx)(n.li,{children:"Client is responsible for resolving the URI to retrieve object data"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example Schema Configuration"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "externalService": {\n    "type": "object",\n    "objectConfiguration": {\n      "handling": "uri"\n    },\n    "format": "uri"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Resulting Data Structure"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "123e4567-e89b-12d3-a456-426614174000",\n  "name": "John Doe",\n  "externalService": "https://api.external.com/services/auth-service-v2"\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"handling-type-comparison",children:"Handling Type Comparison"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"Nested Object"}),(0,t.jsx)(n.th,{children:"Nested Schema"}),(0,t.jsx)(n.th,{children:"Related Schema"}),(0,t.jsx)(n.th,{children:"URI Reference"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Separate Entity"})}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Independent Lifecycle"})}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Embedded in Response"})}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Cascade Operations"})}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Schema Validation"})}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Performance (Read)"})}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Performance (Write)"})}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Storage Efficiency"})}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Relationship Complexity"})}),(0,t.jsx)(n.td,{children:"\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use-each-type",children:"When to Use Each Type"}),"\n",(0,t.jsxs)(n.h3,{id:"use-nested-object-when",children:["Use ",(0,t.jsx)(n.strong,{children:"Nested Object"})," when:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Data is simple and tightly coupled to the parent"}),"\n",(0,t.jsx)(n.li,{children:"You don't need independent lifecycle management"}),"\n",(0,t.jsx)(n.li,{children:"The nested data is relatively small and stable"}),"\n",(0,t.jsx)(n.li,{children:"Performance is critical and you want to minimize database queries"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"use-nested-schema-when",children:["Use ",(0,t.jsx)(n.strong,{children:"Nested Schema"})," when:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You need schema validation for nested objects"}),"\n",(0,t.jsx)(n.li,{children:"You want independent lifecycle management but convenient access"}),"\n",(0,t.jsx)(n.li,{children:"The nested object might be referenced by multiple parents"}),"\n",(0,t.jsx)(n.li,{children:"You need cascade operations but want embedded responses"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"use-related-schema-when",children:["Use ",(0,t.jsx)(n.strong,{children:"Related Schema"})," when:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Objects have independent lifecycles and complex relationships"}),"\n",(0,t.jsx)(n.li,{children:"You're working with large datasets where embedding would be inefficient"}),"\n",(0,t.jsx)(n.li,{children:"You need maximum flexibility in how relationships are managed"}),"\n",(0,t.jsx)(n.li,{children:"Performance optimization through selective loading is important"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"use-uri-reference-when",children:["Use ",(0,t.jsx)(n.strong,{children:"URI Reference"})," when:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Referencing objects in external systems"}),"\n",(0,t.jsx)(n.li,{children:"You don't want to store or manage the referenced object locally"}),"\n",(0,t.jsx)(n.li,{children:"Integration with third-party APIs or services"}),"\n",(0,t.jsx)(n.li,{children:"The referenced resource is managed outside OpenRegister"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"inverse-relations",children:"Inverse Relations"}),"\n",(0,t.jsx)(n.p,{children:"Inverse relations allow objects to automatically show related objects that reference them, creating bidirectional relationships while storing data only once."}),"\n",(0,t.jsx)(n.h3,{id:"how-inverse-relations-work",children:"How Inverse Relations Work"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Schema Definition:"})," Define ",(0,t.jsx)(n.code,{children:"inversedBy"})," on the schema that should show the inverse relation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic Detection:"})," Backend automatically finds objects that reference this object"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Dynamic Population:"})," Inverse relations are populated when rendering objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Single Storage:"})," Relationship data is stored only once, preventing duplicate references"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"basic-example-person-and-addresses",children:"Basic Example: Person and Addresses"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Person Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Person", \n  "properties": {\n    "name": {"type": "string"},\n    "addresses": {\n      "type": "array",\n      "items": {"$ref": "address-schema"},\n      "inversedBy": "person"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Address Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Address",\n  "properties": {\n    "street": {"type": "string"},\n    "person": {"type": "string"}\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Result:"})," When fetching a person, their addresses are automatically included even though they're stored separately."]}),"\n",(0,t.jsx)(n.h3,{id:"advanced-example-organisation-communities",children:"Advanced Example: Organisation Communities"}),"\n",(0,t.jsx)(n.p,{children:"A more complex example showing parent-child relationships within the same schema:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Organisation Schema:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Organisation",\n  "properties": {\n    "name": {"type": "string"},\n    "type": {"type": "string"}, // "community" or "member"\n    "deelnames": {\n      "type": "array",\n      "items": {"type": "string"},\n      "description": "UUIDs of communities this organisation participates in"\n    },\n    "deelnemers": {\n      "type": "array", \n      "items": {\n        "$ref": "organisation-schema",\n        "inversedBy": "deelnames",\n        "writeBack": true,\n        "removeAfterWriteBack": true\n      },\n      "description": "UUIDs of organisations that participate in this community (inverse relation with write-back)"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"inverse-relations-with-write-back",children:"Inverse Relations with Write-Back"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister's inverse relations system supports both read and write operations:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:["Standard Inverse Relations (",(0,t.jsx)(n.code,{children:"inversedBy"}),")"]}),": Automatically show related objects during rendering (read-only)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:["Inverse Relations with Write-Back (",(0,t.jsx)(n.code,{children:"inversedBy"})," + ",(0,t.jsx)(n.code,{children:"writeBack: true"}),")"]}),": Additionally update target objects during save operations"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"how-inverse-relations-write-back-works",children:"How Inverse Relations Write-Back Works"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Schema Definition:"})," Define ",(0,t.jsx)(n.code,{children:"inversedBy"})," with ",(0,t.jsx)(n.code,{children:"writeBack: true"})," in the schema property configuration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic Updates:"})," When saving an object, the system automatically updates referenced objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bidirectional Maintenance:"})," Target objects get updated to include references back to the current object"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Import-Friendly:"})," Perfect for import processes where you have parent data with child references"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"communitydeelnemers-example",children:"Community/Deelnemers Example"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema Configuration:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Organisation",\n  "properties": {\n    "name": {"type": "string"},\n    "type": {"type": "string"},\n    "deelnames": {\n      "type": "array",\n      "items": {"type": "string"},\n      "description": "UUIDs of communities this organisation participates in"\n    },\n    "deelnemers": {\n      "type": "array",\n      "items": {\n        "$ref": "organisation-schema", \n        "inversedBy": "deelnames",\n        "writeBack": true,\n        "removeAfterWriteBack": true\n      },\n      "description": "UUIDs of participants - will update their deelnames arrays"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage Example:"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Step 1: Create member organisations"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'// POST /organisations\n{\n  "name": "Organisation A",\n  "type": "member",\n  "deelnames": []\n}\n// Returns: {"id": "org-a-uuid", ...}\n\n// POST /organisations  \n{\n  "name": "Organisation B",\n  "type": "member", \n  "deelnames": []\n}\n// Returns: {"id": "org-b-uuid", ...}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Step 2: Create community with deelnemers"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'// POST /organisations\n{\n  "name": "Tech Community",\n  "type": "community",\n  "deelnames": [],\n  "deelnemers": ["org-a-uuid", "org-b-uuid"]\n}\n// Returns: {"id": "community-uuid", ...}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What happens automatically:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Community object is created with ",(0,t.jsx)(n.code,{children:"deelnemers"})," property ",(0,t.jsx)(n.strong,{children:"removed"})," (since it's a reverse relation)"]}),"\n",(0,t.jsxs)(n.li,{children:["Organisation A's ",(0,t.jsx)(n.code,{children:"deelnames"})," array is updated to include ",(0,t.jsx)(n.code,{children:'"community-uuid"'})]}),"\n",(0,t.jsxs)(n.li,{children:["Organisation B's ",(0,t.jsx)(n.code,{children:"deelnames"})," array is updated to include ",(0,t.jsx)(n.code,{children:'"community-uuid"'})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Final state:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'// Organisation A\n{\n  "id": "org-a-uuid",\n  "name": "Organisation A",\n  "type": "member",\n  "deelnames": ["community-uuid"]  // Automatically updated\n}\n\n// Organisation B  \n{\n  "id": "org-b-uuid",\n  "name": "Organisation B",\n  "type": "member",\n  "deelnames": ["community-uuid"]  // Automatically updated\n}\n\n// Tech Community\n{\n  "id": "community-uuid", \n  "name": "Tech Community",\n  "type": "community",\n  "deelnames": []  // deelnemers property was removed - not stored here\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"import-process-benefits",children:"Import Process Benefits"}),"\n",(0,t.jsx)(n.p,{children:"This reverse relations pattern is particularly useful during import processes:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"CSV Import Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csv",children:'name,type,deelnemers\n"Tech Community","community","org-a-uuid,org-b-uuid"\n"Business Community","community","org-a-uuid,org-c-uuid"\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What happens during import:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["ImportService creates community objects with ",(0,t.jsx)(n.code,{children:"deelnemers"})," arrays"]}),"\n",(0,t.jsxs)(n.li,{children:["SaveObject.handleInverseRelationsWriteBack() processes each UUID in ",(0,t.jsx)(n.code,{children:"deelnemers"})]}),"\n",(0,t.jsxs)(n.li,{children:["Target organisations' ",(0,t.jsx)(n.code,{children:"deelnames"})," arrays are automatically updated"]}),"\n",(0,t.jsxs)(n.li,{children:["Community objects are saved without the ",(0,t.jsx)(n.code,{children:"deelnemers"})," property (if ",(0,t.jsx)(n.code,{children:"removeAfterWriteBack: true"}),")"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"backend-implementation-details",children:"Backend Implementation Details"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["File: ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/SaveObject.php"})]})}),"\n",(0,t.jsx)(n.p,{children:"The inverse relations write-back functionality is implemented in:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"handleInverseRelationsWriteBack()"}),": Main method that processes inverse relations with write-back"]}),"\n",(0,t.jsx)(n.li,{children:"Called during both object creation and updates"}),"\n",(0,t.jsx)(n.li,{children:"Integrates with cascading and default value setting"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key features:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Extends existing inverse relations system (",(0,t.jsx)(n.code,{children:"inversedBy"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"Supports both single objects and arrays of objects"}),"\n",(0,t.jsx)(n.li,{children:"Handles missing target objects gracefully (logs errors, continues processing)"}),"\n",(0,t.jsx)(n.li,{children:"Optionally removes properties from source object after processing"}),"\n",(0,t.jsx)(n.li,{children:"Prevents duplicate entries in target arrays"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema Configuration Options:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "deelnemers": {\n    "type": "array",\n    "items": {\n      "$ref": "target-schema-id",              // Required: target schema\n      "inversedBy": "property-name",           // Required: property to update (same as read-only inverse relations)\n      "writeBack": true,                       // Required: enables write-back functionality\n      "removeAfterWriteBack": true,            // Optional: remove property from source after write-back\n      "register": "register-id"                // Optional: defaults to current register\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"relation-types-summary",children:"Relation Types Summary"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister supports three types of object relationships, each serving different use cases:"}),"\n",(0,t.jsxs)(n.h3,{id:"1-inverse-relations-inversedby",children:["1. Inverse Relations (",(0,t.jsx)(n.code,{children:"inversedBy"}),")"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Purpose:"})," Show related objects during rendering (read-only)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Direction:"})," Target \u2192 Source (automatic lookup)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Storage:"})," Relationship data stored on source objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use case:"})," Display all addresses for a person, show all posts for a blog"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "addresses": {\n    "type": "array",\n    "items": {"$ref": "address-schema"},\n    "inversedBy": "person"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"2-inverse-relations-with-write-back-inversedby--writeback-true",children:["2. Inverse Relations with Write-Back (",(0,t.jsx)(n.code,{children:"inversedBy"})," + ",(0,t.jsx)(n.code,{children:"writeBack: true"}),")"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Purpose:"})," Show related objects during rendering AND update target objects during save operations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Direction:"})," Bidirectional (Target \u2192 Source for reading, Source \u2192 Target for writing)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Storage:"})," Relationship data stored on target objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use case:"})," Community membership, parent-child relationships, import processes"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "deelnemers": {\n    "type": "array",\n    "items": {\n      "$ref": "organisation-schema",\n      "inversedBy": "deelnames",\n      "writeBack": true,\n      "removeAfterWriteBack": true\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"3-cascade-relations-inversedby-with-objectconfiguration",children:["3. Cascade Relations (",(0,t.jsx)(n.code,{children:"inversedBy"})," with ",(0,t.jsx)(n.code,{children:"objectConfiguration"}),")"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Purpose:"})," Create/update related objects during save operations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Direction:"})," Source \u2192 Target (create new objects)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Storage:"})," Separate objects created and linked"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use case:"})," Creating addresses when creating a person, creating posts when creating a blog"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "addresses": {\n    "type": "array",\n    "items": {\n      "$ref": "address-schema",\n      "inversedBy": "person"\n    },\n    "objectConfiguration": {"handling": "related-schema"}\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"when-to-use-each-type-1",children:"When to Use Each Type"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Use Case"}),(0,t.jsx)(n.th,{children:"Relation Type"}),(0,t.jsx)(n.th,{children:"Reason"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Display related objects"}),(0,t.jsx)(n.td,{children:"Inverse Relations"}),(0,t.jsx)(n.td,{children:"Read-only, automatic lookup"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Import with existing children"}),(0,t.jsx)(n.td,{children:"Inverse Relations with Write-Back"}),(0,t.jsx)(n.td,{children:"Update existing objects"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Create objects with new children"}),(0,t.jsx)(n.td,{children:"Cascade Relations"}),(0,t.jsx)(n.td,{children:"Create new related objects"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Parent-child where child owns relationship"}),(0,t.jsx)(n.td,{children:"Inverse Relations with Write-Back"}),(0,t.jsx)(n.td,{children:"Maintain single source of truth"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Parent-child where parent owns relationship"}),(0,t.jsx)(n.td,{children:"Cascade Relations"}),(0,t.jsx)(n.td,{children:"Natural parent-driven creation"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Bidirectional relationships"}),(0,t.jsx)(n.td,{children:"Inverse Relations with Write-Back"}),(0,t.jsx)(n.td,{children:"Both read and write capabilities"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How this works:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Data Storage (One-Way):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'// Organisation A (Member)\n{\n  "id": "org-a-uuid",\n  "name": "Organisation A",\n  "type": "member",\n  "deelnames": ["community-uuid-1", "community-uuid-2"]\n}\n\n// Organisation B (Member)  \n{\n  "id": "org-b-uuid",\n  "name": "Organisation B", \n  "type": "member",\n  "deelnames": ["community-uuid-1"]\n}\n\n// Community Organisation\n{\n  "id": "community-uuid-1",\n  "name": "Tech Community",\n  "type": "community",\n  "deelnames": [] // Empty - this is the parent\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Automatic Inverse Population:"}),"\nWhen fetching the community organisation, the ",(0,t.jsx)(n.code,{children:"deelnemers"})," property is automatically populated:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'// GET /organisations/community-uuid-1?extend=deelnemers\n{\n  "id": "community-uuid-1",\n  "name": "Tech Community",\n  "type": "community", \n  "deelnames": [],\n  "deelnemers": ["org-a-uuid", "org-b-uuid"] // Automatically populated\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"With Extension:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'// GET /organisations/community-uuid-1?extend=deelnemers\n{\n  "id": "community-uuid-1",\n  "name": "Tech Community",\n  "type": "community",\n  "deelnames": [],\n  "deelnemers": [\n    {\n      "id": "org-a-uuid",\n      "name": "Organisation A",\n      "type": "member",\n      "deelnames": ["community-uuid-1", "community-uuid-2"]\n    },\n    {\n      "id": "org-b-uuid", \n      "name": "Organisation B",\n      "type": "member",\n      "deelnames": ["community-uuid-1"]\n    }\n  ]\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"benefits-of-inverse-relations",children:"Benefits of Inverse Relations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Single Source of Truth:"})," Relationship data stored only once"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic Synchronization:"})," No risk of inconsistent bidirectional references"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Performance:"})," No need to update multiple objects when relationships change"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Flexibility:"})," Can view relationships from either direction"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"backend-implementation-details-1",children:"Backend Implementation Details"}),"\n",(0,t.jsx)(n.p,{children:"The inverse relations functionality is handled by several PHP files in the OpenRegister codebase:"}),"\n",(0,t.jsx)(n.h4,{id:"core-files-and-their-responsibilities",children:"Core Files and Their Responsibilities"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["1. ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/RenderObject.php"})]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Primary responsibility:"})," Handles rendering objects and populating inverse relations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Key methods:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"getInversedProperties(Schema $schema)"}),": Extracts properties with ",(0,t.jsx)(n.code,{children:"inversedBy"})," configurations from schema"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"handleInversedProperties()"}),": Finds and populates inverse relations during object rendering"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"renderEntity()"}),": Main rendering method that calls ",(0,t.jsx)(n.code,{children:"handleInversedProperties()"})," when depth < 10"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["2. ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/SaveObject.php"})]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Primary responsibility:"})," Handles saving objects and maintaining relation tracking"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Key methods:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scanForRelations(array $data)"}),": Scans object data for UUIDs and URLs, stores them in dot notation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"updateObjectRelations(ObjectEntity $objectEntity, array $data)"}),": Updates the relations property on objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"saveObject()"}),": Main save method that calls ",(0,t.jsx)(n.code,{children:"updateObjectRelations()"})," to track relations"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["3. ",(0,t.jsx)(n.code,{children:"lib/Service/ObjectService.php"})]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Primary responsibility:"})," Main service facade that coordinates object operations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Key methods:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"findByRelations(string $search)"}),": Finds objects that reference a specific UUID/URL"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"renderHandler->renderEntity()"}),": Delegates to RenderObject for rendering with inverse relations"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["4. ",(0,t.jsx)(n.code,{children:"lib/Db/ObjectEntityMapper.php"})]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Primary responsibility:"})," Database operations for finding related objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Key methods:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"findByRelation(string $search)"}),": Database query to find objects containing specific UUIDs in their relations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"findByRelationUri()"}),": Alternative method for finding objects by URI references"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"how-inverse-relations-are-processed",children:"How Inverse Relations Are Processed"}),"\n",(0,t.jsx)(n.mermaid,{value:"graph TD\n    A[Object Requested] --\x3e B[RenderObject::renderEntity]\n    B --\x3e C[Check Schema for inversedBy properties]\n    C --\x3e D[RenderObject::getInversedProperties]\n    D --\x3e E[ObjectEntityMapper::findByRelation]\n    E --\x3e F[Filter objects by schema and inversedBy field]\n    F --\x3e G[Populate inverse relation property]\n    G --\x3e H[Return rendered object]"}),"\n",(0,t.jsx)(n.h4,{id:"development-notes-for-future-work",children:"Development Notes for Future Work"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When working with inverse relations:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Schema Changes:"})," Modify ",(0,t.jsx)(n.code,{children:"RenderObject::getInversedProperties()"})," if you need to support new inverse relation configurations"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Performance Optimization:"})," The ",(0,t.jsx)(n.code,{children:"ObjectEntityMapper::findByRelation()"})," method can be optimized for large datasets by adding database indexes on the ",(0,t.jsx)(n.code,{children:"relations"})," JSON column"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Circular Reference Prevention:"})," The rendering system includes circular reference detection in ",(0,t.jsx)(n.code,{children:"RenderObject::renderEntity()"})," using the ",(0,t.jsx)(n.code,{children:"$visitedIds"})," parameter"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Caching:"})," Consider implementing caching in ",(0,t.jsx)(n.code,{children:"RenderObject"})," for frequently accessed inverse relations"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Database Schema:"})," Relations are stored as JSON in the ",(0,t.jsx)(n.code,{children:"relations"})," column of the ",(0,t.jsx)(n.code,{children:"oc_openregister_objects"})," table in dot notation format"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example of relations storage in database:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "deelnames.0": "community-uuid-1",\n  "deelnames.1": "community-uuid-2", \n  "contact.email": "user@example.com"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"This architecture ensures that inverse relations are dynamically calculated and always up-to-date, while maintaining performance through caching and efficient database queries."}),"\n",(0,t.jsx)(n.h2,{id:"uuid-relations-and-automatic-detection",children:"UUID Relations and Automatic Detection"}),"\n",(0,t.jsx)(n.p,{children:"The backend automatically detects and tracks relations:"}),"\n",(0,t.jsx)(n.h3,{id:"automatic-relation-detection",children:"Automatic Relation Detection"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'// These patterns are automatically detected as relations:\n{\n  "relatedObject": "550e8400-e29b-41d4-a716-446655440000", // UUID\n  "externalRef": "https://api.example.com/objects/123",     // URL\n  "nestedRefs": [\n    "550e8400-e29b-41d4-a716-446655440001",\n    "550e8400-e29b-41d4-a716-446655440002"\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"relations-storage",children:"Relations Storage"}),"\n",(0,t.jsx)(n.p,{children:"Relations are stored in dot notation:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "relations": {\n    "relatedObject": "550e8400-e29b-41d4-a716-446655440000",\n    "externalRef": "https://api.example.com/objects/123",\n    "nestedRefs.0": "550e8400-e29b-41d4-a716-446655440001", \n    "nestedRefs.1": "550e8400-e29b-41d4-a716-446655440002"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"extending-objects-with-related-data",children:"Extending Objects with Related Data"}),"\n",(0,t.jsxs)(n.p,{children:["You can extend objects to include related data using the ",(0,t.jsx)(n.code,{children:"extend"})," parameter:"]}),"\n",(0,t.jsx)(n.h3,{id:"basic-extension",children:"Basic Extension"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Extend a single property\nGET /objects/123?extend=addresses\n\n// Extend multiple properties  \nGET /objects/123?extend=addresses,employer\n\n// Extend all relations\nGET /objects/123?extend=all\n"})}),"\n",(0,t.jsx)(n.h3,{id:"nested-extension",children:"Nested Extension"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Extend nested properties\nGET /objects/123?extend=addresses.person,addresses.contacts\n\n// Wildcard extension for arrays\nGET /objects/123?extend=addresses.$.person\n"})}),"\n",(0,t.jsx)(n.h2,{id:"cascade-delete",children:"Cascade Delete"}),"\n",(0,t.jsxs)(n.p,{children:["When ",(0,t.jsx)(n.code,{children:"cascadeDelete"})," is set to ",(0,t.jsx)(n.code,{children:"true"}),", deleting a parent object will also delete related objects:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "addresses": {\n    "type": "array",\n    "items": {\n      "type": "object", \n      "$ref": "address-schema",\n      "cascadeDelete": true\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Behavior:"})," Deleting a person will also delete all their addresses."]}),"\n",(0,t.jsx)(n.h2,{id:"complete-example-blog-system",children:"Complete Example: Blog System"}),"\n",(0,t.jsx)(n.p,{children:"Here's a complete example showing different relation types:"}),"\n",(0,t.jsx)(n.h3,{id:"blog-schema",children:"Blog Schema"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Blog",\n  "properties": {\n    "title": {"type": "string"},\n    "author": {\n      "type": "object",\n      "$ref": "person-schema", \n      "objectConfiguration": {"handling": "related-schema"}\n    },\n    "posts": {\n      "type": "array",\n      "items": {\n        "type": "object",\n        "$ref": "post-schema",\n        "inversedBy": "blog",\n        "cascadeDelete": true\n      },\n      "objectConfiguration": {"handling": "related-schema"}\n    },\n    "settings": {\n      "type": "object",\n      "objectConfiguration": {"handling": "nested-object"},\n      "properties": {\n        "theme": {"type": "string"},\n        "private": {"type": "boolean"}\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"post-schema",children:"Post Schema"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Post",\n  "properties": {\n    "title": {"type": "string"},\n    "content": {"type": "string"},\n    "blog": {"type": "string"},\n    "tags": {\n      "type": "array",\n      "items": {"type": "string"}\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-blog",children:"Creating a Blog"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Input:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "title": "My Tech Blog",\n  "author": "550e8400-e29b-41d4-a716-446655440000",\n  "posts": [\n    {\n      "title": "First Post",\n      "content": "Welcome to my blog!",\n      "tags": ["welcome", "intro"]\n    },\n    {\n      "title": "Second Post", \n      "content": "More content here",\n      "tags": ["tech", "programming"]\n    }\n  ],\n  "settings": {\n    "theme": "dark",\n    "private": false\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What happens:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Blog object created with UUID ",(0,t.jsx)(n.code,{children:"blog-uuid-123"})]}),"\n",(0,t.jsxs)(n.li,{children:["Two post objects created separately:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Each gets ",(0,t.jsx)(n.code,{children:'"blog": "blog-uuid-123"'})," automatically"]}),"\n",(0,t.jsx)(n.li,{children:"Each gets its own UUID"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Blog object stores: ",(0,t.jsx)(n.code,{children:'"posts": ["post-uuid-1", "post-uuid-2"]'})]}),"\n",(0,t.jsx)(n.li,{children:"Settings nested directly in blog object"}),"\n",(0,t.jsx)(n.li,{children:"Author reference stored as UUID"}),"\n",(0,t.jsx)(n.li,{children:"Relations automatically tracked"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Retrieved with extension:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"GET /blogs/blog-uuid-123?extend=posts,author\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "blog-uuid-123",\n  "title": "My Tech Blog",\n  "author": {\n    "id": "550e8400-e29b-41d4-a716-446655440000",\n    "name": "John Doe",\n    "email": "john@example.com"\n  },\n  "posts": [\n    {\n      "id": "post-uuid-1",\n      "title": "First Post",\n      "content": "Welcome to my blog!",\n      "blog": "blog-uuid-123",\n      "tags": ["welcome", "intro"]\n    },\n    {\n      "id": "post-uuid-2", \n      "title": "Second Post",\n      "content": "More content here",\n      "blog": "blog-uuid-123",\n      "tags": ["tech", "programming"]\n    }\n  ],\n  "settings": {\n    "theme": "dark",\n    "private": false\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"The OpenRegister object relation system provides flexible ways to model data relationships:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Nested Objects:"})," Simple embedding without validation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Nested Schema:"})," Embedding with schema validation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Related Schema:"})," Separate objects with automatic relation management"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"URI References:"})," Loose coupling with external resources"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Inverse Relations:"})," Automatic population of referring objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cascade Operations:"})," Automatic creation and deletion of related objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic Detection:"})," UUIDs and URLs are automatically tracked as relations"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Choose the appropriate handling type based on your data modeling needs and whether you want separate storage, automatic relation management, and cascade operations."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"technical-implementation",children:"Technical Implementation"}),"\n",(0,t.jsx)(n.p,{children:"This section provides detailed technical information about how objects are implemented in OpenRegister."}),"\n",(0,t.jsx)(n.h3,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister uses a layered architecture for object management:"}),"\n",(0,t.jsx)(n.mermaid,{value:"graph TB\n    A[API Controller] --\x3e B[ObjectService]\n    B --\x3e C[SaveObject Handler]\n    B --\x3e D[GetObject Handler]\n    B --\x3e E[DeleteObject Handler]\n    B --\x3e F[RenderObject Handler]\n    B --\x3e G[ValidateObject Handler]\n    C --\x3e H[ObjectEntityMapper]\n    D --\x3e H\n    E --\x3e H\n    F --\x3e H\n    G --\x3e I[Schema Validation]\n    H --\x3e J[(MySQL Database)]\n    B --\x3e K[Event Dispatcher]\n    K --\x3e L[SolrEventListener]\n    L --\x3e M[GuzzleSolrService]\n    M --\x3e N[(Solr Search Engine)]\n    \n    style B fill:#e1f5ff\n    style H fill:#ffe1e1\n    style J fill:#fff4e1\n    style N fill:#e1ffe1"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key Components:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ObjectService"}),": High-level orchestration service that coordinates all object operations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Handlers"}),": Specialized classes for specific operations (Save, Get, Delete, Render, Validate)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ObjectEntityMapper"}),": Database access layer for CRUD operations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event System"}),": Nextcloud event dispatcher for lifecycle events"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Solr Integration"}),": Automatic indexing for search functionality"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"object-lifecycle",children:"Object Lifecycle"}),"\n",(0,t.jsx)(n.h4,{id:"object-creation-flow",children:"Object Creation Flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant API\n    participant ObjectService\n    participant SaveObject\n    participant Mapper\n    participant DB\n    participant Events\n    participant Solr\n    \n    Client->>API: POST /objects\n    API->>ObjectService: saveObject(data)\n    \n    ObjectService->>SaveObject: handle(data, schema, register)\n    \n    Note over SaveObject: 1. Validate Schema\n    SaveObject->>SaveObject: resolveSchemaReference()\n    \n    Note over SaveObject: 2. Process inversedBy\n    SaveObject->>SaveObject: handleCascadingPreValidation()\n    SaveObject->>Mapper: Create nested objects\n    \n    Note over SaveObject: 3. Set Defaults\n    SaveObject->>SaveObject: setDefaultValues()\n    SaveObject->>SaveObject: generateSlug()\n    \n    Note over SaveObject: 4. Hydrate Metadata\n    SaveObject->>SaveObject: hydrateObjectMetadata()\n    \n    Note over SaveObject: 5. Track Relations\n    SaveObject->>SaveObject: scanForRelations()\n    SaveObject->>SaveObject: updateObjectRelations()\n    \n    SaveObject->>Mapper: insert(objectEntity)\n    Mapper->>DB: INSERT INTO oc_openregister_objects\n    DB--\x3e>Mapper: ID + UUID\n    \n    Note over SaveObject: 6. Post-Save Operations\n    SaveObject->>SaveObject: handleInverseRelationsWriteBack()\n    SaveObject->>Mapper: Update related objects\n    \n    Mapper--\x3e>SaveObject: ObjectEntity\n    SaveObject--\x3e>ObjectService: ObjectEntity\n    \n    Note over ObjectService: 7. Fire Events\n    ObjectService->>Events: dispatchTyped(ObjectCreatedEvent)\n    Events->>Solr: SolrEventListener::handleObjectCreated()\n    Solr->>Solr: indexObject()\n    \n    ObjectService--\x3e>API: ObjectEntity\n    API--\x3e>Client: JSON Response"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Creation Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Schema Resolution"}),": Convert schema reference (ID/slug/path) to schema entity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cascading Pre-Validation"}),": Create nested objects defined in ",(0,t.jsx)(n.code,{children:"inversedBy"})," properties before main validation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Default Values"}),": Apply schema-defined default values and generate slugs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Metadata Hydration"}),": Extract name, description, summary, image from object data based on schema configuration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Relation Tracking"}),": Scan object data for UUIDs and URLs, store in dot notation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Database Insert"}),": Persist object entity to MySQL database"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Write-Back Operations"}),": Update related objects for bidirectional relations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event Dispatch"}),": Fire ",(0,t.jsx)(n.code,{children:"ObjectCreatedEvent"})," for listeners (e.g., Solr indexing)"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"object-update-flow",children:"Object Update Flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant API\n    participant ObjectService\n    participant SaveObject\n    participant Mapper\n    participant DB\n    participant Events\n    participant Solr\n    participant AuditTrail\n    \n    Client->>API: PUT /objects/{uuid}\n    API->>ObjectService: saveObject(data, uuid)\n    \n    ObjectService->>Mapper: findByUuid(uuid)\n    Mapper->>DB: SELECT * FROM ... WHERE uuid = ?\n    DB--\x3e>Mapper: Existing ObjectEntity\n    Mapper--\x3e>ObjectService: ObjectEntity\n    \n    Note over ObjectService: Store old version\n    ObjectService->>AuditTrail: createAuditLog(oldObject, newData)\n    \n    ObjectService->>SaveObject: handle(data, schema, register)\n    \n    Note over SaveObject: Update Operations\n    SaveObject->>SaveObject: Update object data\n    SaveObject->>SaveObject: Update relations\n    SaveObject->>SaveObject: Update metadata\n    \n    SaveObject->>Mapper: update(objectEntity)\n    Mapper->>DB: UPDATE oc_openregister_objects SET ...\n    DB--\x3e>Mapper: Success\n    \n    SaveObject->>SaveObject: handleInverseRelationsWriteBack()\n    \n    Mapper--\x3e>SaveObject: ObjectEntity\n    SaveObject--\x3e>ObjectService: ObjectEntity\n    \n    Note over ObjectService: Fire Events\n    ObjectService->>Events: dispatchTyped(ObjectUpdatedEvent)\n    Events->>Solr: SolrEventListener::handleObjectUpdated()\n    Solr->>Solr: updateObject()\n    \n    ObjectService--\x3e>API: ObjectEntity\n    API--\x3e>Client: JSON Response"}),"\n",(0,t.jsx)(n.h4,{id:"object-retrieval-flow",children:"Object Retrieval Flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant API\n    participant ObjectService\n    participant GetObject\n    participant RenderObject\n    participant Mapper\n    participant DB\n    participant Solr\n    \n    Client->>API: GET /objects/{uuid}?extend=addresses\n    API->>ObjectService: findObject(uuid, extend)\n    \n    ObjectService->>GetObject: getObject(uuid)\n    GetObject->>Mapper: findByUuid(uuid)\n    Mapper->>DB: SELECT * FROM ... WHERE uuid = ?\n    DB--\x3e>Mapper: ObjectEntity\n    Mapper--\x3e>GetObject: ObjectEntity\n    GetObject--\x3e>ObjectService: ObjectEntity\n    \n    Note over ObjectService: Apply RBAC filters\n    ObjectService->>ObjectService: checkAccess(user, object)\n    \n    Note over ObjectService: Render with extensions\n    ObjectService->>RenderObject: renderEntity(object, extend)\n    \n    Note over RenderObject: 1. Get inversedBy properties\n    RenderObject->>RenderObject: getInversedProperties(schema)\n    \n    Note over RenderObject: 2. Find related objects\n    loop For each inversedBy property\n        RenderObject->>Mapper: findByRelation(object.uuid)\n        Mapper->>DB: SELECT * FROM ... WHERE relations LIKE ?\n        DB--\x3e>Mapper: Related objects\n        Mapper--\x3e>RenderObject: Array of objects\n    end\n    \n    Note over RenderObject: 3. Extend requested properties\n    loop For each extend path\n        RenderObject->>Mapper: findByUuid(relatedUuid)\n        Mapper->>DB: SELECT * FROM ...\n        DB--\x3e>Mapper: Related object\n        Mapper--\x3e>RenderObject: ObjectEntity\n        RenderObject->>RenderObject: Recursive render (depth++)\n    end\n    \n    RenderObject--\x3e>ObjectService: Rendered object with extensions\n    ObjectService--\x3e>API: JSON array\n    API--\x3e>Client: JSON Response"}),"\n",(0,t.jsx)(n.h3,{id:"database-schema",children:"Database Schema"}),"\n",(0,t.jsxs)(n.p,{children:["Objects are stored in the ",(0,t.jsx)(n.code,{children:"oc_openregister_objects"})," table:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE oc_openregister_objects (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    uuid VARCHAR(36) UNIQUE NOT NULL,\n    slug VARCHAR(255),\n    uri TEXT,\n    version VARCHAR(50),\n    register VARCHAR(36),\n    schema VARCHAR(36),\n    object JSON,\n    files JSON,\n    relations JSON,\n    locked JSON,\n    owner VARCHAR(64),\n    authorization JSON,\n    folder VARCHAR(255),\n    application VARCHAR(255),\n    organisation VARCHAR(255),\n    validation JSON,\n    deleted JSON,\n    geo JSON,\n    retention JSON,\n    size VARCHAR(50),\n    name VARCHAR(255),\n    description TEXT,\n    summary TEXT,\n    image TEXT,\n    labels JSON,\n    created DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    published DATETIME,\n    depublished DATETIME,\n    \n    INDEX idx_uuid (uuid),\n    INDEX idx_register (register),\n    INDEX idx_schema (schema),\n    INDEX idx_owner (owner),\n    INDEX idx_organisation (organisation),\n    INDEX idx_published (published),\n    INDEX idx_slug (slug, register, schema)\n);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key Fields:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"object"}),": JSON field containing the actual object data (business logic fields)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"relations"}),": JSON field with dot-notation storage of all UUIDs/URLs found in object data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"files"}),": JSON array of file IDs attached to this object"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"published"}),": Objects must have a published date to be indexed in Solr"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"slug"}),": URL-friendly identifier, unique within register+schema combination"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"relations-storage-1",children:"Relations Storage"}),"\n",(0,t.jsx)(n.p,{children:"Relations are automatically detected and stored in dot notation:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example Object Data:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "John Doe",\n  "address": "123e4567-e89b-41d4-a716-446655440000",\n  "contacts": [\n    "456e7890-e29b-41d4-a716-446655440001",\n    "789e0123-e29b-41d4-a716-446655440002"\n  ],\n  "website": "https://example.com"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Stored Relations:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "address": "123e4567-e89b-41d4-a716-446655440000",\n  "contacts.0": "456e7890-e29b-41d4-a716-446655440001",\n  "contacts.1": "789e0123-e29b-41d4-a716-446655440002",\n  "website": "https://example.com"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"This enables efficient querying for inverse relations using:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM oc_openregister_objects \nWHERE JSON_SEARCH(relations, 'one', '123e4567-e89b-41d4-a716-446655440000') IS NOT NULL\n"})}),"\n",(0,t.jsx)(n.h3,{id:"event-system",children:"Event System"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister dispatches events at key points in the object lifecycle:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available Events:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Event"}),(0,t.jsx)(n.th,{children:"When Fired"}),(0,t.jsx)(n.th,{children:"Use Cases"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectCreatingEvent"})}),(0,t.jsx)(n.td,{children:"Before object creation"}),(0,t.jsx)(n.td,{children:"Validation, pre-processing"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectCreatedEvent"})}),(0,t.jsx)(n.td,{children:"After object creation"}),(0,t.jsx)(n.td,{children:"Solr indexing, webhooks, audit"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectUpdatingEvent"})}),(0,t.jsx)(n.td,{children:"Before object update"}),(0,t.jsx)(n.td,{children:"Change detection, validation"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectUpdatedEvent"})}),(0,t.jsx)(n.td,{children:"After object update"}),(0,t.jsx)(n.td,{children:"Solr re-indexing, notifications"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectDeletingEvent"})}),(0,t.jsx)(n.td,{children:"Before object deletion"}),(0,t.jsx)(n.td,{children:"Cascade checks, backups"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectDeletedEvent"})}),(0,t.jsx)(n.td,{children:"After object deletion"}),(0,t.jsx)(n.td,{children:"Solr cleanup, cleanup tasks"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectLockedEvent"})}),(0,t.jsx)(n.td,{children:"When object is locked"}),(0,t.jsx)(n.td,{children:"Concurrent access control"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectUnlockedEvent"})}),(0,t.jsx)(n.td,{children:"When object is unlocked"}),(0,t.jsx)(n.td,{children:"Resume operations"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ObjectRevertedEvent"})}),(0,t.jsx)(n.td,{children:"After version revert"}),(0,t.jsx)(n.td,{children:"Audit trail, re-indexing"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Event Listener Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"namespace OCA\\OpenRegister\\EventListener;\n\nuse OCA\\OpenRegister\\Event\\ObjectCreatedEvent;\nuse OCP\\EventDispatcher\\Event;\nuse OCP\\EventDispatcher\\IEventListener;\n\nclass SolrEventListener implements IEventListener\n{\n    public function handle(Event $event): void\n    {\n        if ($event instanceof ObjectCreatedEvent) {\n            $object = $event->getObject();\n            $this->solrService->indexObject($object);\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"solr-integration",children:"Solr Integration"}),"\n",(0,t.jsx)(n.p,{children:"Objects are automatically indexed in Solr when:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Created (if published)"}),"\n",(0,t.jsx)(n.li,{children:"Updated (if published)"}),"\n",(0,t.jsx)(n.li,{children:"Published (status change)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solr Document Structure:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "123e4567-e89b-12d3-a456-426614174000",\n  "self_uuid": "123e4567-e89b-12d3-a456-426614174000",\n  "self_name": "John Doe",\n  "self_name_s": "John Doe",\n  "self_description": "Software developer",\n  "self_schema": "person",\n  "self_register": "employees",\n  "self_created": "2024-01-15T10:30:00Z",\n  "self_updated": "2024-01-20T14:45:00Z",\n  "self_published": "2024-01-15T10:30:00Z",\n  "self_relations": ["456e7890-...", "789e0123-..."],\n  "self_object": "{...complete JSON...}",\n  \n  "age_i": 30,\n  "email_s": "john@example.com",\n  "skills": ["PHP", "JavaScript", "Vue.js"],\n  "department_s": "Engineering"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Field Naming Conventions:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"self_*"}),": System metadata fields"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"*_i"}),": Integer fields"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"*_s"}),": String fields (sortable, not tokenized)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"*_t"}),": Text fields (tokenized for full-text search)"]}),"\n",(0,t.jsx)(n.li,{children:"Arrays without suffix: Multi-valued fields"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"performance-optimizations",children:"Performance Optimizations"}),"\n",(0,t.jsx)(n.h4,{id:"bulk-operations",children:"Bulk Operations"}),"\n",(0,t.jsx)(n.p,{children:"For importing large datasets, use bulk operations:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$results = $objectService->saveObjects(\n    objects: $arrayOfObjects,\n    register: $register,\n    schema: $schema,\n    validation: false,  // Skip validation for performance\n    events: false       // Skip event firing for performance\n);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Bulk Operation Optimizations:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Single-pass schema analysis"}),"\n",(0,t.jsxs)(n.li,{children:["Batch database inserts with ",(0,t.jsx)(n.code,{children:"INSERT ... ON DUPLICATE KEY UPDATE"})]}),"\n",(0,t.jsx)(n.li,{children:"Memory-optimized processing with pass-by-reference"}),"\n",(0,t.jsx)(n.li,{children:"Deferred event firing"}),"\n",(0,t.jsx)(n.li,{children:"Bulk Solr indexing"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"smart-deduplication-system",children:"Smart Deduplication System"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister includes an intelligent 3-stage deduplication system that automatically detects and handles duplicate objects during bulk imports:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Stage 1: Multi-ID Extraction"}),"\nThe system extracts identifiers from multiple sources:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"UUID"}),": Primary unique identifier"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Slug"}),": URL-friendly identifiers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"URI"}),": External system references"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Custom IDs"}),": Legacy system identifiers (id, identifier, sourceId)"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// System automatically extracts all identifier types\n$identifiers = [\n    'uuids' => ['uuid1', 'uuid2', ...],\n    'slugs' => ['user-profile', 'company-x'],\n    'uris' => ['https://api.../123', ...],\n    'custom_ids' => [\n        'id' => [101, 102, 103],\n        'identifier' => ['EXT_001', 'EXT_002'],\n        'sourceId' => ['src_123', 'src_456']\n    ]\n];\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Stage 2: Intelligent Bulk Lookup"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Single database query retrieves all existing objects"}),"\n",(0,t.jsx)(n.li,{children:"Multi-index mapping for O(1) lookup time"}),"\n",(0,t.jsx)(n.li,{children:"Memory-efficient indexing for fast comparisons"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Stage 3: Hash-Based Decision Making"}),"\nFor each incoming object, the system:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Finds existing object by any identifier (UUID \u2192 Slug \u2192 URI \u2192 Custom IDs)"}),"\n",(0,t.jsx)(n.li,{children:"Compares content hashes (excluding metadata and timestamps)"}),"\n",(0,t.jsxs)(n.li,{children:["Makes intelligent decision:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CREATE"}),": New object (no match found)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"SKIP"}),": Content identical (no database operation needed)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"UPDATE"}),": Content changed (merge and update)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Performance Impact:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Fresh Import"}),": 100% CREATE operations (same as before)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Incremental Update"}),": Typically 80% SKIP operations (5x faster)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Re-import Same Data"}),": 100% SKIP operations (50x faster)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Database Load Reduction"}),": 80-95% fewer operations"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Hash Calculation:"}),"\nThe system uses SHA-256 hashing of cleaned object data:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Excludes ",(0,t.jsx)(n.code,{children:"@self"})," metadata fields"]}),"\n",(0,t.jsxs)(n.li,{children:["Excludes timestamps (",(0,t.jsx)(n.code,{children:"created"}),", ",(0,t.jsx)(n.code,{children:"updated"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Excludes system fields (",(0,t.jsx)(n.code,{children:"_etag"}),", etc.)"]}),"\n",(0,t.jsx)(n.li,{children:"Recursively sorted for consistent hashing"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"bulk-import-performance",children:"Bulk Import Performance"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister's bulk import system uses optimized database operations for high-performance data processing:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Single-Call Architecture:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Uses ",(0,t.jsx)(n.code,{children:"INSERT...ON DUPLICATE KEY UPDATE"})," with database-computed classification"]}),"\n",(0,t.jsx)(n.li,{children:"Eliminates database lookup overhead (3-5x faster)"}),"\n",(0,t.jsxs)(n.li,{children:["Automatic deduplication via ",(0,t.jsx)(n.code,{children:"UNIQUE (uuid)"})," constraint"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Database-Managed Timestamps:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"created"})," timestamp is immutable (preserved on updates)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"updated"})," timestamp automatically managed by database"]}),"\n",(0,t.jsx)(n.li,{children:"Smart change detection compares all data fields including JSON"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Database-Computed Classification:"}),"\nThe system classifies objects as:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"created"}),": Object created during this operation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"updated"}),": Object modified during this operation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"unchanged"}),": Object exists but content unchanged"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Performance Results:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Small Batches (< 1,000 objects)"}),": 800-1,200 objects/second"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Medium Batches (1,000-5,000 objects)"}),": 1,500-2,000 objects/second"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Large Batches (5,000+ objects)"}),": 2,000-2,500 objects/second"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Memory Optimization:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Automatic optimization decision based on available memory"}),"\n",(0,t.jsx)(n.li,{children:"Uses ultra-fast operations when memory allows (500MB+)"}),"\n",(0,t.jsx)(n.li,{children:"Falls back to standard operations when memory constrained"}),"\n",(0,t.jsx)(n.li,{children:"2x memory safety margin prevents OOM errors"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Clean Business Data Storage:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Metadata fields (id, uuid, register, schema) stored separately"}),"\n",(0,t.jsxs)(n.li,{children:["Business data stored cleanly in ",(0,t.jsx)(n.code,{children:"object"})," column"]}),"\n",(0,t.jsx)(n.li,{children:"No metadata pollution in business data"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"caching",children:"Caching"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister implements multiple caching layers:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Object Cache"}),": Recently accessed objects (PSR-6 compliant)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Schema Cache"}),": Schema definitions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Facet Cache"}),": Facetable fields per schema"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Query Cache"}),": Search result caching"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"validation-system",children:"Validation System"}),"\n",(0,t.jsx)(n.p,{children:"Objects are validated against their schema using JSON Schema validation:"}),"\n",(0,t.jsx)(n.mermaid,{value:"graph LR\n    A[Object Data] --\x3e B[ValidateObject Handler]\n    B --\x3e C[Schema Definition]\n    C --\x3e D[JSON Schema Validator]\n    D --\x3e E{Valid?}\n    E --\x3e|Yes| F[Save Object]\n    E --\x3e|No| G[Return Validation Errors]\n    \n    G --\x3e H[Enhanced Error Messages]\n    H --\x3e I[Field-level errors]\n    H --\x3e J[Nested path tracking]\n    H --\x3e K[Human-readable messages]"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Validation Modes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hard Validation"})," (default): Rejects invalid objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Soft Validation"}),": Saves object but stores validation errors in ",(0,t.jsx)(n.code,{children:"validation"})," field"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Enhanced Error Messages:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "valid": false,\n  "errors": [\n    {\n      "property": "email",\n      "message": "The property email is required",\n      "constraint": "required"\n    },\n    {\n      "property": "age",\n      "message": "Integer value found, but a string is required",\n      "constraint": "type"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"metadata-extraction",children:"Metadata Extraction"}),"\n",(0,t.jsx)(n.p,{children:"Objects automatically extract metadata from their data based on schema configuration:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schema Configuration:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "configuration": {\n    "objectNameField": "firstName",\n    "objectDescriptionField": "bio",\n    "objectSummaryField": "headline",\n    "objectImageField": "avatar",\n    "objectSlugField": "username"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Extraction Process:"})}),"\n",(0,t.jsx)(n.mermaid,{value:"graph TD\n    A[Object Data] --\x3e B[SaveObject::hydrateObjectMetadata]\n    B --\x3e C{Has objectNameField?}\n    C --\x3e|Yes| D[Extract name]\n    C --\x3e|No| E[Use default logic]\n    D --\x3e F[Set ObjectEntity.name]\n    E --\x3e F\n    \n    B --\x3e G{Has objectSlugField?}\n    G --\x3e|Yes| H[Extract slug value]\n    G --\x3e|No| I[Generate from name]\n    H --\x3e J[Convert to URL-friendly slug]\n    I --\x3e J\n    J --\x3e K[Set ObjectEntity.slug]\n    \n    B --\x3e L[Extract description, summary, image]\n    L --\x3e M[Complete ObjectEntity]"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Consistent object display across UI"}),"\n",(0,t.jsx)(n.li,{children:"SEO-friendly URLs via slugs"}),"\n",(0,t.jsx)(n.li,{children:"Rich search results with descriptions"}),"\n",(0,t.jsx)(n.li,{children:"Thumbnail support via image extraction"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"file-attachments-1",children:"File Attachments"}),"\n",(0,t.jsx)(n.p,{children:"Objects can have file attachments stored in Nextcloud Files:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"File Storage:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Files uploaded via API or UI"}),"\n",(0,t.jsxs)(n.li,{children:["Stored in Nextcloud filesystem under ",(0,t.jsx)(n.code,{children:"openregister/{register}/{schema}/"})]}),"\n",(0,t.jsxs)(n.li,{children:["File IDs tracked in ",(0,t.jsx)(n.code,{children:"files"})," JSON array field"]}),"\n",(0,t.jsx)(n.li,{children:"Text extraction for searchable content (optional)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Text Extraction:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Background job processes uploaded files"}),"\n",(0,t.jsx)(n.li,{children:"Supports PDFs, Word docs, text files, images (OCR)"}),"\n",(0,t.jsx)(n.li,{children:"Extracted text stored separately for Solr indexing"}),"\n",(0,t.jsx)(n.li,{children:"Configurable extraction scope and mode"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"access-control-1",children:"Access Control"}),"\n",(0,t.jsx)(n.p,{children:"Objects support granular access control:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"RBAC (Role-Based Access Control):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$objects = $objectService->findObjects(\n    filters: ['status' => 'active'],\n    rbac: true  // Apply user permissions\n);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Authorization Field:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "authorization": {\n    "read": ["user1", "group:admins"],\n    "write": ["user1"],\n    "delete": ["group:admins"]\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Multi-Tenancy:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// Filter by organization\n$objects = $objectService->findObjects(\n    filters: [],\n    multi: true  // Apply organization filtering\n);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"code-examples",children:"Code Examples"}),"\n",(0,t.jsx)(n.h4,{id:"creating-an-object",children:"Creating an Object"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"use OCA\\OpenRegister\\Service\\ObjectService;\n\n// Via service\n$object = $objectService->saveObject(\n    object: [\n        'name' => 'John Doe',\n        'email' => 'john@example.com',\n        'age' => 30\n    ],\n    register: 'employees',\n    schema: 'person',\n    rbac: true,\n    multi: true\n);\n\n// Access result\necho $object->getUuid();  // \"123e4567-e89b-12d3-a456-426614174000\"\necho $object->getName();  // \"John Doe\"\n"})}),"\n",(0,t.jsx)(n.h4,{id:"querying-objects",children:"Querying Objects"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// Find all objects in a register\n$objects = $objectService->findObjects(\n    limit: 50,\n    offset: 0,\n    filters: ['status' => 'active'],\n    register: 'employees',\n    schema: 'person'\n);\n\n// Find by UUID\n$object = $objectService->findObject(\n    uuid: '123e4567-e89b-12d3-a456-426614174000'\n);\n\n// Search with extension\n$object = $objectService->findObject(\n    uuid: '123e4567-e89b-12d3-a456-426614174000',\n    extend: ['addresses', 'employer']\n);\n"})}),"\n",(0,t.jsx)(n.h4,{id:"updating-an-object",children:"Updating an Object"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$updated = $objectService->saveObject(\n    object: [\n        'name' => 'John Doe',\n        'email' => 'john.doe@newcompany.com',  // Updated\n        'age' => 31  // Updated\n    ],\n    uuid: '123e4567-e89b-12d3-a456-426614174000',\n    schema: 'person',\n    register: 'employees'\n);\n"})}),"\n",(0,t.jsx)(n.h4,{id:"deleting-an-object",children:"Deleting an Object"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$result = $objectService->deleteObject(\n    id: '123e4567-e89b-12d3-a456-426614174000'\n);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,t.jsx)(n.p,{children:"OpenRegister includes comprehensive tests for object operations:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run all object tests\nvendor/bin/phpunit tests/Service/ObjectServiceTest.php\n\n# Run specific test\nvendor/bin/phpunit --filter testCreateObject\n\n# Integration tests\nvendor/bin/phpunit tests/Integration/ObjectIntegrationTest.php\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Coverage:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Object CRUD operations"}),"\n",(0,t.jsx)(n.li,{children:"Relation handling"}),"\n",(0,t.jsx)(n.li,{children:"Cascade operations"}),"\n",(0,t.jsx)(n.li,{children:"Inverse relations"}),"\n",(0,t.jsx)(n.li,{children:"Write-back operations"}),"\n",(0,t.jsx)(n.li,{children:"Validation"}),"\n",(0,t.jsx)(n.li,{children:"Event firing"}),"\n",(0,t.jsx)(n.li,{children:"Solr indexing"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},45673:(e,n,i)=>{"use strict";i.d(n,{A:()=>j});var s=i(96540),t=i(20053),r=i(44404),a=(i(34345),i(28794)),c=i(54022),l=i(72077);function d(e){const n=(0,l.kh)("docusaurus-plugin-redoc");return e?n?.[e]:Object.values(n??{})?.[0]}var o=i(74848);const h=e=>{let{id:n,example:i,pointer:l,...h}=e;const j=d(n),{store:x}=(0,c.r)(j);return(0,s.useEffect)((()=>{x.menu.dispose()}),[x]),(0,o.jsx)(r.ThemeProvider,{theme:x.options.theme,children:(0,o.jsx)("div",{className:(0,t.A)(["redocusaurus","redocusaurus-schema",i?null:"hide-example"]),children:(0,o.jsx)(a.SchemaDefinition,{parser:x.spec.parser,options:x.options,schemaRef:l,...h})})})};h.defaultProps={example:!1};const j=h},65537:(e,n,i)=>{"use strict";i.d(n,{A:()=>S});var s=i(96540),t=i(18215),r=i(65627),a=i(56347),c=i(50372),l=i(30604),d=i(11861),o=i(78749);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function j(e){const{values:n,children:i}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:i,attributes:s,default:t}}=e;return{value:n,label:i,attributes:s,default:t}}))}(i);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,i])}function x(e){let{value:n,tabValues:i}=e;return i.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:i}=e;const t=(0,a.W6)(),r=function(e){let{queryString:n=!1,groupId:i}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!i)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return i??null}({queryString:n,groupId:i});return[(0,l.aZ)(r),(0,s.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})}),[r,t])]}function u(e){const{defaultValue:n,queryString:i=!1,groupId:t}=e,r=j(e),[a,l]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:i}=e;if(0===i.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!x({value:n,tabValues:i}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${i.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=i.find((e=>e.default))??i[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:r}))),[d,h]=p({queryString:i,groupId:t}),[u,m]=function(e){let{groupId:n}=e;const i=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,r]=(0,o.Dv)(i);return[t,(0,s.useCallback)((e=>{i&&r.set(e)}),[i,r])]}({groupId:t}),g=(()=>{const e=d??u;return x({value:e,tabValues:r})?e:null})();(0,c.A)((()=>{g&&l(g)}),[g]);return{selectedValue:a,selectValue:(0,s.useCallback)((e=>{if(!x({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),m(e)}),[h,m,r]),tabValues:r}}var m=i(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=i(74848);function v(e){let{className:n,block:i,selectedValue:s,selectValue:a,tabValues:c}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,r.a_)(),o=e=>{const n=e.currentTarget,i=l.indexOf(n),t=c[i].value;t!==s&&(d(n),a(t))},h=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const i=l.indexOf(e.currentTarget)+1;n=l[i]??l[0];break}case"ArrowLeft":{const i=l.indexOf(e.currentTarget)-1;n=l[i]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":i},n),children:c.map((e=>{let{value:n,label:i,attributes:r}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>{l.push(e)},onKeyDown:h,onClick:o,...r,className:(0,t.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":s===n}),children:i??n},n)}))})}function f(e){let{lazy:n,children:i,selectedValue:r}=e;const a=(Array.isArray(i)?i:[i]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===r));return e?(0,s.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function y(e){const n=u(e);return(0,b.jsxs)("div",{className:(0,t.A)("tabs-container",g.tabList),children:[(0,b.jsx)(v,{...n,...e}),(0,b.jsx)(f,{...n,...e})]})}function S(e){const n=(0,m.A)();return(0,b.jsx)(y,{...e,children:h(e.children)},String(n))}},67992:()=>{},79329:(e,n,i)=>{"use strict";i.d(n,{A:()=>a});i(96540);var s=i(18215);const t={tabItem:"tabItem_Ymn6"};var r=i(74848);function a(e){let{children:n,hidden:i,className:a}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,s.A)(t.tabItem,a),hidden:i,children:n})}},92441:()=>{},93290:()=>{}}]);