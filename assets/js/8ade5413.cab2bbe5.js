"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[3332],{28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var l=i(96540);const s={},r=l.createContext(s);function t(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),l.createElement(r.Provider,{value:n},e.children)}},42690:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"development/solr-development","title":"Solr Development Troubleshooting","description":"This document covers common Solr development issues, fixes, and troubleshooting guides.","source":"@site/docs/development/solr-development.md","sourceDirName":"development","slug":"/development/solr-development","permalink":"/docs/development/solr-development","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/development/solr-development.md","tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"title":"Solr Development Troubleshooting","sidebar_position":30},"sidebar":"tutorialSidebar","previous":{"title":"Nextcloud Full Text Search Setup","permalink":"/docs/development/fulltextsearch-setup"},"next":{"title":"MagicMapper - Dynamic Schema-Based Table Management","permalink":"/docs/development/magic-mapper"}}');var s=i(74848),r=i(28453);const t={title:"Solr Development Troubleshooting",sidebar_position:30},c="Solr Development Troubleshooting",o={},d=[{value:"SOLR Filter AND Logic Fix",id:"solr-filter-and-logic-fix",level:2},{value:"Problem",id:"problem",level:3},{value:"Root Cause",id:"root-cause",level:3},{value:"Solution",id:"solution",level:3},{value:"How Filtering Works Now",id:"how-filtering-works-now",level:3},{value:"Single Value Filters (AND Logic)",id:"single-value-filters-and-logic",level:4},{value:"Array Value Filters (OR Logic within field)",id:"array-value-filters-or-logic-within-field",level:4},{value:"Mixed Filters",id:"mixed-filters",level:4},{value:"Testing",id:"testing",level:3},{value:"Debug Logging",id:"debug-logging",level:3},{value:"UUID Label Resolution for Facets",id:"uuid-label-resolution-for-facets",level:2},{value:"Problem Statement",id:"problem-statement",level:3},{value:"Solution",id:"solution-1",level:3},{value:"Changes Made",id:"changes-made",level:4},{value:"How It Works",id:"how-it-works",level:4},{value:"Example Result",id:"example-result",level:4},{value:"Performance Impact",id:"performance-impact",level:4},{value:"SOLR Field Dialog - Collection Support",id:"solr-field-dialog---collection-support",level:2},{value:"Issue",id:"issue",level:3},{value:"Solution",id:"solution-2",level:3},{value:"Changes Made",id:"changes-made-1",level:4},{value:"New Response Format",id:"new-response-format",level:4},{value:"Benefits",id:"benefits",level:4},{value:"SOLR Service Refactoring Status",id:"solr-service-refactoring-status",level:2},{value:"Current Status",id:"current-status",level:3},{value:"Verified Working",id:"verified-working",level:4},{value:"Completed",id:"completed",level:4},{value:"Service Architecture",id:"service-architecture",level:3},{value:"Refactoring Strategy",id:"refactoring-strategy",level:3},{value:"Phase 1A: Service Wrappers (\u2705 DONE)",id:"phase-1a-service-wrappers--done",level:4},{value:"Phase 1B: Gradual Migration (NEXT)",id:"phase-1b-gradual-migration-next",level:4},{value:"Collections Configuration",id:"collections-configuration",level:3},{value:"Risk Assessment",id:"risk-assessment",level:3},{value:"Low Risk \u2705",id:"low-risk-",level:4},{value:"Medium Risk \u26a0\ufe0f",id:"medium-risk-\ufe0f",level:4},{value:"High Risk \u274c",id:"high-risk-",level:4},{value:"Rollback Plan",id:"rollback-plan",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"solr-development-troubleshooting",children:"Solr Development Troubleshooting"})}),"\n",(0,s.jsx)(n.p,{children:"This document covers common Solr development issues, fixes, and troubleshooting guides."}),"\n",(0,s.jsx)(n.h2,{id:"solr-filter-and-logic-fix",children:"SOLR Filter AND Logic Fix"}),"\n",(0,s.jsx)(n.h3,{id:"problem",children:"Problem"}),"\n",(0,s.jsx)(n.p,{children:"When sending multiple filter parameters to SOLR search, filters were using OR logic instead of AND logic. This caused MORE results with more filters (union) instead of FEWER results (intersection/drilling down)."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"?status=active&category=featured\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected:"})," Items that are BOTH active AND featured (fewer results)\n",(0,s.jsx)(n.strong,{children:"Actual:"})," Items that are active OR featured (more results) \u274c"]}),"\n",(0,s.jsx)(n.h3,{id:"root-cause",children:"Root Cause"}),"\n",(0,s.jsxs)(n.p,{children:["There was a ",(0,s.jsx)(n.strong,{children:"key mismatch"})," in the ",(0,s.jsx)(n.code,{children:"buildSolrQuery()"})," method:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Line 2163 - WRONG KEY\n$solrQuery['filters'] = $filterQueries;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["But ",(0,s.jsx)(n.code,{children:"executeSearch()"})," was looking for:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Line 3259 - DIFFERENT KEY\nif ($key === 'fq' && is_array($value)) {\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Result:"})," Filters were never being passed to SOLR at all! No filtering was happening, so results weren't being narrowed down."]}),"\n",(0,s.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,s.jsx)(n.p,{children:"Changed line 2165 to use the correct key:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// **CRITICAL FIX**: Use 'fq' key (not 'filters') so executeSearch() can find them\n// Multiple fq parameters are ANDed together by SOLR (drilling down)\n$solrQuery['fq'] = $filterQueries;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Now filters are properly passed as multiple ",(0,s.jsx)(n.code,{children:"fq"})," parameters to SOLR:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"fq=status:active&fq=category:featured\n"})}),"\n",(0,s.jsxs)(n.p,{children:["SOLR automatically ANDs multiple ",(0,s.jsx)(n.code,{children:"fq"})," parameters together."]}),"\n",(0,s.jsx)(n.h3,{id:"how-filtering-works-now",children:"How Filtering Works Now"}),"\n",(0,s.jsx)(n.h4,{id:"single-value-filters-and-logic",children:"Single Value Filters (AND Logic)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"?status=active&category=featured\n"})}),"\n",(0,s.jsx)(n.p,{children:"Creates:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"fq=status:active\nfq=category:featured\n"})}),"\n",(0,s.jsx)(n.p,{children:"Result: active AND featured (fewer results) \u2705"}),"\n",(0,s.jsx)(n.h4,{id:"array-value-filters-or-logic-within-field",children:"Array Value Filters (OR Logic within field)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"?status[]=active&status[]=pending\n"})}),"\n",(0,s.jsx)(n.p,{children:"Creates:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"fq=(status:active OR status:pending)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Result: active OR pending (more results for that field) \u2705"}),"\n",(0,s.jsx)(n.h4,{id:"mixed-filters",children:"Mixed Filters"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"?status[]=active&status[]=pending&category=featured\n"})}),"\n",(0,s.jsx)(n.p,{children:"Creates:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"fq=(status:active OR status:pending)\nfq=category:featured\n"})}),"\n",(0,s.jsx)(n.p,{children:"Result: (active OR pending) AND featured \u2705"}),"\n",(0,s.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,s.jsx)(n.p,{children:"After deploying, test with multiple filters:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Single filter:"})," Should return subset"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Two filters:"})," Should return smaller subset (drill down)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Three filters:"})," Should return even smaller subset (drill down further)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"More filters = fewer results = drilling down \u2705"}),"\n",(0,s.jsx)(n.h3,{id:"debug-logging",children:"Debug Logging"}),"\n",(0,s.jsx)(n.p,{children:"Added extensive debug logging to diagnose filter issues:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Logs incoming query structure"}),"\n",(0,s.jsx)(n.li,{children:"Logs each filter being built"}),"\n",(0,s.jsx)(n.li,{children:"Logs final filter queries sent to SOLR"}),"\n",(0,s.jsx)(n.li,{children:"Check logs if filtering still doesn't work as expected"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Date Fixed:"})," 2024-10-14"]}),"\n",(0,s.jsx)(n.h2,{id:"uuid-label-resolution-for-facets",children:"UUID Label Resolution for Facets"}),"\n",(0,s.jsx)(n.h3,{id:"problem-statement",children:"Problem Statement"}),"\n",(0,s.jsx)(n.p,{children:"When faceting on object fields that contain UUIDs (references to other objects), the facet labels were displaying raw UUID strings instead of human-readable names. This made facets unfriendly for frontend users and also prevented proper alphabetical ordering of facet buckets."}),"\n",(0,s.jsx)(n.h3,{id:"solution-1",children:"Solution"}),"\n",(0,s.jsxs)(n.p,{children:["We implemented automatic UUID resolution for all facet types using the existing ",(0,s.jsx)(n.code,{children:"ObjectCacheService.getMultipleObjectNames()"})," method, which provides efficient batch loading and multi-tier caching."]}),"\n",(0,s.jsx)(n.h4,{id:"changes-made",children:"Changes Made"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Updated GuzzleSolrService Constructor"})," - Added ",(0,s.jsx)(n.code,{children:"ObjectCacheService"})," as a dependency"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enhanced formatTermsFacetData Method"})," - Modified to detect UUIDs, batch resolve them, and sort alphabetically by resolved names"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"UUID Detection"}),": Checks if facet values contain hyphens (simple but effective UUID detection)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch Resolution"}),": Uses ",(0,s.jsx)(n.code,{children:"ObjectCacheService.getMultipleObjectNames()"})," for efficient batch retrieval"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cache Hierarchy"}),": Checks in-memory cache \u2192 distributed cache \u2192 database"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Name Extraction"}),": Searches common name fields (naam, name, title, contractNummer, achternaam)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Alphabetical Sorting"}),": Sorts by resolved labels (case-insensitive A-Z)"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"example-result",children:"Example Result"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before UUID Resolution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "customer": {\n    "buckets": [\n      { "value": "f47ac10b-58cc-4372-a567-0e02b2c3d479", "count": 42, "label": "f47ac10b-58cc-4372-a567-0e02b2c3d479" }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After UUID Resolution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "customer": {\n    "buckets": [\n      { "value": "f47ac10b-58cc-4372-a567-0e02b2c3d479", "count": 42, "label": "Acme Corporation" }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"performance-impact",children:"Performance Impact"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"UUID detection"}),": Simple string check - negligible cost"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch loading"}),": Single query for all UUIDs instead of N queries"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cache hits"}),": Most UUIDs resolved from cache without database access"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lazy evaluation"}),": Only processes values that look like UUIDs"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"solr-field-dialog---collection-support",children:"SOLR Field Dialog - Collection Support"}),"\n",(0,s.jsx)(n.h3,{id:"issue",children:"Issue"}),"\n",(0,s.jsxs)(n.p,{children:['The "SOLR Field Configuration" dialog only showed missing fields for the ',(0,s.jsx)(n.strong,{children:"Object Collection"}),", not the ",(0,s.jsx)(n.strong,{children:"File Collection"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"solution-2",children:"Solution"}),"\n",(0,s.jsx)(n.p,{children:"Updated the backend to query both collections and return fields with collection identifiers."}),"\n",(0,s.jsx)(n.h4,{id:"changes-made-1",children:"Changes Made"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Updated ",(0,s.jsx)(n.code,{children:"SettingsController::getSolrFields()"})]})," - Now calls both ",(0,s.jsx)(n.code,{children:"getObjectCollectionFieldStatus()"})," and ",(0,s.jsx)(n.code,{children:"getFileCollectionFieldStatus()"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Fixed ",(0,s.jsx)(n.code,{children:"SolrSchemaService"})," Collection Query Methods"]})," - Properly queries both object and file collections"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Added Collection Properties"})," - Each field now includes ",(0,s.jsx)(n.code,{children:"collection"})," and ",(0,s.jsx)(n.code,{children:"collectionLabel"})," properties"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"new-response-format",children:"New Response Format"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "comparison": {\n    "total_differences": 194,\n    "missing_count": 131,\n    "extra_count": 63,\n    "missing": [\n      {\n        "name": "file_id",\n        "type": "plong",\n        "collection": "files",\n        "collectionLabel": "File Collection"\n      },\n      {\n        "name": "self_tenant",\n        "type": "string",\n        "collection": "objects",\n        "collectionLabel": "Object Collection"\n      }\n    ],\n    "object_collection": {\n      "missing": 131,\n      "extra": 50\n    },\n    "file_collection": {\n      "missing": 63,\n      "extra": 13\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"benefits",children:"Benefits"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Complete visibility - See all missing fields across all collections"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Better organization - Fields grouped by collection"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Actionable insights - Know exactly which collection needs which fields"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Consistent schema - Ensure both collections have required fields"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Date:"})," 2025-10-13"]}),"\n",(0,s.jsx)(n.h2,{id:"solr-service-refactoring-status",children:"SOLR Service Refactoring Status"}),"\n",(0,s.jsx)(n.h3,{id:"current-status",children:"Current Status"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Phase 1 In Progress"})," - Basic functionality verified"]}),"\n",(0,s.jsx)(n.h4,{id:"verified-working",children:"Verified Working"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["SOLR connection: ",(0,s.jsx)(n.strong,{children:"Connected"})]}),"\n",(0,s.jsxs)(n.li,{children:["Total Objects indexed: ",(0,s.jsx)(n.strong,{children:"57,310"})]}),"\n",(0,s.jsxs)(n.li,{children:["Published Objects: ",(0,s.jsx)(n.strong,{children:"36,750"})]}),"\n",(0,s.jsx)(n.li,{children:"Dashboard stats API: Working correctly"}),"\n",(0,s.jsx)(n.li,{children:"Object search: Functional"}),"\n",(0,s.jsxs)(n.li,{children:["Collection separation: ",(0,s.jsx)(n.code,{children:"objectCollection"})," and ",(0,s.jsx)(n.code,{children:"fileCollection"})," configured"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"completed",children:"Completed"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Created ",(0,s.jsx)(n.code,{children:"SolrObjectService"})," - Object-specific operations wrapper"]}),"\n",(0,s.jsxs)(n.li,{children:["Created ",(0,s.jsx)(n.code,{children:"SolrFileService"})," - File-specific operations wrapper with placeholder implementations"]}),"\n",(0,s.jsxs)(n.li,{children:["Updated ",(0,s.jsx)(n.code,{children:"getDashboardStats()"})," to query both collections separately"]}),"\n",(0,s.jsx)(n.li,{children:"Created comprehensive architecture documentation"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"service-architecture",children:"Service Architecture"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Current State (Phase 1):\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502        ObjectService                \u2502\n\u2502  (High-level orchestration)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502\n          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    GuzzleSolrService                \u2502\n\u2502  (Currently handles EVERYTHING)     \u2502\n\u2502  \u2022 Core SOLR operations            \u2502\n\u2502  \u2022 Object indexing                 \u2502\n\u2502  \u2022 File operations                 \u2502\n\u2502  \u2022 Search                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nTarget State (Phase 1 Complete):\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502        ObjectService                \u2502\n\u2502  (High-level orchestration)         \u2502\n\u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502               \u2502\n    \u25bc               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502SolrObjectSvc \u2502  \u2502  SolrFileSvc     \u2502\n\u2502(Objects)     \u2502  \u2502  (Files)         \u2502\n\u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502                   \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u25bc\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502  GuzzleSolrService    \u2502\n    \u2502  (Core only)          \u2502\n    \u2502  \u2022 Connection mgmt    \u2502\n    \u2502  \u2022 Collections        \u2502\n    \u2502  \u2022 HTTP client        \u2502\n    \u2502  \u2022 Admin operations   \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h3,{id:"refactoring-strategy",children:"Refactoring Strategy"}),"\n",(0,s.jsx)(n.h4,{id:"phase-1a-service-wrappers--done",children:"Phase 1A: Service Wrappers (\u2705 DONE)"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Create ",(0,s.jsx)(n.code,{children:"SolrObjectService"})," with delegation methods"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Create ",(0,s.jsx)(n.code,{children:"SolrFileService"})," with placeholder methods"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Add ",(0,s.jsx)(n.code,{children:"getObjectCollection()"})," and ",(0,s.jsx)(n.code,{children:"getFileCollection()"})," helpers"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Update dashboard stats to query both collections"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"phase-1b-gradual-migration-next",children:"Phase 1B: Gradual Migration (NEXT)"}),"\n",(0,s.jsx)(n.p,{children:"Instead of moving code immediately:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 Keep ",(0,s.jsx)(n.code,{children:"GuzzleSolrService"})," methods working as-is"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Have new services delegate to existing methods"}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 Update ",(0,s.jsx)(n.code,{children:"ObjectService"})," to use ",(0,s.jsx)(n.code,{children:"SolrObjectService"})," instead"]}),"\n",(0,s.jsx)(n.li,{children:"\u23f3 Later phases will move actual implementation"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This ensures ",(0,s.jsx)(n.strong,{children:"zero downtime"})," and ",(0,s.jsx)(n.strong,{children:"continuous functionality"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"collections-configuration",children:"Collections Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "objectCollection": "nc_test_local_objects",  // For objects\n  "fileCollection": "nc_test_local_files",      // For files (future)\n  "collection": "legacy_collection"              // Deprecated, will be removed\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"risk-assessment",children:"Risk Assessment"}),"\n",(0,s.jsx)(n.h4,{id:"low-risk-",children:"Low Risk \u2705"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Current approach (wrapper services)"}),"\n",(0,s.jsx)(n.li,{children:"Dashboard stats changes"}),"\n",(0,s.jsx)(n.li,{children:"Adding new services without removing old code"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"medium-risk-\ufe0f",children:"Medium Risk \u26a0\ufe0f"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Updating ObjectService injection"}),"\n",(0,s.jsxs)(n.li,{children:["Removing legacy ",(0,s.jsx)(n.code,{children:"collection"})," field"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"high-risk-",children:"High Risk \u274c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Moving indexing logic between services (deferred to later phase)"}),"\n",(0,s.jsx)(n.li,{children:"Changing database queries"}),"\n",(0,s.jsx)(n.li,{children:"Modifying search algorithms"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"rollback-plan",children:"Rollback Plan"}),"\n",(0,s.jsx)(n.p,{children:"If issues occur:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Revert ",(0,s.jsx)(n.code,{children:"ObjectService"})," to use ",(0,s.jsx)(n.code,{children:"GuzzleSolrService"})," directly"]}),"\n",(0,s.jsx)(n.li,{children:"Keep dashboard stats changes (they're backward compatible)"}),"\n",(0,s.jsxs)(n.li,{children:["New services (",(0,s.jsx)(n.code,{children:"SolrObjectService"}),", ",(0,s.jsx)(n.code,{children:"SolrFileService"}),") can remain as they delegate to existing methods"]}),"\n",(0,s.jsx)(n.li,{children:"No database changes have been made yet"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Date:"})," October 13, 2025"]}),"\n",(0,s.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/technical/solr-setup-configuration",children:"Solr Setup and Configuration"})," - Complete Solr setup guide"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/technical/solr-dashboard-management",children:"Solr Dashboard Management"})," - Dashboard management documentation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/Features/faceting",children:"Faceting System"})," - Faceting documentation with UUID resolution details"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);