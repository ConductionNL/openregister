"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[1801],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var t=s(96540);const r={},i=t.createContext(r);function l(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}},38673:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"developers/testing","title":"Testing","description":"Testing strategy and test groups for OpenRegister","source":"@site/docs/developers/testing.md","sourceDirName":"developers","slug":"/developers/testing","permalink":"/docs/developers/testing","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/developers/testing.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Testing","sidebar_position":10,"description":"Testing strategy and test groups for OpenRegister","keywords":["Testing","Integration Tests","Test Groups","PHPUnit","Psalm","PHPStan","PHP CodeSniffer"]},"sidebar":"tutorialSidebar","previous":{"title":"RBAC and Multi-Tenancy","permalink":"/docs/developers/rbac"},"next":{"title":"Frontend Architecture","permalink":"/docs/developers/frontend"}}');var r=s(74848),i=s(28453);const l={title:"Testing",sidebar_position:10,description:"Testing strategy and test groups for OpenRegister",keywords:["Testing","Integration Tests","Test Groups","PHPUnit","Psalm","PHPStan","PHP CodeSniffer"]},o="Testing",c={},a=[{value:"Testing Stack",id:"testing-stack",level:2},{value:"Static Analysis Tools",id:"static-analysis-tools",level:3},{value:"Psalm",id:"psalm",level:4},{value:"PHPStan",id:"phpstan",level:4},{value:"PHP CodeSniffer (phpcs)",id:"php-codesniffer-phpcs",level:4},{value:"Integration Testing",id:"integration-testing",level:3},{value:"Workflow Integration",id:"workflow-integration",level:3},{value:"Integration Test Strategy",id:"integration-test-strategy",level:2},{value:"Overview",id:"overview",level:3},{value:"Location",id:"location",level:3},{value:"Core Integration Tests",id:"core-integration-tests",level:2},{value:"Test Group 1: File Upload Tests (Tests 1-15)",id:"test-group-1-file-upload-tests-tests-1-15",level:3},{value:"Covered Functionality",id:"covered-functionality",level:4},{value:"Example Test",id:"example-test",level:4},{value:"Test Group 2: Cascade Protection Tests (Tests 16-18)",id:"test-group-2-cascade-protection-tests-tests-16-18",level:3},{value:"Covered Functionality",id:"covered-functionality-1",level:4},{value:"Why This Matters",id:"why-this-matters",level:4},{value:"Example Test",id:"example-test-1",level:4},{value:"Test Group 3: File Publishing Tests (Tests 19-22)",id:"test-group-3-file-publishing-tests-tests-19-22",level:3},{value:"Covered Functionality",id:"covered-functionality-2",level:4},{value:"Example Test",id:"example-test-2",level:4},{value:"Test Group 4: Array Filtering Tests (Tests 23-30)",id:"test-group-4-array-filtering-tests-tests-23-30",level:3},{value:"What These Tests Cover",id:"what-these-tests-cover",level:4},{value:"Covered Functionality",id:"covered-functionality-3",level:4},{value:"Example Tests",id:"example-tests",level:4},{value:"Running Tests",id:"running-tests",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Run Tests Inside Docker Container (Recommended)",id:"run-tests-inside-docker-container-recommended",level:3},{value:"Run Specific Test Groups",id:"run-specific-test-groups",level:3},{value:"Why Run in Docker Container?",id:"why-run-in-docker-container",level:3},{value:"Test Environment",id:"test-environment",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Cleanup",id:"cleanup",level:3},{value:"Writing New Tests",id:"writing-new-tests",level:2},{value:"Test Structure",id:"test-structure",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"Adding to Test Groups",id:"adding-to-test-groups",level:3},{value:"Continuous Integration",id:"continuous-integration",level:2},{value:"GitHub Actions",id:"github-actions",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Container Connection Issues",id:"container-connection-issues",level:3},{value:"Database Issues",id:"database-issues",level:3},{value:"Test Failures",id:"test-failures",level:3},{value:"Test Scope: Cross-Register vs Within-Register",id:"test-scope-cross-register-vs-within-register",level:2},{value:"Cross-Register/Schema Tests (Tests 21-22, 25-27)",id:"cross-registerschema-tests-tests-21-22-25-27",level:3},{value:"Within-Register Tests (Tests 23-24, 28)",id:"within-register-tests-tests-23-24-28",level:3},{value:"Future Test Groups",id:"future-test-groups",level:2},{value:"Best Practices",id:"best-practices-1",level:2},{value:"Code Quality Standards",id:"code-quality-standards",level:3},{value:"Static Analysis Workflow",id:"static-analysis-workflow",level:3},{value:"Common Patterns",id:"common-patterns",level:3},{value:"Dependency Injection vs Static Calls",id:"dependency-injection-vs-static-calls",level:4},{value:"Nullable Return Types",id:"nullable-return-types",level:4},{value:"Type Casting for Operations",id:"type-casting-for-operations",level:4},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"testing",children:"Testing"})}),"\n",(0,r.jsx)(n.p,{children:"OpenRegister uses a comprehensive testing stack to ensure code quality, type safety, and functionality across all components."}),"\n",(0,r.jsx)(n.h2,{id:"testing-stack",children:"Testing Stack"}),"\n",(0,r.jsx)(n.p,{children:"OpenRegister employs multiple testing and analysis tools:"}),"\n",(0,r.jsx)(n.h3,{id:"static-analysis-tools",children:"Static Analysis Tools"}),"\n",(0,r.jsx)(n.h4,{id:"psalm",children:"Psalm"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Type-safe static analysis for PHP"})}),"\n",(0,r.jsx)(n.p,{children:"Psalm performs deep static analysis to catch type errors, undefined methods, and logical issues before runtime."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Running Psalm:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# From workspace root\ncd openregister\ncomposer psalm\n\n# Or using vendor binary\n./vendor/bin/psalm --threads=1 --no-cache\n\n# Check specific file\n./vendor/bin/psalm --threads=1 --no-cache lib/Service/ObjectService.php\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Location: ",(0,r.jsx)(n.code,{children:"openregister/psalm.xml"})]}),"\n",(0,r.jsx)(n.li,{children:"Level: Baseline with incremental improvements"}),"\n",(0,r.jsx)(n.li,{children:"Excludes: Migration files"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common Psalm Fixes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add proper type hints to method parameters"}),"\n",(0,r.jsx)(n.li,{children:"Update docblock return types to match actual return types"}),"\n",(0,r.jsx)(n.li,{children:"Use dependency injection instead of static service locators"}),"\n",(0,r.jsx)(n.li,{children:"Add null checks for nullable properties"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"phpstan",children:"PHPStan"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"PHP Static Analysis Tool"})}),"\n",(0,r.jsx)(n.p,{children:"PHPStan provides additional static analysis with different rules and detection capabilities than Psalm."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Running PHPStan:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# From workspace root\ncd openregister\ncomposer phpstan\n\n# Or using vendor binary\n./vendor/bin/phpstan analyse\n\n# Check specific file\n./vendor/bin/phpstan analyse lib/Service/ObjectService.php\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Location: ",(0,r.jsx)(n.code,{children:"openregister/phpstan.neon"})]}),"\n",(0,r.jsx)(n.li,{children:"Level: 5"}),"\n",(0,r.jsxs)(n.li,{children:["Paths: ",(0,r.jsx)(n.code,{children:"lib/"})," directory"]}),"\n",(0,r.jsxs)(n.li,{children:["Excludes: ",(0,r.jsx)(n.code,{children:"lib/Migration/*"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common PHPStan Fixes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Correct parameter type mismatches"}),"\n",(0,r.jsx)(n.li,{children:"Fix undefined method calls"}),"\n",(0,r.jsx)(n.li,{children:"Handle null safety properly"}),"\n",(0,r.jsx)(n.li,{children:"Add proper return type declarations"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"php-codesniffer-phpcs",children:"PHP CodeSniffer (phpcs)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Coding standards enforcement"})}),"\n",(0,r.jsx)(n.p,{children:"PHP CodeSniffer checks code against defined coding standards (PSR-12, Nextcloud standards)."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Running phpcs:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check all files\n./vendor/bin/phpcs --standard=phpcs.xml\n\n# Check specific file\n./vendor/bin/phpcs --standard=phpcs.xml lib/Service/ObjectService.php\n\n# Auto-fix issues (where possible)\n./vendor/bin/phpcbf --standard=phpcs.xml lib/Service/ObjectService.php\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Location: ",(0,r.jsx)(n.code,{children:"openregister/phpcs.xml"})]}),"\n",(0,r.jsx)(n.li,{children:"Standards: PSR-12, Nextcloud coding standards"}),"\n",(0,r.jsx)(n.li,{children:"Enforces: Naming conventions, formatting, documentation"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common phpcs Requirements:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add docblocks to all classes, methods, and properties"}),"\n",(0,r.jsx)(n.li,{children:"Add return types to all methods"}),"\n",(0,r.jsx)(n.li,{children:"Add type hints to all method parameters"}),"\n",(0,r.jsx)(n.li,{children:"Use proper indentation and spacing"}),"\n",(0,r.jsx)(n.li,{children:"Follow PSR-12 naming conventions"}),"\n",(0,r.jsx)(n.li,{children:"Add inline comments ending with proper punctuation (full-stop, exclamation, question mark)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"integration-testing",children:"Integration Testing"}),"\n",(0,r.jsx)(n.p,{children:"PHPUnit integration tests verify functionality across components."}),"\n",(0,r.jsx)(n.h3,{id:"workflow-integration",children:"Workflow Integration"}),"\n",(0,r.jsx)(n.p,{children:"All testing tools work together in the development workflow:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"During Development"}),": Run phpcs and Psalm/PHPStan frequently to catch issues early"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Before Commit"}),": Ensure all static analysis tools pass with zero errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"In CI/CD"}),": Automated checks run on all pull requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pre-Release"}),": Full integration test suite runs"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Quick Check All Tools:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Run all static analysis tools\ncd openregister\ncomposer psalm && composer phpstan && ./vendor/bin/phpcs --standard=phpcs.xml\n"})}),"\n",(0,r.jsx)(n.h2,{id:"integration-test-strategy",children:"Integration Test Strategy"}),"\n",(0,r.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Integration tests verify that different parts of the system work together correctly by testing against a running Docker environment with:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Nextcloud container"}),"\n",(0,r.jsx)(n.li,{children:"MySQL database"}),"\n",(0,r.jsx)(n.li,{children:"Real HTTP requests"}),"\n",(0,r.jsx)(n.li,{children:"Actual file storage"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"location",children:"Location"}),"\n",(0,r.jsx)(n.p,{children:"Integration tests are located in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"openregister/tests/Integration/\n"})}),"\n",(0,r.jsx)(n.h2,{id:"core-integration-tests",children:"Core Integration Tests"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"CoreIntegrationTest.php"})," file contains organized test groups covering all major OpenRegister functionality."]}),"\n",(0,r.jsx)(n.h3,{id:"test-group-1-file-upload-tests-tests-1-15",children:"Test Group 1: File Upload Tests (Tests 1-15)"}),"\n",(0,r.jsx)(n.p,{children:"Tests for file attachment and upload functionality."}),"\n",(0,r.jsx)(n.h4,{id:"covered-functionality",children:"Covered Functionality"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Single File Uploads"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multipart form upload"}),"\n",(0,r.jsx)(n.li,{children:"Base64 data URI upload"}),"\n",(0,r.jsx)(n.li,{children:"URL reference upload (external files)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Multiple File Uploads"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multiple files in single request"}),"\n",(0,r.jsx)(n.li,{children:"File arrays (images[])"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"MIME type validation"}),"\n",(0,r.jsx)(n.li,{children:"File size limits"}),"\n",(0,r.jsx)(n.li,{children:"Corrupted base64 detection"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"File Operations"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Retrieving file metadata"}),"\n",(0,r.jsx)(n.li,{children:"Updating files"}),"\n",(0,r.jsx)(n.li,{children:"Mixed upload methods"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"example-test",children:"Example Test"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testMultipartUploadSinglePdf(): void\n{\n    $pdfContent = '%PDF-1.4 fake pdf content for testing';\n    $tmpFile = tmpfile();\n    fwrite($tmpFile, $pdfContent);\n    \n    $response = $this->client->post(\n        \"/index.php/apps/openregister/api/objects/{$register}/{$schema}\", \n        [\n            'multipart' => [\n                ['name' => 'title', 'contents' => 'Test Document'],\n                ['name' => 'attachment', 'contents' => fopen($tmpPath, 'r'), \n                 'filename' => 'test.pdf', \n                 'headers' => ['Content-Type' => 'application/pdf']\n                ],\n            ]\n        ]\n    );\n    \n    $this->assertEquals(201, $response->getStatusCode());\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"test-group-2-cascade-protection-tests-tests-16-18",children:"Test Group 2: Cascade Protection Tests (Tests 16-18)"}),"\n",(0,r.jsx)(n.p,{children:"Tests for referential integrity and cascade protection."}),"\n",(0,r.jsx)(n.h4,{id:"covered-functionality-1",children:"Covered Functionality"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Register Protection"}),": Cannot delete register with objects"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Schema Protection"}),": Cannot delete schema with objects"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleanup Workflow"}),": Can delete after proper cleanup"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"why-this-matters",children:"Why This Matters"}),"\n",(0,r.jsx)(n.p,{children:"Cascade protection prevents accidental data loss by ensuring:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Registers cannot be deleted while containing schemas or objects"}),"\n",(0,r.jsx)(n.li,{children:"Schemas cannot be deleted while containing objects"}),"\n",(0,r.jsx)(n.li,{children:"Proper cleanup order is enforced (objects \u2192 schemas \u2192 registers)"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"example-test-1",children:"Example Test"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testCannotDeleteRegisterWithObjects(): void\n{\n    // Create object\n    $response = $this->client->post(\n        \"/index.php/apps/openregister/api/objects/{$register}/{$schema}\", \n        ['json' => ['title' => 'Protection Test']]\n    );\n    \n    // Attempt to delete register\n    $deleteResponse = $this->client->delete(\n        \"/index.php/apps/openregister/api/registers/{$registerId}\"\n    );\n    \n    // Should fail with 400 or 409\n    $this->assertContains($deleteResponse->getStatusCode(), [400, 409]);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"test-group-3-file-publishing-tests-tests-19-22",children:"Test Group 3: File Publishing Tests (Tests 19-22)"}),"\n",(0,r.jsx)(n.p,{children:"Tests for file sharing, publishing, and metadata."}),"\n",(0,r.jsx)(n.h4,{id:"covered-functionality-2",children:"Covered Functionality"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"File Access Control"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Authenticated URLs for non-shared files (",(0,r.jsx)(n.code,{children:"/api/files/"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Public share URLs for published files (",(0,r.jsx)(n.code,{children:"/index.php/s/"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Auto-Publishing"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Schema-level ",(0,r.jsx)(n.code,{children:"autoPublish"})," configuration"]}),"\n",(0,r.jsx)(n.li,{children:"Automatic share creation on upload"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Metadata Integration"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Logo field mapping (",(0,r.jsx)(n.code,{children:"objectImageField"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Image metadata in ",(0,r.jsx)(n.code,{children:"@self.image"})]}),"\n",(0,r.jsx)(n.li,{children:"First-file-in-array selection"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"File Deletion"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Delete single file by sending ",(0,r.jsx)(n.code,{children:"null"})]}),"\n",(0,r.jsxs)(n.li,{children:["Delete file array by sending ",(0,r.jsx)(n.code,{children:"[]"})]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"example-test-2",children:"Example Test"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testAutoShareFileProperty(): void\n{\n    // Create schema with autoPublish\n    $schemaResponse = $this->client->post(\n        '/index.php/apps/openregister/api/schemas', \n        [\n            'json' => [\n                'register' => $registerId,\n                'slug' => 'auto-share-test',\n                'properties' => [\n                    'document' => [\n                        'type' => 'file',\n                        'autoPublish' => true\n                    ],\n                ],\n            ]\n        ]\n    );\n    \n    // Upload file\n    $response = $this->client->post(\n        \"/index.php/apps/openregister/api/objects/{$register}/{$schema}\", \n        ['multipart' => [...]]\n    );\n    \n    $object = json_decode($response->getBody(), true);\n    \n    // Verify public share URL\n    $this->assertArrayHasKey('published', $object['document']);\n    $this->assertStringContainsString(\n        '/index.php/s/', \n        $object['document']['accessUrl']\n    );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"test-group-4-array-filtering-tests-tests-23-30",children:"Test Group 4: Array Filtering Tests (Tests 23-30)"}),"\n",(0,r.jsx)(n.p,{children:"Tests for advanced filtering with AND/OR logic and dot notation."}),"\n",(0,r.jsx)(n.h4,{id:"what-these-tests-cover",children:"What These Tests Cover"}),"\n",(0,r.jsxs)(n.p,{children:["These tests verify filtering functionality ",(0,r.jsx)(n.strong,{children:"across multiple registers and schemas"}),", as well as array properties within objects:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cross-Register/Schema Filtering"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Test objects created in ",(0,r.jsx)(n.strong,{children:"different registers"})," (Register 1, Register 2)"]}),"\n",(0,r.jsxs)(n.li,{children:["Test objects created with ",(0,r.jsx)(n.strong,{children:"different schemas"})," (Schema 1, Schema 2)"]}),"\n",(0,r.jsx)(n.li,{children:"Verify AND logic returns zero results when filtering single-value fields for multiple values"}),"\n",(0,r.jsx)(n.li,{children:"Verify OR logic returns objects from multiple registers/schemas"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Object Array Property Filtering"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Test objects with array properties (e.g., 'availableColours': ['red', 'blue'])"}),"\n",(0,r.jsx)(n.li,{children:"Verify AND logic requires ALL values present in the array"}),"\n",(0,r.jsx)(n.li,{children:"Verify OR logic matches objects with ANY of the specified values"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"covered-functionality-3",children:"Covered Functionality"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Default AND Logic"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Metadata arrays: ",(0,r.jsx)(n.code,{children:"@self.register[]=1&@self.register[]=2"})," \u2192 zero results (object can't be in BOTH registers)"]}),"\n",(0,r.jsxs)(n.li,{children:["Object arrays: ",(0,r.jsx)(n.code,{children:"colours[]=red&colours[]=blue"})," \u2192 objects with BOTH colors in their array"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Explicit OR Logic"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Metadata: ",(0,r.jsx)(n.code,{children:"@self.register[or]=1,2"})," \u2192 objects from EITHER register 1 OR register 2"]}),"\n",(0,r.jsxs)(n.li,{children:["Objects: ",(0,r.jsx)(n.code,{children:"colours[or]=red,blue"})," \u2192 objects with EITHER red OR blue (or both)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dot Notation Syntax"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Clean URLs: ",(0,r.jsx)(n.code,{children:"@self.field"})," instead of ",(0,r.jsx)(n.code,{children:"@self[field]"})]}),"\n",(0,r.jsxs)(n.li,{children:["Works with operators: ",(0,r.jsx)(n.code,{children:"@self.created[gte]=2025-01-01"})]}),"\n",(0,r.jsxs)(n.li,{children:["Combines with regular filters: ",(0,r.jsx)(n.code,{children:"@self.register=5&title=Test"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Complex Scenarios"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multiple filter types combined"}),"\n",(0,r.jsx)(n.li,{children:"Nested operators"}),"\n",(0,r.jsx)(n.li,{children:"Mixed AND/OR logic across different fields"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"example-tests",children:"Example Tests"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Default AND Logic - Cross-Register Testing"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testMetadataArrayFilterDefaultAndLogic(): void\n{\n    // Step 1: Create TWO separate registers\n    $register1 = $this->client->post('/api/registers', [\n        'json' => ['slug' => 'filter-test-1', 'title' => 'Filter Test Register 1']\n    ]);\n    $register2 = $this->client->post('/api/registers', [\n        'json' => ['slug' => 'filter-test-2', 'title' => 'Filter Test Register 2']\n    ]);\n    \n    // Step 2: Create schemas in EACH register\n    $schema1 = createSchemaInRegister($register1['id']);\n    $schema2 = createSchemaInRegister($register2['id']);\n    \n    // Step 3: Create objects in DIFFERENT registers\n    $obj1 = createObjectInRegister($register1, $schema1); // In Register 1\n    $obj2 = createObjectInRegister($register2, $schema2); // In Register 2\n    \n    // Step 4: Filter with AND logic (default) - search across ALL registers\n    $url = \"/api/objects?@self.register[]={$reg1['id']}&@self.register[]={$reg2['id']}\";\n    $response = $this->client->get($url);\n    $result = json_decode($response->getBody(), true);\n    \n    // Step 5: Verify zero results (object can't be in BOTH registers simultaneously)\n    $this->assertEquals(0, $result['total']);\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Explicit OR Logic - Cross-Register Testing"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testMetadataArrayFilterExplicitOrLogicWithDotNotation(): void\n{\n    // Step 1: Create TWO separate registers\n    $register1 = createRegister('or-test-1');\n    $register2 = createRegister('or-test-2');\n    \n    // Step 2: Create schemas in EACH register\n    $schema1 = createSchemaInRegister($register1['id']);\n    $schema2 = createSchemaInRegister($register2['id']);\n    \n    // Step 3: Create objects in DIFFERENT registers\n    $obj1 = createObjectInRegister($register1, $schema1); // In Register 1\n    $obj2 = createObjectInRegister($register2, $schema2); // In Register 2\n    \n    // Step 4: Filter with OR logic using dot notation - search across ALL registers\n    $url = \"/api/objects?@self.register[or]={$reg1['id']},{$reg2['id']}\";\n    $response = $this->client->get($url);\n    $result = json_decode($response->getBody(), true);\n    \n    // Step 5: Verify BOTH objects returned (from register 1 OR register 2)\n    $this->assertGreaterThanOrEqual(2, $result['total']);\n    $returnedIds = array_column($result['results'], 'id');\n    $this->assertContains($obj1['id'], $returnedIds); // From Register 1\n    $this->assertContains($obj2['id'], $returnedIds); // From Register 2\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Object Array Property AND Logic - Within Same Register/Schema"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testObjectArrayPropertyDefaultAndLogic(): void\n{\n    // Step 1: Create ONE register with ONE schema that has array property\n    $register = createRegister('product-test');\n    $schema = $this->client->post('/api/schemas', [\n        'json' => [\n            'register' => $register['id'],\n            'slug' => 'product-schema',\n            'properties' => [\n                'title' => ['type' => 'string'],\n                'availableColours' => [\n                    'type' => 'array',\n                    'items' => ['type' => 'string']\n                ]\n            ],\n        ]\n    ]);\n    \n    // Step 2: Create products with different color combinations IN SAME REGISTER\n    $redBlue = createProduct(['red', 'blue']);        // \u2705 Has BOTH red AND blue\n    $onlyBlue = createProduct(['blue']);              // \u274c Has only blue, missing red\n    $redBlueGreen = createProduct(['red', 'blue', 'green']); // \u2705 Has BOTH red AND blue (plus green)\n    \n    // Step 3: Filter for products with BOTH red AND blue using AND logic\n    $url = \"/api/objects?availableColours[]=red&availableColours[]=blue\";\n    $response = $this->client->get($url);\n    $result = json_decode($response->getBody(), true);\n    \n    // Step 4: Verify only products with BOTH colors are returned\n    $returnedIds = array_column($result['results'], 'id');\n    $this->assertContains($redBlue['id'], $returnedIds);      // Has both\n    $this->assertContains($redBlueGreen['id'], $returnedIds); // Has both + more\n    $this->assertNotContains($onlyBlue['id'], $returnedIds);  // Missing red\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dot Notation Syntax"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testDotNotationSyntaxForMetadataFilters(): void\n{\n    // Use dot notation for metadata filter\n    $url = \"/api/objects?@self.register={$registerId}\";\n    $response = $this->client->get($url);\n    $result = json_decode($response->getBody(), true);\n    \n    // All returned objects should be from specified register\n    foreach ($result['results'] as $obj) {\n        $this->assertEquals($registerId, $obj['@self']['register']);\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"running-tests",children:"Running Tests"}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Docker containers running"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'docker ps | grep -E "nextcloud|database"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"OpenRegister app enabled"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker exec -u 33 master-nextcloud-1 php occ app:enable openregister\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"run-tests-inside-docker-container-recommended",children:"Run Tests Inside Docker Container (Recommended)"}),"\n",(0,r.jsxs)(n.p,{children:["Integration tests should be run ",(0,r.jsx)(n.strong,{children:"inside the Nextcloud Docker container"})," to have access to the full Nextcloud environment:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Run all tests\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration 2>&1"\n\n# Run specific test group with readable output\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit --filter \'testMetadataArrayFilter|testObjectArrayProperty\' tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration --testdox 2>&1"\n\n# Run single test\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit --filter testDotNotationSyntaxForMetadataFilters tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration 2>&1"\n\n# Save output to file\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration 2>&1 | tee /tmp/test-output.txt"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"run-specific-test-groups",children:"Run Specific Test Groups"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# File Upload Tests (1-15)\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit --filter testMultipart tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration --testdox"\n\n# Cascade Protection Tests (16-18)\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit --filter testCannotDelete tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration --testdox"\n\n# File Publishing Tests (19-22)\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit --filter \'testAutoShare|testLogo|testImage|testDelete\' tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration --testdox"\n\n# Array Filtering Tests (23-30)\ndocker exec master-nextcloud-1 bash -c "cd /var/www/html/apps-extra/openregister && php vendor/bin/phpunit --filter \'testMetadataArrayFilter|testObjectArrayProperty|testDotNotation|testComplex\' tests/Integration/CoreIntegrationTest.php --bootstrap tests/integration-bootstrap.php --no-configuration --testdox"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"why-run-in-docker-container",children:"Why Run in Docker Container?"}),"\n",(0,r.jsx)(n.p,{children:"Running tests inside the Docker container ensures:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Access to Nextcloud's internal API"}),"\n",(0,r.jsx)(n.li,{children:"Proper database connections"}),"\n",(0,r.jsx)(n.li,{children:"File system access"}),"\n",(0,r.jsx)(n.li,{children:"Nextcloud environment variables"}),"\n",(0,r.jsx)(n.li,{children:"PHP extensions and dependencies"}),"\n",(0,r.jsxs)(n.li,{children:["Correct base URL ('",(0,r.jsx)(n.a,{href:"http://localhost",children:"http://localhost"}),"' inside container)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"test-environment",children:"Test Environment"}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Tests use the following configuration:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Base URL"}),": ",(0,r.jsx)(n.code,{children:"http://localhost"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Auth"}),": ",(0,r.jsx)(n.code,{children:"admin:admin"})," (Basic Auth)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Containers"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"master-nextcloud-1"})," (Nextcloud)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"master-database-mysql-1"})," (MySQL)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cleanup",children:"Cleanup"}),"\n",(0,r.jsx)(n.p,{children:"Tests automatically clean up created resources:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Objects (deleted first)"}),"\n",(0,r.jsx)(n.li,{children:"Schemas (deleted second)"}),"\n",(0,r.jsx)(n.li,{children:"Registers (deleted last)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Proper cleanup order is essential for cascade protection."}),"\n",(0,r.jsx)(n.h2,{id:"writing-new-tests",children:"Writing New Tests"}),"\n",(0,r.jsx)(n.h3,{id:"test-structure",children:"Test Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function testYourFeature(): void\n{\n    // 1. Setup: Create necessary resources\n    $register = $this->createTestRegister();\n    $schema = $this->createTestSchema($register);\n    \n    // 2. Execute: Perform the test action\n    $response = $this->client->post(\n        \"/api/objects/{$register}/{$schema}\",\n        ['json' => ['title' => 'Test']]\n    );\n    \n    // 3. Assert: Verify expected behavior\n    $this->assertEquals(201, $response->getStatusCode());\n    $data = json_decode($response->getBody(), true);\n    $this->assertArrayHasKey('id', $data);\n    \n    // 4. Cleanup: Track for tearDown\n    $this->createdObjectIds[] = $data['id'];\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use unique identifiers"}),": Add ",(0,r.jsx)(n.code,{children:"uniqid()"})," to slugs to avoid conflicts"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Track created resources"}),": Add IDs to cleanup arrays"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Clear assertions"}),": Use descriptive assertion messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Isolated tests"}),": Each test should be independent"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleanup order"}),": Objects \u2192 Schemas \u2192 Registers"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"adding-to-test-groups",children:"Adding to Test Groups"}),"\n",(0,r.jsx)(n.p,{children:"When adding tests, follow the existing group structure:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tests 1-15"}),": File uploads"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tests 16-18"}),": Cascade protection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tests 19-22"}),": File publishing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tests 23-30"}),": Array filtering"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tests 31+"}),": Your new group"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Update the class-level docblock when adding new groups."}),"\n",(0,r.jsx)(n.h2,{id:"continuous-integration",children:"Continuous Integration"}),"\n",(0,r.jsx)(n.h3,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,r.jsx)(n.p,{children:"Tests can be integrated with GitHub Actions:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"name: Integration Tests\n\non: [push, pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n      - name: Start Docker containers\n        run: docker-compose up -d\n      - name: Run tests\n        run: ./vendor/bin/phpunit tests/Integration/\n"})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"container-connection-issues",children:"Container Connection Issues"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check container status\ndocker ps\n\n# Check container logs\ndocker logs master-nextcloud-1\n\n# Restart containers\ndocker-compose restart\n"})}),"\n",(0,r.jsx)(n.h3,{id:"database-issues",children:"Database Issues"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Access database\ndocker exec -it master-database-mysql-1 mysql -u nextcloud -pnextcloud nextcloud\n\n# Check object count\nSELECT COUNT(*) FROM oc_openregister_objects;\n\n# Clean test data\nDELETE FROM oc_openregister_objects WHERE register IN (\n    SELECT id FROM oc_openregister_registers WHERE slug LIKE 'test-%'\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"test-failures",children:"Test Failures"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check container logs"})," for errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Verify app is enabled"}),": ",(0,r.jsx)(n.code,{children:"php occ app:list | grep openregister"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Check database connections"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ensure proper cleanup"})," between test runs"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"test-scope-cross-register-vs-within-register",children:"Test Scope: Cross-Register vs Within-Register"}),"\n",(0,r.jsx)(n.p,{children:"Understanding test scope is important for debugging and extending tests:"}),"\n",(0,r.jsx)(n.h3,{id:"cross-registerschema-tests-tests-21-22-25-27",children:"Cross-Register/Schema Tests (Tests 21-22, 25-27)"}),"\n",(0,r.jsxs)(n.p,{children:["These tests create ",(0,r.jsx)(n.strong,{children:"multiple registers and schemas"})," to verify filtering works across different data boundaries:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:'graph TB\n    subgraph "Register 1"\n        S1[Schema 1]\n        O1[Object 1]\n        S1 --\x3e O1\n    end\n    subgraph "Register 2"\n        S2[Schema 2]\n        O2[Object 2]\n        S2 --\x3e O2\n    end\n    \n    API[API Filter Query]\n    API --\x3e|"@self.register[or]=1,2"| O1\n    API --\x3e|"@self.register[or]=1,2"| O2\n    \n    style API fill:#f9f,stroke:#333\n    style O1 fill:#bfb,stroke:#333\n    style O2 fill:#bfb,stroke:#333\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Verify that:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OR logic can retrieve objects from multiple registers"}),"\n",(0,r.jsx)(n.li,{children:"AND logic correctly returns zero results for single-value fields"}),"\n",(0,r.jsx)(n.li,{children:"Dot notation works across register boundaries"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"within-register-tests-tests-23-24-28",children:"Within-Register Tests (Tests 23-24, 28)"}),"\n",(0,r.jsxs)(n.p,{children:["These tests use ",(0,r.jsx)(n.strong,{children:"one register with one schema"})," to verify array property filtering:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:'graph TB\n    subgraph "Single Register"\n        S1[Product Schema]\n        O1["Object 1<br/>colors: [red, blue]"]\n        O2["Object 2<br/>colors: [blue]"]\n        O3["Object 3<br/>colors: [red, blue, green]"]\n        S1 --\x3e O1\n        S1 --\x3e O2\n        S1 --\x3e O3\n    end\n    \n    API[API Filter Query]\n    API --\x3e|"colors[]=red&colors[]=blue"| O1\n    API --\x3e|"colors[]=red&colors[]=blue"| O3\n    \n    style API fill:#f9f,stroke:#333\n    style O1 fill:#bfb,stroke:#333\n    style O3 fill:#bfb,stroke:#333\n    style O2 fill:#fbb,stroke:#333\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Verify that:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"AND logic requires ALL array values to be present"}),"\n",(0,r.jsx)(n.li,{children:"OR logic matches ANY array value"}),"\n",(0,r.jsx)(n.li,{children:"Array filtering works within object properties"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"future-test-groups",children:"Future Test Groups"}),"\n",(0,r.jsx)(n.p,{children:"Planned additional test groups:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RBAC Tests"}),": Role-based access control"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multi-tenancy Tests"}),": Organization isolation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Search Tests"}),": Full-text and filtered search"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Solr Integration Tests"}),": Search engine functionality"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance Tests"}),": Bulk operations and optimization"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices-1",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"code-quality-standards",children:"Code Quality Standards"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Zero Errors Policy"}),": All code must pass all static analysis tools with zero errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Warnings Are OK"}),": Warnings are tracked but do not block development"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Fix Before Commit"}),": Run all tools before committing changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Incremental Improvements"}),": Address warnings gradually in separate commits"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"static-analysis-workflow",children:"Static Analysis Workflow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# 1. Check for errors only\n./vendor/bin/phpcs --standard=phpcs.xml --error-severity=1 --warning-severity=0 lib/\n\n# 2. Run Psalm\n./vendor/bin/psalm --threads=1 --no-cache\n\n# 3. Run PHPStan\n./vendor/bin/phpstan analyse\n\n# 4. If all pass, commit changes\ngit add .\ngit commit -m "feat: implement feature X"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,r.jsx)(n.h4,{id:"dependency-injection-vs-static-calls",children:"Dependency Injection vs Static Calls"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Bad (triggers Psalm/PHPStan errors):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$mapper = \\OC::$server->get('OCA\\OpenRegister\\Db\\ObjectMapper');\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Good (passes all checks):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"public function __construct(\n    private readonly ObjectMapper $objectMapper\n) {\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"nullable-return-types",children:"Nullable Return Types"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Bad:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"/**\n * @return ValidationError\n */\npublic function getErrors(): ?ValidationError\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Good:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"/**\n * @return ValidationError|null Returns validation errors or null if none exist.\n */\npublic function getErrors(): ?ValidationError\n"})}),"\n",(0,r.jsx)(n.h4,{id:"type-casting-for-operations",children:"Type Casting for Operations"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Bad:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$control += ($character * $multiplier); // String * int triggers error\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Good:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$control += ((int) $character * $multiplier); // Explicit cast\n"})}),"\n",(0,r.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/Features/search",children:"Search Documentation"})," - Array filtering details"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/Features/files",children:"File Management"})," - File upload specifications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/api/objects",children:"API Documentation"})," - API endpoint reference"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://docs.nextcloud.com/server/latest/developer_manual/digging_deeper/codingguidelines.html",children:"Coding Standards"})," - Nextcloud coding guidelines"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);