"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[7340],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(96540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}},50883:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"development/deeplinking-spot","title":"Deep Linking and SPOT Architecture","description":"How deep linking works in OpenRegister and how SPOT (Single Point Of Truth) is achieved via the URL","source":"@site/docs/development/deeplinking-spot.md","sourceDirName":"development","slug":"/development/deeplinking-spot","permalink":"/docs/development/deeplinking-spot","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/development/deeplinking-spot.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Deep Linking and SPOT Architecture","sidebar_position":1,"description":"How deep linking works in OpenRegister and how SPOT (Single Point Of Truth) is achieved via the URL","keywords":["Open Register","Deep Linking","SPOT","Single Point Of Truth","Routing"]},"sidebar":"tutorialSidebar","previous":{"title":"Contributing","permalink":"/docs/development/contributing"},"next":{"title":"Git Submodules Development Guide","permalink":"/docs/development/git-submodules"}}');var r=t(74848),s=t(28453);const a={title:"Deep Linking and SPOT Architecture",sidebar_position:1,description:"How deep linking works in OpenRegister and how SPOT (Single Point Of Truth) is achieved via the URL",keywords:["Open Register","Deep Linking","SPOT","Single Point Of Truth","Routing"]},o="Deep Linking and SPOT (Single Point Of Truth) Architecture",l={},d=[{value:"Goals",id:"goals",level:2},{value:"Backend Page Routes (Server-Side Deeplinking)",id:"backend-page-routes-server-side-deeplinking",level:2},{value:"Frontend SPA Router (Client-Side Deeplinking)",id:"frontend-spa-router-client-side-deeplinking",level:2},{value:"Views Composition",id:"views-composition",level:2},{value:"Navigation Without <code>navigationStore</code>",id:"navigation-without-navigationstore",level:2},{value:"Route-Driven Sidebars",id:"route-driven-sidebars",level:2},{value:"SPOT: URL As The Single Source of Truth",id:"spot-url-as-the-single-source-of-truth",level:2},{value:"Building Query from State",id:"building-query-from-state",level:3},{value:"Writing Query to URL",id:"writing-query-to-url",level:3},{value:"Reading Query from URL",id:"reading-query-from-url",level:3},{value:"Modal State and SPOT",id:"modal-state-and-spot",level:2},{value:"Adding A New Page With Deeplinking &amp; (Optional) SPOT",id:"adding-a-new-page-with-deeplinking--optional-spot",level:2},{value:"Example Deep Links",id:"example-deep-links",level:2},{value:"Pitfalls and Best Practices",id:"pitfalls-and-best-practices",level:2},{value:"Quick Checklist",id:"quick-checklist",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"deep-linking-and-spot-single-point-of-truth-architecture",children:"Deep Linking and SPOT (Single Point Of Truth) Architecture"})}),"\n",(0,r.jsx)(n.p,{children:"This document explains how deep linking works in OpenRegister and how SPOT is achieved via the URL, ensuring a consistent, reliable, and shareable application state across backend and frontend."}),"\n",(0,r.jsx)(n.h2,{id:"goals",children:"Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deep linking"}),": Directly navigate to any app view via URL, including first load and refresh, without backend errors."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Single Point Of Truth (SPOT)"}),": Treat the browser URL (path + query) as the authoritative state for view selection and filters. All UI state that should be shareable/bookmarkable lives in the URL."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consistency"}),": Backend page routes and frontend SPA routes must stay in sync."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"backend-page-routes-server-side-deeplinking",children:"Backend Page Routes (Server-Side Deeplinking)"}),"\n",(0,r.jsxs)(n.p,{children:["All page-level routes must exist in the backend to serve the SPA entry for history-mode routing. These routes map to controllers and a ",(0,r.jsx)(n.code,{children:"page()"})," action which returns the app template."]}),"\n",(0,r.jsxs)(n.p,{children:["Key page routes are defined in ",(0,r.jsx)(n.code,{children:"appinfo/routes.php"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Page routes\n['name' => 'dashboard#page', 'url' => '/', 'verb' => 'GET'],\n['name' => 'registers#page', 'url' => '/registers', 'verb' => 'GET'],\n['name' => 'registersDetails#page', 'url' => '/registers/{id}', 'verb' => 'GET', 'requirements' => ['id' => '[^/]+']],\n['name' => 'schemas#page', 'url' => '/schemas', 'verb' => 'GET'],\n['name' => 'schemasDetails#page', 'url' => '/schemas/{id}', 'verb' => 'GET', 'requirements' => ['id' => '[^/]+']],\n['name' => 'sources#page', 'url' => '/sources', 'verb' => 'GET'],\n['name' => 'organisation#page', 'url' => '/organisation', 'verb' => 'GET'],\n['name' => 'objects#page', 'url' => '/objects', 'verb' => 'GET'],\n['name' => 'tables#page', 'url' => '/tables', 'verb' => 'GET'],\n['name' => 'chat#page', 'url' => '/chat', 'verb' => 'GET'],\n['name' => 'configurations#page', 'url' => '/configurations', 'verb' => 'GET'],\n['name' => 'deleted#page', 'url' => '/deleted', 'verb' => 'GET'],\n['name' => 'auditTrail#page', 'url' => '/audit-trails', 'verb' => 'GET'],\n['name' => 'searchTrail#page', 'url' => '/search-trails', 'verb' => 'GET'],\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For each page route, there must be a corresponding controller under ",(0,r.jsx)(n.code,{children:"lib/Controller/"})," with a ",(0,r.jsx)(n.code,{children:"page()"})," action that returns a ",(0,r.jsx)(n.code,{children:"TemplateResponse"}),". A minimal controller looks like:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"/**\n * This returns the template of the main app's page\n * It adds some data to the template (app version)\n *\n * @NoAdminRequired\n * @NoCSRFRequired\n *\n * @return TemplateResponse\n */\npublic function page(): TemplateResponse\n{\n    return new TemplateResponse(\n        'openregister',\n        'index',\n        []\n    );\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If a backend page route lacks a controller ",(0,r.jsx)(n.code,{children:"page()"})," action, history-mode deep linking will 500 on first-load."]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"name"})," in routes must be consistent: ",(0,r.jsx)(n.code,{children:"dashboard#page"})," means ",(0,r.jsx)(n.code,{children:"DashboardController::page()"})," and so on."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"frontend-spa-router-client-side-deeplinking",children:"Frontend SPA Router (Client-Side Deeplinking)"}),"\n",(0,r.jsx)(n.p,{children:"The Vue Router runs in history mode with a base path that matches the app entry. All SPA routes must mirror the backend page routes above."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const router = new Router({\n    mode: 'history',\n    base: '/index.php/apps/openregister/',\n    routes: [\n        { path: '/', component: Dashboard },\n        { path: '/registers', component: RegistersIndex },\n        { path: '/registers/:id', component: RegisterDetail },\n        { path: '/schemas', component: SchemasIndex },\n        { path: '/schemas/:id', component: SchemaDetails },\n        { path: '/sources', component: SourcesIndex },\n        { path: '/organisation', component: OrganisationsIndex },\n        { path: '/objects', component: ObjectsIndex },\n        { path: '/tables', component: SearchIndex },\n        { path: '/chat', component: ChatView },\n        { path: '/configurations', component: ConfigurationsIndex },\n        { path: '/deleted', component: DeletedIndex },\n        { path: '/audit-trails', component: AuditTrailIndex },\n        { path: '/search-trails', component: SearchTrailIndex },\n        { path: '*', redirect: '/' },\n    ],\n})\n"})}),"\n",(0,r.jsx)(n.p,{children:"The SPA router is installed in the Vue root instance:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"new Vue(\n    {\n        pinia,\n        router,\n        render: h => h(App),\n    },\n).$mount('#content')\n"})}),"\n",(0,r.jsx)(n.h2,{id:"views-composition",children:"Views Composition"}),"\n",(0,r.jsxs)(n.p,{children:["The app-level views component only renders the active route via ",(0,r.jsx)(n.code,{children:"<router-view />"})," to avoid double rendering:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"<NcAppContent>\n    <template #default>\n        <router-view />\n    </template>\n</NcAppContent>\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"navigation-without-navigationstore",children:["Navigation Without ",(0,r.jsx)(n.code,{children:"navigationStore"})]}),"\n",(0,r.jsxs)(n.p,{children:["Navigation is now entirely route-driven. The main menu sets ",(0,r.jsx)(n.code,{children:"active"})," based on ",(0,r.jsx)(n.code,{children:"$route.path"})," and navigates via ",(0,r.jsx)(n.code,{children:"$router.push()"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"<NcAppNavigationItem :active=\"$route.path === '/'\" :name=\"t('openregister', 'Dashboard')\" @click=\"handleNavigate('/')\">\n    <template #icon>\n        <Finance :size=\"20\" />\n    </template>\n</NcAppNavigationItem>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"methods: {\n    t,\n    handleNavigate(path) {\n        this.$router.push(path)\n    },\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The legacy ",(0,r.jsx)(n.code,{children:"navigationStore"})," is no longer used."]}),"\n",(0,r.jsx)(n.h2,{id:"route-driven-sidebars",children:"Route-Driven Sidebars"}),"\n",(0,r.jsx)(n.p,{children:"Sidebars render conditionally based on the current route, keeping sidebar state aligned with navigation."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<div>\n    <DashboardSideBar v-if="$route.path === \'/\'" />\n    <SearchSideBar v-else-if="$route.path.startsWith(\'/tables\')" />\n    <RegistersSideBar v-else-if="$route.path.startsWith(\'/registers\')" />\n    <RegisterSideBar v-else-if="/^\\/registers\\/.+/.test($route.path)" />\n    <DeletedSideBar v-else-if="$route.path.startsWith(\'/deleted\')" />\n    <AuditTrailSideBar v-else-if="$route.path.startsWith(\'/audit-trails\')" />\n    <SearchTrailSideBar v-else-if="$route.path.startsWith(\'/search-trails\')" />\n</div>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"spot-url-as-the-single-source-of-truth",children:"SPOT: URL As The Single Source of Truth"}),"\n",(0,r.jsx)(n.p,{children:"Certain views (e.g. Search Trails) fully synchronize filters and state to the URL query so links are shareable/bookmarkable and back/forward navigation works as expected."}),"\n",(0,r.jsx)(n.p,{children:"Key principles:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"URL query is authoritative. Component/store state is derived from it."}),"\n",(0,r.jsx)(n.li,{children:"Changes to filters update the URL via a debounced writer."}),"\n",(0,r.jsx)(n.li,{children:"On route changes, components parse the query and update stores/state."}),"\n",(0,r.jsx)(n.li,{children:"Use shallow-equality to avoid infinite loops when syncing state <-> URL."}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"router.replace"})," to avoid flooding history on every small change."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"building-query-from-state",children:"Building Query from State"}),"\n",(0,r.jsx)(n.p,{children:"Build a query from current state (only include active filters):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Build URL query from current component/store state\nbuildQueryFromState() {\n    const query = {}\n    // Filters\n    if (registerStore.registerItem) query.register = String(registerStore.registerItem.id)\n    if (schemaStore.schemaItem) query.schema = String(schemaStore.schemaItem.id)\n    if (this.selectedSuccessStatus && this.selectedSuccessStatus.value) query.success = String(this.selectedSuccessStatus.value)\n    if (Array.isArray(this.selectedUsers) && this.selectedUsers.length > 0) query.user = this.selectedUsers.map(u => u.value || u).join(',')\n    // JS dates are awful, so we first check if its a valid date and then get the ISO string.\n    if (this.dateFrom) query.dateFrom = new Date(this.dateFrom).getDate() ? new Date(this.dateFrom).toISOString() : null\n    if (this.dateTo) query.dateTo = new Date(this.dateTo).getDate() ? new Date(this.dateTo).toISOString() : null\n    if (this.searchTermFilter) query.searchTerm = this.searchTermFilter\n    if (this.executionTimeFrom) query.executionTimeFrom = String(this.executionTimeFrom)\n    if (this.executionTimeTo) query.executionTimeTo = String(this.executionTimeTo)\n    if (this.resultCountFrom) query.resultCountFrom = String(this.resultCountFrom)\n    if (this.resultCountTo) query.resultCountTo = String(this.resultCountTo)\n    return query\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"writing-query-to-url",children:"Writing Query to URL"}),"\n",(0,r.jsxs)(n.p,{children:["Write query to the URL only when it changes, using shallow comparison and ",(0,r.jsx)(n.code,{children:"replace"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Write current state into URL\nupdateRouteQueryFromState() {\n    if (this.$route.path !== '/search-trails') return\n    const nextQuery = this.buildQueryFromState()\n    if (this.queriesEqual(nextQuery, this.$route.query)) return\n    this.$router.replace({ path: this.$route.path, query: nextQuery })\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"reading-query-from-url",children:"Reading Query from URL"}),"\n",(0,r.jsx)(n.p,{children:"Read query from the URL and apply to component/store, being robust to async list loading (retry) and validating dates:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Read URL query and apply to component/store\napplyQueryParamsFromRoute() {\n    if (this.$route.path !== '/search-trails') return\n    const q = this.$route.query || {}\n    // Success status\n    if (typeof q.success !== 'undefined') {\n        const val = String(q.success)\n        const opt = this.successOptions.find(o => String(o.value) === val)\n        this.selectedSuccessStatus = opt || null\n    }\n    // Users\n    if (typeof q.user === 'string') {\n        const users = q.user.split(',').map(s => s.trim()).filter(Boolean)\n        this.selectedUsers = users.map(u => ({ label: u, value: u }))\n    }\n    // Dates and fields\n    // JS dates are awful, so we first check if its a valid date and then create the date. (q.dateFrom is a ISO string)\n    this.dateFrom = q.dateFrom && new Date(q.dateFrom).getDate() ? new Date(q.dateFrom) : null\n    this.dateTo = q.dateTo && new Date(q.dateTo).getDate() ? new Date(q.dateTo) : null\n    this.searchTermFilter = q.searchTerm || ''\n    this.executionTimeFrom = q.executionTimeFrom || ''\n    this.executionTimeTo = q.executionTimeTo || ''\n    this.resultCountFrom = q.resultCountFrom || ''\n    this.resultCountTo = q.resultCountTo || ''\n    // Registers & schemas depend on lists\n    const applyRegister = () => {\n        if (!q.register) return true\n        if (!registerStore.registerList.length) return false\n        const reg = registerStore.registerList.find(r => String(r.id) === String(q.register))\n        if (reg) registerStore.setRegisterItem(reg)\n        return true\n    }\n    const applySchema = () => {\n        if (!q.schema) return true\n        if (!schemaStore.schemaList.length) return false\n        const sch = schemaStore.schemaList.find(s => String(s.id) === String(q.schema))\n        if (sch) schemaStore.setSchemaItem(sch)\n        return true\n    }\n    const tryApply = (attempt = 0) => {\n        const rOk = applyRegister()\n        const sOk = applySchema()\n        // Apply store filters once selection ready\n        if (rOk && sOk) {\n            this.applyFilters()\n            this.loadActivityData()\n            return\n        }\n        if (attempt < 10) setTimeout(() => tryApply(attempt + 1), 200)\n    }\n    tryApply()\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Additional details:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Debounce user input before writing to URL to reduce churn."}),"\n",(0,r.jsxs)(n.li,{children:["Keep param names short and consistent (",(0,r.jsx)(n.code,{children:"register"}),", ",(0,r.jsx)(n.code,{children:"schema"}),", ",(0,r.jsx)(n.code,{children:"success"}),", ",(0,r.jsx)(n.code,{children:"user"}),", ",(0,r.jsx)(n.code,{children:"dateFrom"}),", ",(0,r.jsx)(n.code,{children:"dateTo"}),", etc.)."]}),"\n",(0,r.jsxs)(n.li,{children:["Arrays become comma-separated lists, booleans are stringified (",(0,r.jsx)(n.code,{children:'"true"|"false"'}),"), numbers are stringified."]}),"\n",(0,r.jsxs)(n.li,{children:["Use shallow equality (",(0,r.jsx)(n.code,{children:"queriesEqual"}),") to prevent write loops."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"modal-state-and-spot",children:"Modal State and SPOT"}),"\n",(0,r.jsx)(n.p,{children:"Current behavior:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Modal visibility/state is not encoded in the URL query. Modals (e.g. entries in ",(0,r.jsx)(n.code,{children:"src/modals/Modals.vue"})," such as ",(0,r.jsx)(n.code,{children:"src/modals/configuration/DeleteConfiguration.vue"}),") are controlled by local/component or store state triggered by in-app actions. Refreshing or sharing a URL does not reopen a modal."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Why not in URL today:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Avoids noisy history and accidental deep links into destructive flows."}),"\n",(0,r.jsx)(n.li,{children:"Keeps URLs stable while a user is mid-flow."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Possible future enhancement:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Encode modal intent in the query, for example: ",(0,r.jsx)(n.code,{children:"?modal=deleteConfiguration&configurationId=123"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Guidelines if adopted:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Read ",(0,r.jsx)(n.code,{children:"modal"})," (and any related identifiers) on mount/route changes; validate identifiers and permissions before opening."]}),"\n",(0,r.jsx)(n.li,{children:"Only open the modal if the base view (route + required data) is ready."}),"\n",(0,r.jsxs)(n.li,{children:["Write modal params with ",(0,r.jsx)(n.code,{children:"router.replace"})," on open; remove them on close to avoid history spam."]}),"\n",(0,r.jsx)(n.li,{children:"Preserve SPOT precedence: page and filters remain the authoritative state; modal is an optional overlay."}),"\n",(0,r.jsx)(n.li,{children:"Prefer non-destructive modals for deep links; keep destructive actions gated by explicit user confirmation."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"adding-a-new-page-with-deeplinking--optional-spot",children:"Adding A New Page With Deeplinking & (Optional) SPOT"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend route"}),": Add a page route in ",(0,r.jsx)(n.code,{children:"appinfo/routes.php"})," (",(0,r.jsx)(n.code,{children:"name"})," = ",(0,r.jsx)(n.code,{children:"YourController#page"}),", ",(0,r.jsx)(n.code,{children:"url"})," = ",(0,r.jsx)(n.code,{children:"/your-path"}),"). Ensure a matching controller exists in ",(0,r.jsx)(n.code,{children:"lib/Controller/YourController.php"})," with ",(0,r.jsx)(n.code,{children:"page(): TemplateResponse"})," returning the SPA template."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Frontend route"}),": Add a Vue route in ",(0,r.jsx)(n.code,{children:"src/router/index.js"})," with ",(0,r.jsx)(n.code,{children:"path: '/your-path'"})," and a component."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Navigation"}),": Add an entry in ",(0,r.jsx)(n.code,{children:"src/navigation/MainMenu.vue"})," and set ",(0,r.jsx)(n.code,{children:":active"})," using ",(0,r.jsx)(n.code,{children:"$route.path"})," or ",(0,r.jsx)(n.code,{children:"$route.path.startsWith('/your-path')"}),". Use ",(0,r.jsx)(n.code,{children:"this.$router.push('/your-path')"})," on click."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sidebars"}),": In ",(0,r.jsx)(n.code,{children:"src/sidebars/SideBars.vue"}),", conditionally render any sidebars based on ",(0,r.jsx)(n.code,{children:"$route.path"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SPOT (optional)"}),": If the page has filters/state that should be shareable, implement the SPOT pattern:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Read from ",(0,r.jsx)(n.code,{children:"$route.query"})," on mount/route change and update component/store state."]}),"\n",(0,r.jsxs)(n.li,{children:["Write to ",(0,r.jsx)(n.code,{children:"$router.replace({ query })"})," when state changes, with debounce and equality checks."]}),"\n",(0,r.jsx)(n.li,{children:"Ensure robust handling of async data dependencies (e.g., retry until lists are loaded)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"example-deep-links",children:"Example Deep Links"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Search trails filtered by register, schema, success, users and time window:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"/index.php/apps/openregister/search-trails?register=1&schema=contracts&success=true&user=alice,bob&dateFrom=2024-01-01T00:00:00.000Z&dateTo=2024-12-31T23:59:59.999Z"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Tables page: ",(0,r.jsx)(n.code,{children:"/index.php/apps/openregister/tables"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"pitfalls-and-best-practices",children:"Pitfalls and Best Practices"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend route parity"}),": Every SPA page path must have a backend page route/controller to avoid 404 on refresh."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"History base"}),": Keep ",(0,r.jsx)(n.code,{children:"router.base"})," in sync with the app mount path."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["No ",(0,r.jsx)(n.code,{children:"navigationStore"})]}),": Use ",(0,r.jsx)(n.code,{children:"$route"})," and ",(0,r.jsx)(n.code,{children:"$router"})," exclusively for navigation and active state."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Debounce & replace"}),": Debounce URL writes and use ",(0,r.jsx)(n.code,{children:"router.replace"})," to avoid noisy history."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validate inputs"}),": Validate/normalize dates and parse primitives from strings when reading from the URL."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"quick-checklist",children:"Quick Checklist"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Backend ",(0,r.jsx)(n.code,{children:"appinfo/routes.php"})," updated with page route and controller exists."]}),"\n",(0,r.jsxs)(n.li,{children:["Frontend ",(0,r.jsx)(n.code,{children:"src/router/index.js"})," has the corresponding route."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"src/views/Views.vue"})," renders ",(0,r.jsx)(n.code,{children:"<router-view />"})," only."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"src/navigation/MainMenu.vue"})," uses ",(0,r.jsx)(n.code,{children:"$router.push"})," and ",(0,r.jsx)(n.code,{children:"$route.path"})," for active state."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"src/sidebars/SideBars.vue"})," shows the correct sidebar(s) for the path."]}),"\n",(0,r.jsx)(n.li,{children:"If needed, SPOT implemented: read URL -> state, state -> URL with debounce and equality checks."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);