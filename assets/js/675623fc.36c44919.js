"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[7075],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>d});var s=i(96540);const t={},l=s.createContext(t);function r(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(l.Provider,{value:n},e.children)}},74267:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"development/file-uploads-implementation","title":"Integrated File Uploads Implementation","description":"Feature: Integrated File Uploads in Object POST/PUT Operations","source":"@site/docs/development/file-uploads-implementation.md","sourceDirName":"development","slug":"/development/file-uploads-implementation","permalink":"/docs/development/file-uploads-implementation","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/development/file-uploads-implementation.md","tags":[],"version":"current","sidebarPosition":40,"frontMatter":{"title":"Integrated File Uploads Implementation","sidebar_position":40},"sidebar":"tutorialSidebar","previous":{"title":"MagicMapper - Dynamic Schema-Based Table Management","permalink":"/docs/development/magic-mapper"},"next":{"title":"Security Architecture","permalink":"/docs/development/security-architecture"}}');var t=i(74848),l=i(28453);const r={title:"Integrated File Uploads Implementation",sidebar_position:40},d="Integrated File Uploads Implementation",c={},a=[{value:"Overview",id:"overview",level:2},{value:"Implementation Summary",id:"implementation-summary",level:2},{value:"Backend Changes",id:"backend-changes",level:3},{value:"SaveObject Handler (<code>lib/Service/ObjectHandlers/SaveObject.php</code>)",id:"saveobject-handler-libserviceobjecthandlerssaveobjectphp",level:4},{value:"ObjectService (<code>lib/Service/ObjectService.php</code>)",id:"objectservice-libserviceobjectservicephp",level:4},{value:"ObjectsController (<code>lib/Controller/ObjectsController.php</code>)",id:"objectscontroller-libcontrollerobjectscontrollerphp",level:4},{value:"RenderObject Handler (<code>lib/Service/ObjectHandlers/RenderObject.php</code>)",id:"renderobject-handler-libserviceobjecthandlersrenderobjectphp",level:4},{value:"Security Features",id:"security-features",level:3},{value:"Executable File Blocking",id:"executable-file-blocking",level:4},{value:"Virus Scanning Options",id:"virus-scanning-options",level:4},{value:"Status Code Fixes",id:"status-code-fixes",level:3},{value:"Testing Strategy",id:"testing-strategy",level:2},{value:"A. Unit Tests (Mock-Based)",id:"a-unit-tests-mock-based",level:3},{value:"B. Integration Tests (Guzzle API)",id:"b-integration-tests-guzzle-api",level:3},{value:"Integration Test Script",id:"integration-test-script",level:3},{value:"Key Architectural Decisions",id:"key-architectural-decisions",level:2},{value:"Schemas Are Independent",id:"schemas-are-independent",level:3},{value:"Unified Code Path",id:"unified-code-path",level:3},{value:"Files Modified",id:"files-modified",level:2},{value:"Core Implementation Files",id:"core-implementation-files",level:3},{value:"Test Files",id:"test-files",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Upload Method Comparison",id:"upload-method-comparison",level:3},{value:"Why Multipart is Recommended",id:"why-multipart-is-recommended",level:3},{value:"Base64 Limitations",id:"base64-limitations",level:3},{value:"URL Reference Limitations",id:"url-reference-limitations",level:3},{value:"Backward Compatibility",id:"backward-compatibility",level:2},{value:"Testing Strategy",id:"testing-strategy-1",level:2},{value:"Unit Tests (Mock-Based)",id:"unit-tests-mock-based",level:3},{value:"Integration Tests (Guzzle API)",id:"integration-tests-guzzle-api",level:3},{value:"When to Use Which?",id:"when-to-use-which",level:3},{value:"Best Practice: Run Both!",id:"best-practice-run-both",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Integration Tests Fail with &quot;Connection Refused&quot;",id:"integration-tests-fail-with-connection-refused",level:4},{value:"Integration Tests Fail with &quot;App not found&quot;",id:"integration-tests-fail-with-app-not-found",level:4},{value:"Unit Tests Fail with &quot;Class not found&quot;",id:"unit-tests-fail-with-class-not-found",level:4},{value:"Related Documentation",id:"related-documentation",level:2}];function o(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"integrated-file-uploads-implementation",children:"Integrated File Uploads Implementation"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Feature:"})," Integrated File Uploads in Object POST/PUT Operations",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Status:"})," \u2705 ",(0,t.jsx)(n.strong,{children:"COMPLETE"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Date:"})," October 2025"]}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"Successfully implemented integrated file upload functionality in OpenRegister, allowing files to be uploaded directly within object POST/PUT operations through three methods: multipart/form-data, base64-encoded, and URL references."}),"\n",(0,t.jsx)(n.h2,{id:"implementation-summary",children:"Implementation Summary"}),"\n",(0,t.jsx)(n.h3,{id:"backend-changes",children:"Backend Changes"}),"\n",(0,t.jsxs)(n.h4,{id:"saveobject-handler-libserviceobjecthandlerssaveobjectphp",children:["SaveObject Handler (",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/SaveObject.php"}),")"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Changes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Added ",(0,t.jsx)(n.code,{children:"processUploadedFiles()"})," method to handle multipart/form-data uploads"]}),"\n",(0,t.jsxs)(n.li,{children:["Extended ",(0,t.jsx)(n.code,{children:"saveObject()"})," method signature to accept ",(0,t.jsx)(n.code,{children:"?array $uploadedFiles"})," parameter"]}),"\n",(0,t.jsx)(n.li,{children:"Integrated uploaded files into the object save flow"}),"\n",(0,t.jsx)(n.li,{children:"Converts uploaded files to data URIs for processing by existing file handlers"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key Method:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"private function processUploadedFiles(array $uploadedFiles, array $data): array\n{\n    foreach ($uploadedFiles as $fieldName => $fileInfo) {\n        if ($fileInfo['error'] !== UPLOAD_ERR_OK) {\n            $this->logger->warning('File upload error...');\n            continue;\n        }\n        $fileContent = file_get_contents($fileInfo['tmp_name']);\n        $mimeType = $fileInfo['type'] ?? 'application/octet-stream';\n        $base64Content = base64_encode($fileContent);\n        $dataUri = \"data:$mimeType;base64,$base64Content\";\n        $data[$fieldName] = $dataUri;\n    }\n    return $data;\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What This Means:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Multipart uploads are converted to data URIs"}),"\n",(0,t.jsx)(n.li,{children:"Existing base64/URL handling then processes them"}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"All three upload methods now work through the same code path!"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Existing Features Leveraged:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Base64 file detection and decoding"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 URL file download and validation"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 File validation against schema configuration"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Extension inference from MIME types"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Filename generation"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 File property hydration"}),"\n"]}),"\n",(0,t.jsxs)(n.h4,{id:"objectservice-libserviceobjectservicephp",children:["ObjectService (",(0,t.jsx)(n.code,{children:"lib/Service/ObjectService.php"}),")"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Changes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Added ",(0,t.jsx)(n.code,{children:"?array $uploadedFiles"})," parameter to ",(0,t.jsx)(n.code,{children:"saveObject()"})," method"]}),"\n",(0,t.jsx)(n.li,{children:"Passes uploaded files through to SaveObject handler"}),"\n"]}),"\n",(0,t.jsxs)(n.h4,{id:"objectscontroller-libcontrollerobjectscontrollerphp",children:["ObjectsController (",(0,t.jsx)(n.code,{children:"lib/Controller/ObjectsController.php"}),")"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Changes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Added file extraction logic in ",(0,t.jsx)(n.code,{children:"create()"})," method"]}),"\n",(0,t.jsxs)(n.li,{children:["Added file extraction logic in ",(0,t.jsx)(n.code,{children:"update()"})," method"]}),"\n",(0,t.jsxs)(n.li,{children:["Extracts uploaded files from ",(0,t.jsx)(n.code,{children:"$_FILES"})," using ",(0,t.jsx)(n.code,{children:"IRequest::getUploadedFile()"})]}),"\n",(0,t.jsx)(n.li,{children:"Passes uploaded files to ObjectService"}),"\n"]}),"\n",(0,t.jsxs)(n.h4,{id:"renderobject-handler-libserviceobjecthandlersrenderobjectphp",children:["RenderObject Handler (",(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/RenderObject.php"}),")"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"No Changes Needed:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Already hydrates file IDs to full file objects"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Returns complete file metadata (id, path, accessUrl, downloadUrl, type, size, etc.)"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Supports arrays of files"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"security-features",children:"Security Features"}),"\n",(0,t.jsx)(n.h4,{id:"executable-file-blocking",children:"Executable File Blocking"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Blocks dangerous extensions: ",(0,t.jsx)(n.code,{children:".sh"}),", ",(0,t.jsx)(n.code,{children:".php"}),", ",(0,t.jsx)(n.code,{children:".exe"}),", ",(0,t.jsx)(n.code,{children:".bat"}),", ",(0,t.jsx)(n.code,{children:".cmd"}),", etc."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Magic bytes detection"})," for defense-in-depth (detects renamed executables)"]}),"\n",(0,t.jsxs)(n.li,{children:["Centralized in ",(0,t.jsx)(n.code,{children:"FileService.php"})," for all upload methods"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"virus-scanning-options",children:"Virus Scanning Options"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Recommended: Nextcloud Antivirus App + ClamAV"}),"\n",(0,t.jsx)(n.li,{children:"Alternatives: PHP ClamAV library, VirusTotal API"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"status-code-fixes",children:"Status Code Fixes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"POST"})," operations now return ",(0,t.jsx)(n.code,{children:"201 Created"})," (was ",(0,t.jsx)(n.code,{children:"200 OK"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Controllers: ",(0,t.jsx)(n.code,{children:"RegistersController"}),", ",(0,t.jsx)(n.code,{children:"SchemasController"}),", ",(0,t.jsx)(n.code,{children:"ObjectsController"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"testing-strategy",children:"Testing Strategy"}),"\n",(0,t.jsxs)(n.p,{children:["We created ",(0,t.jsx)(n.strong,{children:"TWO complementary test approaches"}),":"]}),"\n",(0,t.jsx)(n.h3,{id:"a-unit-tests-mock-based",children:"A. Unit Tests (Mock-Based)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"File:"})," ",(0,t.jsx)(n.code,{children:"tests/Unit/Service/ObjectHandlers/IntegratedFileUploadTest.php"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u26a1 ",(0,t.jsx)(n.strong,{children:"Fast"})," (<1 second)"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83d\udd27 ",(0,t.jsx)(n.strong,{children:"No dependencies"})," (all mocked)"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83c\udfaf ",(0,t.jsx)(n.strong,{children:"Tests internal logic"})," only"]}),"\n",(0,t.jsxs)(n.li,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"Does NOT create real schemas"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"Does NOT make API calls"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Cases:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Multipart file upload (mocked)"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Base64 with data URI"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 URL reference"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Arrays of files"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Mixed file types"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Upload errors"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Invalid MIME types"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Files exceeding max size"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Corrupted base64"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Array validation errors"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Run:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker exec -u 33 master-nextcloud-1 php /var/www/html/apps-extra/openregister/vendor/bin/phpunit \\\n  /var/www/html/apps-extra/openregister/tests/Unit/Service/ObjectHandlers/IntegratedFileUploadTest.php \\\n  --testdox\n"})}),"\n",(0,t.jsx)(n.h3,{id:"b-integration-tests-guzzle-api",children:"B. Integration Tests (Guzzle API)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"File:"})," ",(0,t.jsx)(n.code,{children:"tests/Integration/IntegratedFileUploadIntegrationTest.php"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\ud83d\udc0c ",(0,t.jsx)(n.strong,{children:"Slower"})," (~30 seconds)"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83d\udd27 ",(0,t.jsx)(n.strong,{children:"Requires running Nextcloud container"})]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83c\udf0d ",(0,t.jsx)(n.strong,{children:"Tests full API stack"})," (Controller \u2192 Service \u2192 FileService \u2192 Database \u2192 Filesystem)"]}),"\n",(0,t.jsxs)(n.li,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Creates real registers and schemas"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Makes real HTTP requests via Guzzle"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Matrix:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Upload Method"}),(0,t.jsx)(n.th,{children:"Schema Config"}),(0,t.jsx)(n.th,{children:"Test Case"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Multipart"}),(0,t.jsx)(n.td,{children:"Single file, PDF only"}),(0,t.jsx)(n.td,{children:"\u2705 testMultipartUploadSinglePdf"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Multipart"}),(0,t.jsx)(n.td,{children:"Multiple files"}),(0,t.jsx)(n.td,{children:"\u2705 testMultipartUploadMultipleFiles"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Data URI"}),(0,t.jsx)(n.td,{children:"\u2705 testBase64UploadWithDataUri"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"URL"}),(0,t.jsx)(n.td,{children:"External download"}),(0,t.jsx)(n.td,{children:"\u2705 testUrlReferenceUpload"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Multipart"}),(0,t.jsx)(n.td,{children:"Array of files"}),(0,t.jsx)(n.td,{children:"\u2705 testArrayOfFilesMultipart"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Array of files"}),(0,t.jsx)(n.td,{children:"\u2705 testArrayOfFilesBase64"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Wrong MIME type"}),(0,t.jsx)(n.td,{children:"\u2705 testValidationWrongMimeType"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"File too large"}),(0,t.jsx)(n.td,{children:"\u2705 testValidationFileTooLarge"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Corrupted data"}),(0,t.jsx)(n.td,{children:"\u2705 testValidationCorruptedBase64"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GET"}),(0,t.jsx)(n.td,{children:"File metadata hydration"}),(0,t.jsx)(n.td,{children:"\u2705 testGetReturnsFileMetadata"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PUT"}),(0,t.jsx)(n.td,{children:"Update with file"}),(0,t.jsx)(n.td,{children:"\u2705 testUpdateObjectWithNewFile"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Mixed"}),(0,t.jsx)(n.td,{children:"Multipart + Base64"}),(0,t.jsx)(n.td,{children:"\u2705 testMixedMethodsMultipartAndJson"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Infrastructure:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Unique register slug per test (prevents conflicts)"}),"\n",(0,t.jsx)(n.li,{children:"Schema cleanup (schemas don't cascade with registers)"}),"\n",(0,t.jsx)(n.li,{children:"Guzzle client with Basic Auth"}),"\n",(0,t.jsx)(n.li,{children:"Real API calls (no mocking)"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"integration-test-script",children:"Integration Test Script"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"File:"})," ",(0,t.jsx)(n.code,{children:"tests/integration-file-upload-test.sh"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Automated integration testing"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Creates test register & schema"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Tests all upload methods"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Tests validation failures"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Verifies GET responses"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Run:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd openregister\nchmod +x tests/integration-file-upload-test.sh\n./tests/integration-file-upload-test.sh\n"})}),"\n",(0,t.jsx)(n.h2,{id:"key-architectural-decisions",children:"Key Architectural Decisions"}),"\n",(0,t.jsx)(n.h3,{id:"schemas-are-independent",children:"Schemas Are Independent"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Schemas exist independently of registers"}),"\n",(0,t.jsx)(n.li,{children:"When a register is deleted, schemas are NOT automatically deleted"}),"\n",(0,t.jsx)(n.li,{children:"This is by design for reusability and data integrity"}),"\n",(0,t.jsx)(n.li,{children:"Testing must explicitly clean up both registers AND schemas"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"unified-code-path",children:"Unified Code Path"}),"\n",(0,t.jsx)(n.p,{children:"All three upload methods (multipart, base64, URL) flow through the same processing logic:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Multipart files \u2192 converted to data URIs"}),"\n",(0,t.jsx)(n.li,{children:"Base64 files \u2192 already in data URI format"}),"\n",(0,t.jsx)(n.li,{children:"URL files \u2192 downloaded and converted to data URIs"}),"\n",(0,t.jsxs)(n.li,{children:["All processed by existing ",(0,t.jsx)(n.code,{children:"FileService"})," methods"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"files-modified",children:"Files Modified"}),"\n",(0,t.jsx)(n.h3,{id:"core-implementation-files",children:"Core Implementation Files"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"lib/Service/ObjectHandlers/SaveObject.php"})," - Added multipart file processing"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"lib/Service/ObjectService.php"})," - Pass-through for uploaded files"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"lib/Controller/ObjectsController.php"})," - Extract files from ",(0,t.jsx)(n.code,{children:"$_FILES"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"test-files",children:"Test Files"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"tests/Unit/Service/ObjectHandlers/IntegratedFileUploadTest.php"})," - Unit tests"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"tests/Integration/IntegratedFileUploadIntegrationTest.php"})," - Integration tests"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"tests/integration-file-upload-test.sh"})," - Automated test script"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,t.jsx)(n.h3,{id:"upload-method-comparison",children:"Upload Method Comparison"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Method"}),(0,t.jsx)(n.th,{children:"Speed"}),(0,t.jsx)(n.th,{children:"File Size"}),(0,t.jsx)(n.th,{children:"Metadata"}),(0,t.jsx)(n.th,{children:"Use Case"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Multipart"})}),(0,t.jsx)(n.td,{children:"Fastest"}),(0,t.jsx)(n.td,{children:"Original"}),(0,t.jsx)(n.td,{children:"Preserved"}),(0,t.jsx)(n.td,{children:"\u2705 Recommended for all uploads"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Base64"})}),(0,t.jsx)(n.td,{children:"Medium"}),(0,t.jsx)(n.td,{children:"+33% larger"}),(0,t.jsx)(n.td,{children:"Lost"}),(0,t.jsx)(n.td,{children:"\u26a0\ufe0f Small files only (< 100 KB)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"URL"})}),(0,t.jsx)(n.td,{children:"Slowest"}),(0,t.jsx)(n.td,{children:"Original"}),(0,t.jsx)(n.td,{children:"Preserved"}),(0,t.jsx)(n.td,{children:"\ud83d\udc0c External imports only"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"why-multipart-is-recommended",children:"Why Multipart is Recommended"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Most efficient: No encoding overhead, files transferred directly"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Preserves metadata: Original filename and MIME type are maintained"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 No guessing: Extension and filename are exactly as uploaded"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Best file quality: No conversion or inference errors"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Low memory footprint: Can stream directly from disk to disk"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Fastest method: Direct transfer without intermediate conversions"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"base64-limitations",children:"Base64 Limitations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u274c +33% larger: Base64 encoding increases file size by approximately one third"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Loss of metadata: Original filename is lost"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Guessing required: System must infer extension from MIME type"}),"\n",(0,t.jsxs)(n.li,{children:["\u274c Generic names: Files get automatic names like ",(0,t.jsx)(n.code,{children:"image.png"}),", ",(0,t.jsx)(n.code,{children:"attachment.pdf"})]}),"\n",(0,t.jsx)(n.li,{children:"\u274c Higher memory usage: Entire file must be decoded in memory"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Slower: Extra CPU for encoding/decoding"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"url-reference-limitations",children:"URL Reference Limitations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u274c Backend must download: Server must fetch external URL"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Network latency: Dependent on external server response time"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Double transfer: File goes: external server \u2192 OpenRegister \u2192 Nextcloud"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Timeout risk: External servers can be slow or unresponsive"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Extra failure points: External URLs can be offline, return 404s, etc."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Performance Impact:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Multipart upload:  50ms (direct upload)\nURL reference:     500-5000ms (depending on external server)\n                   \u2191\n                   10-100x slower!\n"})}),"\n",(0,t.jsx)(n.h2,{id:"backward-compatibility",children:"Backward Compatibility"}),"\n",(0,t.jsxs)(n.p,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Existing file endpoints remain unchanged:"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"POST /api/objects/{register}/{schema}/{id}/files"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"GET /api/objects/{register}/{schema}/{id}/files"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"DELETE /api/objects/{register}/{schema}/{id}/files/{fileId}"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Both approaches work and can be used interchangeably."}),"\n",(0,t.jsx)(n.h2,{id:"testing-strategy-1",children:"Testing Strategy"}),"\n",(0,t.jsxs)(n.p,{children:["We have ",(0,t.jsx)(n.strong,{children:"two complementary test approaches"})," for the integrated file upload feature:"]}),"\n",(0,t.jsx)(n.h3,{id:"unit-tests-mock-based",children:"Unit Tests (Mock-Based)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"File:"})," ",(0,t.jsx)(n.code,{children:"tests/Unit/Service/ObjectHandlers/IntegratedFileUploadTest.php"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u26a1 ",(0,t.jsx)(n.strong,{children:"Fast"})," (<1 second)"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83d\udd27 ",(0,t.jsx)(n.strong,{children:"No dependencies"})," (all mocked)"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83c\udfaf ",(0,t.jsx)(n.strong,{children:"Tests internal logic"})," only"]}),"\n",(0,t.jsxs)(n.li,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"Does NOT create real schemas"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"Does NOT make API calls"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Cases:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Multipart file upload (mocked)"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Base64 with data URI"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 URL reference"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Arrays of files"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Mixed file types"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Upload errors"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Invalid MIME types"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Files exceeding max size"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Corrupted base64"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Array validation errors"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Run:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd openregister\n./vendor/bin/phpunit tests/Unit/Service/ObjectHandlers/IntegratedFileUploadTest.php --testdox\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u26a1 Extremely fast"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\udd27 No setup required"}),"\n",(0,t.jsx)(n.li,{children:"\ud83c\udfaf Pinpoint specific logic"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\udcca Great for code coverage"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u274c Doesn't test real file operations"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Doesn't verify API contracts"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Can't catch integration issues"}),"\n",(0,t.jsx)(n.li,{children:"\u274c Doesn't test Nextcloud file system"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"integration-tests-guzzle-api",children:"Integration Tests (Guzzle API)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"File:"})," ",(0,t.jsx)(n.code,{children:"tests/Integration/IntegratedFileUploadIntegrationTest.php"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\ud83d\udc0c ",(0,t.jsx)(n.strong,{children:"Slower"})," (~10-30 seconds)"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83d\udd27 ",(0,t.jsx)(n.strong,{children:"Requires running Nextcloud container"})," + OpenRegister enabled"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83c\udf0d ",(0,t.jsx)(n.strong,{children:"Tests full API stack"})," (API \u2192 Controller \u2192 Service \u2192 FileService \u2192 Database \u2192 File System)"]}),"\n",(0,t.jsxs)(n.li,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Creates real registers and schemas"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Makes real HTTP requests via Guzzle"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Prerequisites:"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Option A: Running inside container"})," (preferred)"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker exec -u 33 master-nextcloud-1 php /var/www/html/apps-extra/openregister/vendor/bin/phpunit \\\n  /var/www/html/apps-extra/openregister/tests/Integration/IntegratedFileUploadIntegrationTest.php \\\n  --testdox\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Option B: From host with Guzzle"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd openregister\nNEXTCLOUD_URL=http://localhost:8080 ./vendor/bin/phpunit tests/Integration/IntegratedFileUploadIntegrationTest.php --testdox\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Matrix:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Upload Method"}),(0,t.jsx)(n.th,{children:"Schema Config"}),(0,t.jsx)(n.th,{children:"Test Case"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Multipart"}),(0,t.jsx)(n.td,{children:"Single file, PDF only"}),(0,t.jsx)(n.td,{children:"\u2705 testMultipartUploadSinglePdf"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Multipart"}),(0,t.jsx)(n.td,{children:"Multiple files, mixed types"}),(0,t.jsx)(n.td,{children:"\u2705 testMultipartUploadMultipleFiles"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Data URI, PDF"}),(0,t.jsx)(n.td,{children:"\u2705 testBase64UploadWithDataUri"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"URL"}),(0,t.jsx)(n.td,{children:"External PDF download"}),(0,t.jsx)(n.td,{children:"\u2705 testUrlReferenceUpload"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Multipart"}),(0,t.jsx)(n.td,{children:"Array of images"}),(0,t.jsx)(n.td,{children:"\u2705 testArrayOfFilesMultipart"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Array of images"}),(0,t.jsx)(n.td,{children:"\u2705 testArrayOfFilesBase64"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Wrong MIME type (validation)"}),(0,t.jsx)(n.td,{children:"\u2705 testValidationWrongMimeType"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"File too large (validation)"}),(0,t.jsx)(n.td,{children:"\u2705 testValidationFileTooLarge"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Base64"}),(0,t.jsx)(n.td,{children:"Corrupted data (validation)"}),(0,t.jsx)(n.td,{children:"\u2705 testValidationCorruptedBase64"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GET"}),(0,t.jsx)(n.td,{children:"File metadata hydration"}),(0,t.jsx)(n.td,{children:"\u2705 testGetReturnsFileMetadata"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PUT"}),(0,t.jsx)(n.td,{children:"Update with new file"}),(0,t.jsx)(n.td,{children:"\u2705 testUpdateObjectWithNewFile"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Mixed"}),(0,t.jsx)(n.td,{children:"Multipart + Base64 in same request"}),(0,t.jsx)(n.td,{children:"\u2705 testMixedMethodsMultipartAndJson"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Automatic Cleanup:"})}),"\n",(0,t.jsxs)(n.p,{children:["The integration tests ",(0,t.jsx)(n.strong,{children:"automatically"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u2705 Create test registers and schemas in ",(0,t.jsx)(n.code,{children:"setUp()"})]}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Track created objects"}),"\n",(0,t.jsxs)(n.li,{children:["\u2705 Delete all objects in ",(0,t.jsx)(n.code,{children:"tearDown()"})]}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Delete test register"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"No manual cleanup needed!"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u2705 Tests real behavior"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Catches integration bugs"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Verifies API contracts"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Tests actual file system operations"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Validates database persistence"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\ud83d\udc0c Slower execution"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\udd27 Requires running environment"}),"\n",(0,t.jsx)(n.li,{children:"\ud83c\udfd7\ufe0f More complex setup"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\udce6 Harder to debug failures"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"when-to-use-which",children:"When to Use Which?"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use Unit Tests When:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\ud83d\udd27 Developing new features"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\udc1b Debugging specific logic"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\udcca Improving code coverage"}),"\n",(0,t.jsx)(n.li,{children:"\u26a1 Need fast feedback loop"}),"\n",(0,t.jsx)(n.li,{children:"\ud83c\udfaf Testing edge cases and error paths"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use Integration Tests When:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\ud83d\ude80 Before deployment"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\udd17 Verifying API contracts"}),"\n",(0,t.jsx)(n.li,{children:"\ud83d\uddc2\ufe0f Testing file operations"}),"\n",(0,t.jsx)(n.li,{children:"\ud83c\udf0d Testing with real Nextcloud environment"}),"\n",(0,t.jsx)(n.li,{children:"\u2705 Acceptance testing"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"best-practice-run-both",children:"Best Practice: Run Both!"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Development Workflow:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# 1. Fast feedback during development\n./vendor/bin/phpunit tests/Unit/Service/ObjectHandlers/IntegratedFileUploadTest.php\n\n# 2. Verify integration before commit\ndocker exec -u 33 master-nextcloud-1 php /var/www/html/apps-extra/openregister/vendor/bin/phpunit \\\n  /var/www/html/apps-extra/openregister/tests/Integration/IntegratedFileUploadIntegrationTest.php\n"})}),"\n",(0,t.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h4,{id:"integration-tests-fail-with-connection-refused",children:'Integration Tests Fail with "Connection Refused"'}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem:"})," Can't reach Nextcloud container"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# 1. Check container is running\ndocker ps | grep nextcloud\n\n# 2. Verify container name\ndocker ps --format "table {{.Names}}\\t{{.Status}}"\n\n# 3. Update baseUrl in test or set env var\nexport NEXTCLOUD_URL=http://your-container-name\n'})}),"\n",(0,t.jsx)(n.h4,{id:"integration-tests-fail-with-app-not-found",children:'Integration Tests Fail with "App not found"'}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem:"})," OpenRegister not enabled"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker exec -u 33 master-nextcloud-1 php occ app:enable openregister\n"})}),"\n",(0,t.jsx)(n.h4,{id:"unit-tests-fail-with-class-not-found",children:'Unit Tests Fail with "Class not found"'}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem:"})," Missing dependencies"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd openregister\ncomposer install\n"})}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/Features/files",children:"Files"})," - User-facing file upload documentation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/Features/files#executable-file-blocking",children:"Executable File Blocking"})," - Security features"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/technical/schemas",children:"Schema Technical Documentation"})," - Schema configuration"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);