"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[3748],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(96540);const r={},o=i.createContext(r);function a(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:n},e.children)}},63874:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"features/organisation-roles","title":"Organisation Roles (RBAC)","description":"Role-Based Access Control using Nextcloud Groups","source":"@site/docs/features/organisation-roles.md","sourceDirName":"features","slug":"/features/organisation-roles","permalink":"/docs/features/organisation-roles","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/features/organisation-roles.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Organisation Roles (RBAC)","description":"Role-Based Access Control using Nextcloud Groups"},"sidebar":"tutorialSidebar","previous":{"title":"AI Chat Interface","permalink":"/docs/features/ai"},"next":{"title":"Default Organisation Configuration","permalink":"/docs/features/organisation-default-configuration"}}');var r=s(74848),o=s(28453);const a={sidebar_position:8,title:"Organisation Roles (RBAC)",description:"Role-Based Access Control using Nextcloud Groups"},l="Organisation Roles",t={},d=[{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Database Schema",id:"database-schema",level:2},{value:"Organisation Entity",id:"organisation-entity",level:3},{value:"Database Columns",id:"database-columns",level:3},{value:"Managing Organisation Roles",id:"managing-organisation-roles",level:2},{value:"Via UI",id:"via-ui",level:3},{value:"Method 1: Edit Organisation Modal",id:"method-1-edit-organisation-modal",level:4},{value:"Method 2: Manage Roles Action (Legacy)",id:"method-2-manage-roles-action-legacy",level:4},{value:"Via API",id:"via-api",level:3},{value:"Get Organisation Roles",id:"get-organisation-roles",level:4},{value:"Update Organisation Roles",id:"update-organisation-roles",level:4},{value:"PHP API",id:"php-api",level:2},{value:"Organisation Entity Methods",id:"organisation-entity-methods",level:3},{value:"Example: Adding Groups on Organisation Creation",id:"example-adding-groups-on-organisation-creation",level:3},{value:"How It Works",id:"how-it-works",level:2},{value:"Group-Based Access",id:"group-based-access",level:3},{value:"Integration with Nextcloud Groups",id:"integration-with-nextcloud-groups",level:3},{value:"Permissions",id:"permissions",level:2},{value:"Who Can Manage Roles?",id:"who-can-manage-roles",level:3},{value:"UI Visibility",id:"ui-visibility",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"Scenario 1: Department Organisation",id:"scenario-1-department-organisation",level:3},{value:"Scenario 2: Project-Based Organisation",id:"scenario-2-project-based-organisation",level:3},{value:"Scenario 3: Multi-Tenant Organisation",id:"scenario-3-multi-tenant-organisation",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Use Descriptive Group Names",id:"1-use-descriptive-group-names",level:3},{value:"2. Organize Groups Hierarchically",id:"2-organize-groups-hierarchically",level:3},{value:"3. Regular Audits",id:"3-regular-audits",level:3},{value:"4. Document Group Purposes",id:"4-document-group-purposes",level:3},{value:"5. Separate Concerns",id:"5-separate-concerns",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Groups Not Appearing in Dropdown",id:"groups-not-appearing-in-dropdown",level:3},{value:"Roles Not Saving",id:"roles-not-saving",level:3},{value:"Default Organisation Flag Missing",id:"default-organisation-flag-missing",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"ManageOrganisationRoles Modal Component",id:"manageorganisationroles-modal-component",level:3},{value:"Migration History",id:"migration-history",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"organisation-roles",children:"Organisation Roles"})}),"\n",(0,r.jsx)(n.p,{children:"OpenRegister integrates with Nextcloud's group system to provide Role-Based Access Control (RBAC) at the organisation level."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Each organisation can have one or more Nextcloud groups assigned as 'roles'. Users who belong to these groups automatically get access to the organisation's resources based on their group membership and Nextcloud's native permission system."}),"\n",(0,r.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nextcloud Integration"}),": Uses existing Nextcloud groups - no separate role management needed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Flexible Assignment"}),": Associate any number of Nextcloud groups with an organisation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Native Permissions"}),": Leverage Nextcloud's built-in group permissions and access controls"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Easy Management"}),": Visual interface for assigning/removing groups from organisations"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"database-schema",children:"Database Schema"}),"\n",(0,r.jsx)(n.h3,{id:"organisation-entity",children:"Organisation Entity"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"Organisation"})," entity includes:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"protected ?array $roles = [];\n"})}),"\n",(0,r.jsx)(n.p,{children:"This JSON field stores an array of group definitions:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "roles": [\n    {\n      "id": "group-id",\n      "name": "Group Display Name",\n      "userCount": 5\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"database-columns",children:"Database Columns"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Column"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"roles"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"longtext"})," (JSON)"]}),(0,r.jsx)(n.td,{children:"Array of Nextcloud group definitions"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"active"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tinyint(1)"})}),(0,r.jsx)(n.td,{children:"Whether the organisation is active"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"managing-organisation-roles",children:"Managing Organisation Roles"}),"\n",(0,r.jsx)(n.h3,{id:"via-ui",children:"Via UI"}),"\n",(0,r.jsx)(n.p,{children:"There are two ways to manage organisation roles through the user interface:"}),"\n",(0,r.jsx)(n.h4,{id:"method-1-edit-organisation-modal",children:"Method 1: Edit Organisation Modal"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Navigate to ",(0,r.jsx)(n.strong,{children:"Organisation Details"})," or ",(0,r.jsx)(n.strong,{children:"Organisation List"})]}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Edit"})," on an organisation or ",(0,r.jsx)(n.strong,{children:"Create Organisation"})," to add a new one"]}),"\n",(0,r.jsxs)(n.li,{children:["In the ",(0,r.jsx)(n.strong,{children:"Edit Organisation"})," modal:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Basic Information Tab"}),": Use the 'Nextcloud Groups' multi-select dropdown to quickly add or remove groups"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security Tab"}),": View the complete list of assigned groups with the ability to remove individual groups"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"})," or ",(0,r.jsx)(n.strong,{children:"Create"})," to persist changes"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"method-2-manage-roles-action-legacy",children:"Method 2: Manage Roles Action (Legacy)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Navigate to ",(0,r.jsx)(n.strong,{children:"Organisation Details"})," or ",(0,r.jsx)(n.strong,{children:"Organisation List"})]}),"\n",(0,r.jsxs)(n.li,{children:["Click the ",(0,r.jsx)(n.strong,{children:"Actions"})," menu (three dots)"]}),"\n",(0,r.jsxs)(n.li,{children:["Select ",(0,r.jsx)(n.strong,{children:"Manage Roles"})]}),"\n",(0,r.jsxs)(n.li,{children:["In the modal:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"View currently assigned groups"}),"\n",(0,r.jsx)(n.li,{children:"Add new groups from the dropdown"}),"\n",(0,r.jsx)(n.li,{children:"Remove groups by clicking the X icon"}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save Roles"})," to persist changes"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Recommended Approach"}),": Use the Edit Organisation modal (Method 1) for a streamlined experience where you can manage groups alongside other organisation settings."]}),"\n",(0,r.jsx)(n.h3,{id:"via-api",children:"Via API"}),"\n",(0,r.jsx)(n.h4,{id:"get-organisation-roles",children:"Get Organisation Roles"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /index.php/apps/openregister/api/organisations/{uuid}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response includes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "uuid": "org-uuid-123",\n  "name": "My Organisation",\n  "roles": [\n    {\n      "id": "editors",\n      "name": "Editors",\n      "userCount": 10\n    }\n  ],\n  "roleCount": 1\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"update-organisation-roles",children:"Update Organisation Roles"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"PUT /index.php/apps/openregister/api/organisations/{uuid}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Request body:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "roles": [\n    {\n      "id": "editors",\n      "name": "Editors",\n      "userCount": 10\n    },\n    {\n      "id": "viewers",\n      "name": "Viewers",\n      "userCount": 50\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"php-api",children:"PHP API"}),"\n",(0,r.jsx)(n.h3,{id:"organisation-entity-methods",children:"Organisation Entity Methods"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Add a role to the organisation\n$organisation->addRole([\n    'id' => 'group-id',\n    'name' => 'Group Name',\n    'userCount' => 5\n]);\n\n// Remove a role\n$organisation->removeRole('group-id');\n\n// Check if organisation has a role\nif ($organisation->hasRole('group-id')) {\n    // ...\n}\n\n// Get a specific role\n$role = $organisation->getRole('group-id');\n\n// Get all roles\n$roles = $organisation->getRoles();\n\n// Set all roles at once\n$organisation->setRoles($rolesArray);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-adding-groups-on-organisation-creation",children:"Example: Adding Groups on Organisation Creation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"use OCA\\OpenRegister\\Service\\OrganisationService;\n\n$organisation = $organisationService->createOrganisation(\n    'Research Department',\n    'Handles all research activities'\n);\n\n// Add groups as roles\n$organisation->addRole([\n    'id' => 'researchers',\n    'name' => 'Researchers',\n    'userCount' => 25\n]);\n\n$organisation->addRole([\n    'id' => 'lab-managers',\n    'name' => 'Lab Managers',\n    'userCount' => 5\n]);\n\n$organisationMapper->update($organisation);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,r.jsx)(n.h3,{id:"group-based-access",children:"Group-Based Access"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Group Assignment"}),": Nextcloud groups are assigned to organisations as 'roles'"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User Membership"}),": Users are added to Nextcloud groups through normal Nextcloud user management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access Control"}),": When a user tries to access organisation resources:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check if user is in the organisation"}),"\n",(0,r.jsx)(n.li,{children:"Check if user belongs to any of the organisation's assigned groups"}),"\n",(0,r.jsx)(n.li,{children:"Apply Nextcloud's native group permissions"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"integration-with-nextcloud-groups",children:"Integration with Nextcloud Groups"}),"\n",(0,r.jsxs)(n.p,{children:["OpenRegister leverages Nextcloud's ",(0,r.jsx)(n.code,{children:"/ocs/v2.php/cloud/groups/details"})," API to:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"List available groups"}),"\n",(0,r.jsx)(n.li,{children:"Get group member counts"}),"\n",(0,r.jsx)(n.li,{children:"Display group metadata"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"No duplication of user-role assignments - everything is managed through Nextcloud's native group system."}),"\n",(0,r.jsx)(n.h2,{id:"permissions",children:"Permissions"}),"\n",(0,r.jsx)(n.h3,{id:"who-can-manage-roles",children:"Who Can Manage Roles?"}),"\n",(0,r.jsxs)(n.p,{children:["Only users who can ",(0,r.jsx)(n.strong,{children:"edit"})," the organisation can manage its roles:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Organisation owner"}),"\n",(0,r.jsx)(n.li,{children:"System administrators"}),"\n",(0,r.jsx)(n.li,{children:"Users with organisation edit permissions"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"ui-visibility",children:"UI Visibility"}),"\n",(0,r.jsx)(n.p,{children:'The "Manage Roles" button only appears if:'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"canEditOrganisation(organisation)\n"})}),"\n",(0,r.jsx)(n.p,{children:"This ensures proper access control for role management."}),"\n",(0,r.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsx)(n.h3,{id:"scenario-1-department-organisation",children:"Scenario 1: Department Organisation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Organisation: 'Engineering Department'\nRoles:\n  - 'engineers' (50 users) - Full access to engineering resources\n  - 'engineering-managers' (5 users) - Administrative access\n  - 'interns' (10 users) - Read-only access\n"})}),"\n",(0,r.jsx)(n.h3,{id:"scenario-2-project-based-organisation",children:"Scenario 2: Project-Based Organisation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Organisation: 'Website Redesign Project'\nRoles:\n  - 'designers' (8 users) - Design asset access\n  - 'developers' (12 users) - Code repository access\n  - 'project-managers' (2 users) - Full project oversight\n"})}),"\n",(0,r.jsx)(n.h3,{id:"scenario-3-multi-tenant-organisation",children:"Scenario 3: Multi-Tenant Organisation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Organisation: 'Client: Acme Corp'\nRoles:\n  - 'acme-admins' (3 users) - Client administrators\n  - 'acme-users' (100 users) - Regular client users\n  - 'support-staff' (10 users) - Internal support team\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-use-descriptive-group-names",children:"1. Use Descriptive Group Names"}),"\n",(0,r.jsx)(n.p,{children:"Create Nextcloud groups with clear, descriptive names:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.code,{children:"marketing-editors"}),", ",(0,r.jsx)(n.code,{children:"finance-viewers"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u274c ",(0,r.jsx)(n.code,{children:"group1"}),", ",(0,r.jsx)(n.code,{children:"temp-group"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-organize-groups-hierarchically",children:"2. Organize Groups Hierarchically"}),"\n",(0,r.jsx)(n.p,{children:"Use prefixes for related groups:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"hr-administrators\nhr-managers\nhr-staff\nhr-contractors\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-regular-audits",children:"3. Regular Audits"}),"\n",(0,r.jsx)(n.p,{children:"Periodically review:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Which groups are assigned to each organisation"}),"\n",(0,r.jsx)(n.li,{children:"Whether group members still need access"}),"\n",(0,r.jsx)(n.li,{children:"Unused or obsolete groups"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-document-group-purposes",children:"4. Document Group Purposes"}),"\n",(0,r.jsx)(n.p,{children:"In Nextcloud's group descriptions, document:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"What access the group provides"}),"\n",(0,r.jsx)(n.li,{children:"Which organisations use this group"}),"\n",(0,r.jsx)(n.li,{children:"Who should be added to the group"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-separate-concerns",children:"5. Separate Concerns"}),"\n",(0,r.jsx)(n.p,{children:"Don't mix unrelated permissions in a single group:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 Create ",(0,r.jsx)(n.code,{children:"project-a-editors"})," and ",(0,r.jsx)(n.code,{children:"project-b-editors"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u274c Use single ",(0,r.jsx)(n.code,{children:"editors"})," group for all projects"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"groups-not-appearing-in-dropdown",children:"Groups Not Appearing in Dropdown"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Available groups list is empty"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Verify Nextcloud groups exist: Settings \u2192 Users \u2192 Groups"}),"\n",(0,r.jsxs)(n.li,{children:["Check OCS API access: ",(0,r.jsx)(n.code,{children:"curl -u admin:password http://nextcloud/ocs/v2.php/cloud/groups/details"})]}),"\n",(0,r.jsx)(n.li,{children:"Review browser console for API errors"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"roles-not-saving",children:"Roles Not Saving"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Changes to roles are not persisted"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Verify user has edit permissions for the organisation"}),"\n",(0,r.jsxs)(n.li,{children:["Check database column exists: ",(0,r.jsx)(n.code,{children:"SHOW COLUMNS FROM oc_openregister_organisations LIKE 'roles'"})]}),"\n",(0,r.jsxs)(n.li,{children:["Run migrations: ",(0,r.jsx)(n.code,{children:"php occ migrations:migrate openregister"})]}),"\n",(0,r.jsx)(n.li,{children:"Check server logs for errors"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"default-organisation-flag-missing",children:"Default Organisation Flag Missing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Multiple organisations but none marked as default"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Check database: ",(0,r.jsx)(n.code,{children:"SELECT id, name, is_default FROM oc_openregister_organisations"})]}),"\n",(0,r.jsx)(n.li,{children:"Set default manually:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"UPDATE oc_openregister_organisations SET is_default = 1 WHERE id = 1 LIMIT 1;\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Remove duplicates if needed"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,r.jsx)(n.h3,{id:"manageorganisationroles-modal-component",children:"ManageOrganisationRoles Modal Component"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Props"}),": None (uses organisationStore.organisationItem)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Events"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Modal opened: Loads Nextcloud groups"}),"\n",(0,r.jsx)(n.li,{children:"Role added: Updates local state"}),"\n",(0,r.jsx)(n.li,{children:"Role removed: Updates local state"}),"\n",(0,r.jsx)(n.li,{children:"Save clicked: Persists to backend via organisationStore"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Methods"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"loadNextcloudGroups()"})," - Fetches groups from Nextcloud OCS API"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"addRole(group)"})," - Adds a group to selected roles"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"removeRole(role)"})," - Removes a group from selected roles"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"saveRoles()"})," - Saves changes to backend"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"migration-history",children:"Migration History"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Version"}),(0,r.jsx)(n.th,{children:"Migration"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"1.0"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Version1Date20250102000000"})}),(0,r.jsxs)(n.td,{children:["Added ",(0,r.jsx)(n.code,{children:"roles"})," column (JSON, default ",(0,r.jsx)(n.code,{children:"[]"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"1.0"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Version1Date20250102000001"})}),(0,r.jsxs)(n.td,{children:["Added ",(0,r.jsx)(n.code,{children:"active"})," column (boolean, default ",(0,r.jsx)(n.code,{children:"true"}),")"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,r.jsx)(n.p,{children:"Potential improvements for future versions:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Role Templates"}),": Pre-defined role sets for common scenarios"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nested Groups"}),": Support for Nextcloud group hierarchies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Permission Presets"}),": Quick-apply common permission patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit Logging"}),": Track role assignment changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bulk Operations"}),": Assign roles to multiple organisations at once"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Role Inheritance"}),": Child organisations inherit parent roles"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/Features/organisations",children:"Organisation Management"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/developers/rbac",children:"RBAC (Role-Based Access Control)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.nextcloud.com/server/latest/admin_manual/configuration_user/user_configuration.html",children:"Nextcloud Groups Documentation"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);