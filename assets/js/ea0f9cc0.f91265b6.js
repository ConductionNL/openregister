"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[7162],{14815:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"technical/solr-setup-configuration","title":"SOLR Setup and Configuration Guide","description":"This guide documents the complete SOLR setup process used by OpenRegister, including SolrCloud configuration requirements, authentication handling, and system field pre-configuration.","source":"@site/docs/technical/solr-setup-configuration.md","sourceDirName":"technical","slug":"/technical/solr-setup-configuration","permalink":"/docs/technical/solr-setup-configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/technical/solr-setup-configuration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Solr Published-Only Indexing","permalink":"/docs/technical/solr-published-only-indexing"},"next":{"title":"Unified Faceting System","permalink":"/docs/technical/unified-faceting-system"}}');var l=i(74848),t=i(28453);const r={},o="SOLR Setup and Configuration Guide",d={},c=[{value:"Overview",id:"overview",level:2},{value:"SOLR Configuration Requirements",id:"solr-configuration-requirements",level:2},{value:"SolrCloud Mode",id:"solrcloud-mode",level:3},{value:"Key SolrCloud Requirements",id:"key-solrcloud-requirements",level:3},{value:"Authentication and Security",id:"authentication-and-security",level:2},{value:"Development Configuration",id:"development-configuration",level:3},{value:"Production Considerations",id:"production-considerations",level:3},{value:"Setup Process Architecture",id:"setup-process-architecture",level:2},{value:"1. Tenant ID Generation",id:"1-tenant-id-generation",level:3},{value:"2. ConfigSet Creation Strategy",id:"2-configset-creation-strategy",level:3},{value:"Base ConfigSet Download",id:"base-configset-download",level:4},{value:"System Fields Integration",id:"system-fields-integration",level:4},{value:"ZIP Package Creation",id:"zip-package-creation",level:4},{value:"3. ConfigSet Upload Process",id:"3-configset-upload-process",level:3},{value:"Upload API Usage",id:"upload-api-usage",level:4},{value:"Why ZIP Upload vs CREATE",id:"why-zip-upload-vs-create",level:4},{value:"4. Collection Creation",id:"4-collection-creation",level:3},{value:"Tenant-Specific Naming",id:"tenant-specific-naming",level:4},{value:"Collection API Call",id:"collection-api-call",level:4},{value:"System Fields Architecture",id:"system-fields-architecture",level:2},{value:"Field Categories",id:"field-categories",level:3},{value:"1. Core Identity (3 fields)",id:"1-core-identity-3-fields",level:4},{value:"2. Context Fields (3 fields)",id:"2-context-fields-3-fields",level:4},{value:"3. Ownership (3 fields)",id:"3-ownership-3-fields",level:4},{value:"4. Object Metadata (9 fields)",id:"4-object-metadata-9-fields",level:4},{value:"5. Timestamps (4 fields)",id:"5-timestamps-4-fields",level:4},{value:"6. Relations (3 fields)",id:"6-relations-3-fields",level:4},{value:"Field Type Mapping",id:"field-type-mapping",level:3},{value:"Benefits of Pre-configured Fields",id:"benefits-of-pre-configured-fields",level:3},{value:"Setup Validation Process",id:"setup-validation-process",level:2},{value:"Automated Validation Steps",id:"automated-validation-steps",level:3},{value:"Validation Checkpoints",id:"validation-checkpoints",level:3},{value:"Example Validation Output",id:"example-validation-output",level:3},{value:"SOLR Management Dashboard",id:"solr-management-dashboard",level:2},{value:"Dashboard Features",id:"dashboard-features",level:3},{value:"Real-time Statistics",id:"real-time-statistics",level:4},{value:"Interactive Operations",id:"interactive-operations",level:4},{value:"Warmup Index",id:"warmup-index",level:5},{value:"Clear Index",id:"clear-index",level:5},{value:"User Experience Features",id:"user-experience-features",level:4},{value:"Dashboard Architecture",id:"dashboard-architecture",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Setup Issues",id:"common-setup-issues",level:3},{value:"ConfigSet Upload Fails",id:"configset-upload-fails",level:4},{value:"Collection Creation Fails",id:"collection-creation-fails",level:4},{value:"System Fields Missing",id:"system-fields-missing",level:4},{value:"Diagnostic Commands",id:"diagnostic-commands",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Setup Performance",id:"setup-performance",level:3},{value:"Runtime Performance Benefits",id:"runtime-performance-benefits",level:3},{value:"Memory Usage",id:"memory-usage",level:3},{value:"Production Deployment",id:"production-deployment",level:2},{value:"Infrastructure Requirements",id:"infrastructure-requirements",level:3},{value:"Monitoring Setup",id:"monitoring-setup",level:3},{value:"Backup Strategy",id:"backup-strategy",level:3},{value:"Migration and Upgrades",id:"migration-and-upgrades",level:2},{value:"ConfigSet Updates",id:"configset-updates",level:3},{value:"Version Management",id:"version-management",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Development",id:"development",level:3},{value:"Production",id:"production",level:3},{value:"Security",id:"security",level:3},{value:"Dense Vector Configuration",id:"dense-vector-configuration",level:2},{value:"Requirements",id:"requirements",level:3},{value:"Automatic Configuration",id:"automatic-configuration",level:3},{value:"Field Configuration",id:"field-configuration",level:3},{value:"Vector Storage",id:"vector-storage",level:3},{value:"KNN Search",id:"knn-search",level:3},{value:"Troubleshooting",id:"troubleshooting-1",level:3},{value:"File Warmup API",id:"file-warmup-api",level:2},{value:"Endpoints",id:"endpoints",level:3},{value:"1. Warmup Files",id:"1-warmup-files",level:4},{value:"2. Index Specific File",id:"2-index-specific-file",level:4},{value:"3. Reindex All Files",id:"3-reindex-all-files",level:4},{value:"4. Get File Index Statistics",id:"4-get-file-index-statistics",level:4},{value:"Usage Examples",id:"usage-examples",level:3},{value:"cURL: Warmup Files",id:"curl-warmup-files",level:4},{value:"cURL: Index Specific File",id:"curl-index-specific-file",level:4},{value:"cURL: Get Stats",id:"curl-get-stats",level:4},{value:"Error Handling",id:"error-handling",level:3},{value:"Implementation Details",id:"implementation-details",level:3},{value:"Integration with Frontend",id:"integration-with-frontend",level:3},{value:"Published-Only Indexing Strategy",id:"published-only-indexing-strategy",level:2},{value:"Implementation Details",id:"implementation-details-1",level:3},{value:"Current Behavior",id:"current-behavior",level:4},{value:"Code Locations",id:"code-locations",level:4},{value:"Database vs Solr Counts",id:"database-vs-solr-counts",level:4},{value:"Benefits",id:"benefits",level:3},{value:"Monitoring",id:"monitoring",level:3},{value:"Dashboard Statistics",id:"dashboard-statistics",level:4},{value:"Logging",id:"logging",level:4},{value:"Configuration",id:"configuration",level:3},{value:"Troubleshooting",id:"troubleshooting-2",level:3},{value:"Common Issues",id:"common-issues",level:4},{value:"Debugging",id:"debugging",level:4},{value:"Future Considerations",id:"future-considerations",level:3},{value:"TODO: Full Object Indexing",id:"todo-full-object-indexing",level:4},{value:"Collection-Specific Endpoints",id:"collection-specific-endpoints",level:2},{value:"Endpoints",id:"endpoints-1",level:3},{value:"1. Delete Specific Collection",id:"1-delete-specific-collection",level:4},{value:"2. Clear Specific Collection",id:"2-clear-specific-collection",level:4},{value:"3. Reindex Specific Collection",id:"3-reindex-specific-collection",level:4},{value:"Benefits",id:"benefits-1",level:3},{value:"RESTful Design",id:"restful-design",level:4},{value:"Improved API Clarity",id:"improved-api-clarity",level:4},{value:"Better Error Handling",id:"better-error-handling",level:4},{value:"Migration from Old Endpoints",id:"migration-from-old-endpoints",level:3},{value:"Related Documentation",id:"related-documentation",level:3}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"solr-setup-and-configuration-guide",children:"SOLR Setup and Configuration Guide"})}),"\n",(0,l.jsx)(n.p,{children:"This guide documents the complete SOLR setup process used by OpenRegister, including SolrCloud configuration requirements, authentication handling, and system field pre-configuration."}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsxs)(n.p,{children:["OpenRegister uses Apache SOLR in ",(0,l.jsx)(n.strong,{children:"SolrCloud mode"})," with a sophisticated setup process that automatically creates tenant-specific configSets and collections with pre-configured system fields. This approach ensures optimal performance, proper tenant isolation, and eliminates runtime field creation overhead."]}),"\n",(0,l.jsxs)(n.p,{children:["The system includes a comprehensive ",(0,l.jsx)(n.strong,{children:"SOLR Management Dashboard"})," that provides real-time monitoring, warmup operations, and index management capabilities with proper loading states and error handling."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mermaid",children:"graph TB\n    A[Setup Request] --\x3e B[Generate Tenant ID]\n    B --\x3e C[Create ConfigSet ZIP]\n    C --\x3e D[Upload ConfigSet]\n    D --\x3e E[Create Collection]\n    E --\x3e F[Validate Schema]\n    F --\x3e G[Ready for Indexing]\n    \n    C --\x3e C1[Base: _default configSet]\n    C --\x3e C2[Add: 25 System Fields]\n    C --\x3e C3[Package: ZIP Upload]\n    \n    D --\x3e D1[UPLOAD API]\n    D --\x3e D2[Bypass Auth Issues]\n    \n    E --\x3e E1[Tenant-Specific Name]\n    E --\x3e E2[Reference ConfigSet]\n    \n    style A fill:#e3f2fd\n    style G fill:#c8e6c9\n    style C2 fill:#fff3e0\n    style D2 fill:#f3e5f5\n"})}),"\n",(0,l.jsx)(n.h2,{id:"solr-configuration-requirements",children:"SOLR Configuration Requirements"}),"\n",(0,l.jsx)(n.h3,{id:"solrcloud-mode",children:"SolrCloud Mode"}),"\n",(0,l.jsxs)(n.p,{children:["OpenRegister requires SOLR to run in ",(0,l.jsx)(n.strong,{children:"SolrCloud mode"})," with ZooKeeper coordination:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# docker-compose.yml\nservices:\n  solr:\n    image: solr:9-slim\n    container_name: master-solr-1\n    restart: always\n    ports:\n      - '8983:8983'\n    volumes:\n      - solr:/var/solr\n    environment:\n      - SOLR_HEAP=512m\n      # SolrCloud mode with embedded ZooKeeper\n      - ZK_HOST=localhost:9983\n    command:\n      # Start in cloud mode (no precreate needed)\n      - solr\n      - -c\n      - -f\n    healthcheck:\n      test: ['CMD-SHELL', 'curl -f http://localhost:8983/solr/admin/ping || exit 1']\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      \n  # Optional: External ZooKeeper for production\n  zookeeper:\n    image: zookeeper:3.8\n    container_name: master-zookeeper-1  \n    restart: always\n    ports:\n      - '2181:2181'\n      - '9983:9983'\n    environment:\n      - ZOO_MY_ID=1\n      - ZOO_SERVERS=server.1=0.0.0.0:2888:3888;2181\n"})}),"\n",(0,l.jsx)(n.h3,{id:"key-solrcloud-requirements",children:"Key SolrCloud Requirements"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cloud Mode"}),": SOLR must start with '-c' flag"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ZooKeeper"}),": Required for configSet and collection management"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"No Authentication"}),": Default setup without security (development)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ConfigSet API"}),": Must support UPLOAD action for ZIP-based configSets"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Collection API"}),": Must support CREATE with configName reference"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"authentication-and-security",children:"Authentication and Security"}),"\n",(0,l.jsx)(n.h3,{id:"development-configuration",children:"Development Configuration"}),"\n",(0,l.jsx)(n.p,{children:"For development environments, SOLR runs without authentication:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# No authentication required\nenvironment:\n  - SOLR_AUTH_TYPE=none\n"})}),"\n",(0,l.jsx)(n.h3,{id:"production-considerations",children:"Production Considerations"}),"\n",(0,l.jsx)(n.p,{children:"For production deployments, consider:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# Basic authentication (if needed)\nenvironment:\n  - SOLR_AUTH_TYPE=basic\n  - SOLR_AUTHENTICATION_OPTS='-Dbasicauth=admin:password'\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Important"}),": OpenRegister's setup process uses ",(0,l.jsx)(n.strong,{children:"ZIP upload"})," to bypass authentication issues with trusted configSet creation in SolrCloud mode."]}),"\n",(0,l.jsx)(n.h2,{id:"setup-process-architecture",children:"Setup Process Architecture"}),"\n",(0,l.jsx)(n.h3,{id:"1-tenant-id-generation",children:"1. Tenant ID Generation"}),"\n",(0,l.jsx)(n.p,{children:"Each Nextcloud instance gets a unique tenant ID:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"/**\n * Generate tenant-specific identifier\n * Format: nc_{8-character-hash}\n * Example: nc_f0e53393\n */\nprivate function getTenantId(): string\n{\n    $instanceId = $this->systemConfig->getValue('instanceid');\n    return 'nc_' . substr(hash('sha256', $instanceId), 0, 8);\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-configset-creation-strategy",children:"2. ConfigSet Creation Strategy"}),"\n",(0,l.jsx)(n.h4,{id:"base-configset-download",children:"Base ConfigSet Download"}),"\n",(0,l.jsx)(n.p,{children:"OpenRegister downloads the working '_default' configSet as a foundation:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Inside SOLR container\n/opt/solr/bin/solr zk downconfig -n _default -d /tmp/default_config -z localhost:9983\n"})}),"\n",(0,l.jsx)(n.h4,{id:"system-fields-integration",children:"System Fields Integration"}),"\n",(0,l.jsx)(n.p,{children:"The base schema is enhanced with 25 pre-configured system fields:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'\x3c!-- OpenRegister System Fields (self_*) - Always present for all tenants --\x3e\n\x3c!-- Core tenant field --\x3e\n<field name="self_tenant" type="string" indexed="true" stored="true" required="true" multiValued="false" />\n\n\x3c!-- Metadata fields --\x3e\n<field name="self_object_id" type="pint" indexed="true" stored="true" multiValued="false" />\n<field name="self_uuid" type="string" indexed="true" stored="true" multiValued="false" />\n\n\x3c!-- Context fields --\x3e\n<field name="self_register" type="pint" indexed="true" stored="true" multiValued="false" />\n<field name="self_schema" type="pint" indexed="true" stored="true" multiValued="false" />\n<field name="self_schema_version" type="string" indexed="true" stored="true" multiValued="false" />\n\n\x3c!-- Ownership and metadata --\x3e\n<field name="self_owner" type="string" indexed="true" stored="true" multiValued="false" />\n<field name="self_organisation" type="string" indexed="true" stored="true" multiValued="false" />\n<field name="self_application" type="string" indexed="true" stored="true" multiValued="false" />\n\n\x3c!-- Core object fields --\x3e\n<field name="self_name" type="string" indexed="true" stored="true" multiValued="false" />\n<field name="self_description" type="text_general" indexed="true" stored="true" multiValued="false" />\n<field name="self_summary" type="text_general" indexed="true" stored="true" multiValued="false" />\n<field name="self_image" type="string" indexed="false" stored="true" multiValued="false" />\n<field name="self_slug" type="string" indexed="true" stored="true" multiValued="false" />\n<field name="self_uri" type="string" indexed="true" stored="true" multiValued="false" />\n<field name="self_version" type="string" indexed="true" stored="true" multiValued="false" />\n<field name="self_size" type="string" indexed="false" stored="true" multiValued="false" />\n<field name="self_folder" type="string" indexed="true" stored="true" multiValued="false" />\n\n\x3c!-- Timestamps --\x3e\n<field name="self_created" type="pdate" indexed="true" stored="true" multiValued="false" />\n<field name="self_updated" type="pdate" indexed="true" stored="true" multiValued="false" />\n<field name="self_published" type="pdate" indexed="true" stored="true" multiValued="false" />\n<field name="self_depublished" type="pdate" indexed="true" stored="true" multiValued="false" />\n\n\x3c!-- Relation fields --\x3e\n<field name="self_relations" type="string" indexed="true" stored="true" multiValued="true" />\n<field name="self_files" type="string" indexed="true" stored="true" multiValued="true" />\n<field name="self_parent_uuid" type="string" indexed="true" stored="true" multiValued="false" />\n'})}),"\n",(0,l.jsx)(n.h4,{id:"zip-package-creation",children:"ZIP Package Creation"}),"\n",(0,l.jsx)(n.p,{children:"The enhanced configSet is packaged into a ZIP file:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"/**\n * Create configSet ZIP package\n * Location: resources/solr/openregister-configset.zip\n */\nprivate function createConfigSetZip(): void\n{\n    $zipFile = $this->appPath . '/resources/solr/openregister-configset.zip';\n    $configPath = $this->appPath . '/resources/solr/default_configset';\n    \n    $zip = new ZipArchive();\n    $zip->open($zipFile, ZipArchive::CREATE | ZipArchive::OVERWRITE);\n    \n    // Add all configSet files\n    $files = new RecursiveIteratorIterator(\n        new RecursiveDirectoryIterator($configPath),\n        RecursiveIteratorIterator::LEAVES_ONLY\n    );\n    \n    foreach ($files as $file) {\n        if (!$file->isDir()) {\n            $filePath = $file->getRealPath();\n            $relativePath = substr($filePath, strlen($configPath) + 1);\n            $zip->addFile($filePath, $relativePath);\n        }\n    }\n    \n    $zip->close();\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-configset-upload-process",children:"3. ConfigSet Upload Process"}),"\n",(0,l.jsx)(n.h4,{id:"upload-api-usage",children:"Upload API Usage"}),"\n",(0,l.jsx)(n.p,{children:"OpenRegister uses SOLR's UPLOAD API to create configSets:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"/**\n * Upload configSet via ZIP to bypass authentication\n */\nprivate function uploadConfigSet(string $configSetName): bool\n{\n    $zipPath = $this->appPath . '/resources/solr/openregister-configset.zip';\n    $zipContent = file_get_contents($zipPath);\n    \n    $url = $this->buildSolrUrl() . '/admin/configs';\n    $params = [\n        'action' => 'UPLOAD',\n        'name' => $configSetName,\n        'wt' => 'json'\n    ];\n    \n    try {\n        $response = $this->httpClient->post($url . '?' . http_build_query($params), [\n            'body' => $zipContent,\n            'headers' => [\n                'Content-Type' => 'application/octet-stream'\n            ]\n        ]);\n        \n        return $response->getStatusCode() === 200;\n    } catch (RequestException $e) {\n        $this->logger->error('ConfigSet upload failed', [\n            'error' => $e->getMessage(),\n            'configSet' => $configSetName\n        ]);\n        return false;\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h4,{id:"why-zip-upload-vs-create",children:"Why ZIP Upload vs CREATE"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Method"}),(0,l.jsx)(n.th,{children:"Authentication"}),(0,l.jsx)(n.th,{children:"Trusted ConfigSets"}),(0,l.jsx)(n.th,{children:"Status"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"CREATE"}),(0,l.jsx)(n.td,{children:"Required"}),(0,l.jsx)(n.td,{children:"\u274c Fails with 401"}),(0,l.jsx)(n.td,{children:"Not usable"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"UPLOAD"}),(0,l.jsx)(n.td,{children:"Not required"}),(0,l.jsx)(n.td,{children:"\u2705 Works"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Used"})})]})]})]}),"\n",(0,l.jsx)(n.p,{children:"The UPLOAD method bypasses SolrCloud's authentication requirement for creating configSets from trusted templates."}),"\n",(0,l.jsx)(n.h3,{id:"4-collection-creation",children:"4. Collection Creation"}),"\n",(0,l.jsx)(n.h4,{id:"tenant-specific-naming",children:"Tenant-Specific Naming"}),"\n",(0,l.jsx)(n.p,{children:"Collections use tenant-specific naming for isolation:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"/**\n * Generate tenant-specific collection name\n * Format: openregister_{tenantId}\n * Example: openregister_nc_f0e53393\n */\npublic function getTenantSpecificCollectionName(): string\n{\n    return 'openregister_' . $this->getTenantId();\n}\n"})}),"\n",(0,l.jsx)(n.h4,{id:"collection-api-call",children:"Collection API Call"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"/**\n * Create collection with tenant-specific configSet\n */\nprivate function createCollection(string $collectionName, string $configSetName): bool\n{\n    $url = $this->buildSolrUrl() . '/admin/collections';\n    $params = [\n        'action' => 'CREATE',\n        'name' => $collectionName,\n        'collection.configName' => $configSetName,\n        'numShards' => 1,\n        'replicationFactor' => 1,\n        'wt' => 'json'\n    ];\n    \n    try {\n        $response = $this->httpClient->get($url . '?' . http_build_query($params));\n        $data = json_decode($response->getBody()->getContents(), true);\n        \n        return isset($data['responseHeader']['status']) && \n               $data['responseHeader']['status'] === 0;\n    } catch (RequestException $e) {\n        $this->logger->error('Collection creation failed', [\n            'error' => $e->getMessage(),\n            'collection' => $collectionName,\n            'configSet' => $configSetName\n        ]);\n        return false;\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"system-fields-architecture",children:"System Fields Architecture"}),"\n",(0,l.jsx)(n.h3,{id:"field-categories",children:"Field Categories"}),"\n",(0,l.jsx)(n.p,{children:"OpenRegister pre-configures 25 system fields in 5 categories:"}),"\n",(0,l.jsx)(n.h4,{id:"1-core-identity-3-fields",children:"1. Core Identity (3 fields)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"'self_tenant': Tenant isolation (required)"}),"\n",(0,l.jsx)(n.li,{children:"'self_object_id': Database object ID"}),"\n",(0,l.jsx)(n.li,{children:"'self_uuid': Unique identifier"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"2-context-fields-3-fields",children:"2. Context Fields (3 fields)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"'self_register': Register association"}),"\n",(0,l.jsx)(n.li,{children:"'self_schema': Schema reference"}),"\n",(0,l.jsx)(n.li,{children:"'self_schema_version': Schema version tracking"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"3-ownership-3-fields",children:"3. Ownership (3 fields)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"'self_owner': Object owner"}),"\n",(0,l.jsx)(n.li,{children:"'self_organisation': Organization association"}),"\n",(0,l.jsx)(n.li,{children:"'self_application': Source application"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"4-object-metadata-9-fields",children:"4. Object Metadata (9 fields)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"'self_name': Object name"}),"\n",(0,l.jsx)(n.li,{children:"'self_description': Full description"}),"\n",(0,l.jsx)(n.li,{children:"'self_summary': Short summary"}),"\n",(0,l.jsx)(n.li,{children:"'self_image': Image reference"}),"\n",(0,l.jsx)(n.li,{children:"'self_slug': URL-friendly identifier"}),"\n",(0,l.jsx)(n.li,{children:"'self_uri': Resource URI"}),"\n",(0,l.jsx)(n.li,{children:"'self_version': Object version"}),"\n",(0,l.jsx)(n.li,{children:"'self_size': Size information"}),"\n",(0,l.jsx)(n.li,{children:"'self_folder': Folder location"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"5-timestamps-4-fields",children:"5. Timestamps (4 fields)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"'self_created': Creation timestamp"}),"\n",(0,l.jsx)(n.li,{children:"'self_updated': Last modification"}),"\n",(0,l.jsx)(n.li,{children:"'self_published': Publication date"}),"\n",(0,l.jsx)(n.li,{children:"'self_depublished': Unpublication date"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"6-relations-3-fields",children:"6. Relations (3 fields)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"'self_relations': Related objects (multi-valued)"}),"\n",(0,l.jsx)(n.li,{children:"'self_files': Attached files (multi-valued)"}),"\n",(0,l.jsx)(n.li,{children:"'self_parent_uuid': Parent relationship"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"field-type-mapping",children:"Field Type Mapping"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mermaid",children:"graph LR\n    A[OpenRegister Types] --\x3e B[SOLR Field Types]\n    \n    A --\x3e A1[String Fields]\n    A --\x3e A2[Text Fields]  \n    A --\x3e A3[Integer Fields]\n    A --\x3e A4[Date Fields]\n    A --\x3e A5[Multi-valued]\n    \n    A1 --\x3e B1[type: string]\n    A2 --\x3e B2[type: text_general]\n    A3 --\x3e B3[type: pint]\n    A4 --\x3e B4[type: pdate]\n    A5 --\x3e B5[multiValued: true]\n    \n    B1 --\x3e C1[Exact matching<br/>Faceting<br/>Sorting]\n    B2 --\x3e C2[Full-text search<br/>Analysis<br/>Tokenization]\n    B3 --\x3e C3[Numeric queries<br/>Range filtering<br/>Math operations]\n    B4 --\x3e C4[Date queries<br/>Range filtering<br/>Sorting]\n    B5 --\x3e C5[Multiple values<br/>Array storage]\n    \n    style A fill:#e3f2fd\n    style B fill:#fff3e0\n    style C1 fill:#c8e6c9\n    style C2 fill:#c8e6c9\n    style C3 fill:#c8e6c9\n    style C4 fill:#c8e6c9\n    style C5 fill:#c8e6c9\n"})}),"\n",(0,l.jsx)(n.h3,{id:"benefits-of-pre-configured-fields",children:"Benefits of Pre-configured Fields"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Performance"}),": No runtime field creation overhead"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Consistency"}),": All tenants have identical system field structure"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Reliability"}),": Eliminates schema validation errors during indexing"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Maintenance"}),": Centralized field definition management"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Development"}),": Predictable field availability for queries"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"setup-validation-process",children:"Setup Validation Process"}),"\n",(0,l.jsx)(n.h3,{id:"automated-validation-steps",children:"Automated Validation Steps"}),"\n",(0,l.jsx)(n.p,{children:"The setup process includes comprehensive validation:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mermaid",children:"sequenceDiagram\n    participant Setup as Setup Process\n    participant SOLR as SOLR Server\n    participant Validation as Validation\n    \n    Setup->>SOLR: 1. Upload ConfigSet ZIP\n    SOLR--\x3e>Setup: ConfigSet Created\n    \n    Setup->>SOLR: 2. Create Collection\n    SOLR--\x3e>Setup: Collection Created\n    \n    Setup->>Validation: 3. Validate Schema\n    Validation->>SOLR: Check Field Definitions\n    SOLR--\x3e>Validation: 30 Fields Found\n    \n    Validation->>SOLR: 4. Test Document Indexing\n    SOLR--\x3e>Validation: Document Indexed\n    \n    Validation->>SOLR: 5. Test Search Query\n    SOLR--\x3e>Validation: Search Results\n    \n    Validation--\x3e>Setup: \u2705 Setup Validated\n"})}),"\n",(0,l.jsx)(n.h3,{id:"validation-checkpoints",children:"Validation Checkpoints"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ConfigSet Validation"}),": Verify configSet exists and contains system fields"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Collection Validation"}),": Confirm collection creation and accessibility"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Schema Validation"}),": Check all 25 system fields are present"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Index Validation"}),": Test document indexing with system fields"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Search Validation"}),": Verify query functionality and field access"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"example-validation-output",children:"Example Validation Output"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "setup_status": "success",\n  "validation": {\n    "configSet": {\n      "name": "openregister_nc_f0e53393",\n      "exists": true,\n      "system_fields": 25\n    },\n    "collection": {\n      "name": "openregister_nc_f0e53393", \n      "exists": true,\n      "documents": 0\n    },\n    "schema": {\n      "total_fields": 30,\n      "system_fields": 25,\n      "basic_fields": 5\n    },\n    "test_document": {\n      "indexed": true,\n      "searchable": true,\n      "fields_populated": [\n        "self_tenant",\n        "self_uuid", \n        "self_name",\n        "self_description",\n        "self_created"\n      ]\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"solr-management-dashboard",children:"SOLR Management Dashboard"}),"\n",(0,l.jsx)(n.p,{children:"OpenRegister includes a comprehensive SOLR Management Dashboard accessible through the Settings page that provides:"}),"\n",(0,l.jsx)(n.h3,{id:"dashboard-features",children:"Dashboard Features"}),"\n",(0,l.jsx)(n.h4,{id:"real-time-statistics",children:"Real-time Statistics"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Connection Status"}),": Live SOLR connectivity monitoring"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Document Count"}),": Total indexed documents (e.g., 13,489 objects)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Collection Information"}),": Active tenant-specific collection names"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Tenant ID"}),": Current tenant identification"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"interactive-operations",children:"Interactive Operations"}),"\n",(0,l.jsx)(n.h5,{id:"warmup-index",children:"Warmup Index"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Object Count Prediction"}),": Displays total objects to be processed"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Batch Calculation"}),": Shows estimated batches (e.g., 14 batches for 13,489 objects)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Duration Estimation"}),": Provides time estimates (e.g., ~21 seconds for parallel mode)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Execution Modes"}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Serial Mode (safer, slower)"}),"\n",(0,l.jsx)(n.li,{children:"Parallel Mode (faster, more resource intensive)"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Progress Tracking"}),": Real-time warmup progress with loading states"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Results Display"}),": Comprehensive results with execution time and statistics"]}),"\n"]}),"\n",(0,l.jsx)(n.h5,{id:"clear-index",children:"Clear Index"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Confirmation Dialog"}),": Safety confirmation before clearing"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"API Integration"}),": Direct integration with '/api/settings/solr/clear' endpoint"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Error Handling"}),": Proper error feedback and recovery options"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"user-experience-features",children:"User Experience Features"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Loading States"}),": Spinners and disabled controls during operations"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Error Feedback"}),": Clear error messages with troubleshooting information"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"State Management"}),": Proper modal state handling and cleanup"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Debug Logging"}),": Comprehensive logging for troubleshooting"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"dashboard-architecture",children:"Dashboard Architecture"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mermaid",children:"graph TB\n    A[SOLR Dashboard] --\x3e B[Statistics Loading]\n    A --\x3e C[Modal Management]\n    A --\x3e D[API Integration]\n    \n    B --\x3e B1[/api/solr/dashboard/stats]\n    B --\x3e B2[/api/settings/stats]\n    B --\x3e B3[Data Transformation]\n    \n    C --\x3e C1[Warmup Modal]\n    C --\x3e C2[Clear Index Modal]\n    C --\x3e C3[State Management]\n    \n    D --\x3e D1[GuzzleSolrService]\n    D --\x3e D2[SettingsController]\n    D --\x3e D3[Error Handling]\n    \n    C1 --\x3e C1A[Object Count Prediction]\n    C1 --\x3e C1B[Warmup Configuration]\n    C1 --\x3e C1C[Progress Tracking]\n    \n    C2 --\x3e C2A[Confirmation Dialog]\n    C2 --\x3e C2B[Clear Operation]\n    C2 --\x3e C2C[Result Feedback]\n    \n    style A fill:#e3f2fd\n    style C1A fill:#fff3e0\n    style D1 fill:#c8e6c9\n"})}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"common-setup-issues",children:"Common Setup Issues"}),"\n",(0,l.jsx)(n.h4,{id:"configset-upload-fails",children:"ConfigSet Upload Fails"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Symptoms"}),": HTTP 401 errors during configSet creation"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Causes"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Attempting to use CREATE with trusted configSet"}),"\n",(0,l.jsx)(n.li,{children:"Authentication issues in SolrCloud"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Use UPLOAD method with ZIP file"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Test configSet upload manually\ncurl -X POST -H "Content-Type:application/octet-stream" \\\n  --data-binary @openregister-configset.zip \\\n  "http://localhost:8983/solr/admin/configs?action=UPLOAD&name=test_config"\n'})}),"\n",(0,l.jsx)(n.h4,{id:"collection-creation-fails",children:"Collection Creation Fails"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Symptoms"}),': "Underlying core creation failed" errors']}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Causes"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Invalid schema in configSet"}),"\n",(0,l.jsx)(n.li,{children:"Missing field type definitions"}),"\n",(0,l.jsx)(n.li,{children:"ZooKeeper connectivity issues"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Validate configSet schema and ZooKeeper connection"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Check ZooKeeper connectivity\ndocker exec master-solr-1 /opt/solr/bin/solr healthcheck -c openregister_nc_f0e53393\n\n# Validate schema\ncurl "http://localhost:8983/solr/openregister_nc_f0e53393/schema/fields?wt=json"\n'})}),"\n",(0,l.jsx)(n.h4,{id:"system-fields-missing",children:"System Fields Missing"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Symptoms"}),": Fields not found in schema or search results"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Causes"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"ConfigSet ZIP doesn't contain updated schema"}),"\n",(0,l.jsx)(n.li,{children:"Collection created with wrong configSet"}),"\n",(0,l.jsx)(n.li,{children:"Schema not properly uploaded"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Recreate configSet with system fields"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Verify system fields in collection\ncurl "http://localhost:8983/solr/openregister_nc_f0e53393/schema/fields?wt=json" | \\\n  grep -c "self_"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"diagnostic-commands",children:"Diagnostic Commands"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Check SOLR health\ndocker exec master-solr-1 curl "http://localhost:8983/solr/admin/ping"\n\n# List configSets\ndocker exec master-solr-1 curl "http://localhost:8983/solr/admin/configs?action=LIST&wt=json"\n\n# List collections  \ndocker exec master-solr-1 curl "http://localhost:8983/solr/admin/collections?action=LIST&wt=json"\n\n# Check collection schema\ndocker exec master-solr-1 curl "http://localhost:8983/solr/{collection}/schema/fields?wt=json"\n\n# Test document indexing\ndocker exec master-solr-1 curl -X POST -H \'Content-Type: application/json\' \\\n  "http://localhost:8983/solr/{collection}/update/json/docs" \\\n  -d \'{"id": "test", "self_tenant": "nc_test", "self_name": "Test Document"}\'\n\n# Commit changes\ndocker exec master-solr-1 curl -X POST \\\n  "http://localhost:8983/solr/{collection}/update?commit=true"\n\n# Search test\ndocker exec master-solr-1 curl \\\n  "http://localhost:8983/solr/{collection}/select?q=*:*&wt=json"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,l.jsx)(n.h3,{id:"setup-performance",children:"Setup Performance"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ConfigSet Upload"}),": ~500ms (one-time per tenant)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Collection Creation"}),": ~800ms (one-time per tenant)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Schema Validation"}),": ~100ms (per setup)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Total Setup Time"}),": ~1.5 seconds"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"runtime-performance-benefits",children:"Runtime Performance Benefits"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"No Dynamic Fields"}),": Eliminates field creation overhead during indexing"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Pre-optimized Schema"}),": Faster query planning and execution"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Consistent Structure"}),": Predictable performance characteristics"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Tenant Isolation"}),": No cross-tenant query overhead"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"memory-usage",children:"Memory Usage"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ConfigSet Storage"}),": ~200KB per tenant configSet"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"System Fields"}),": Minimal indexing overhead"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Schema Cache"}),": Shared across all documents in collection"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"production-deployment",children:"Production Deployment"}),"\n",(0,l.jsx)(n.h3,{id:"infrastructure-requirements",children:"Infrastructure Requirements"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# Production SOLR configuration\nservices:\n  zookeeper:\n    image: zookeeper:3.8\n    deploy:\n      replicas: 3\n    environment:\n      - ZOO_MY_ID=1\n      - ZOO_SERVERS=server.1=zoo1:2888:3888;2181 server.2=zoo2:2888:3888;2181 server.3=zoo3:2888:3888;2181\n      \n  solr:\n    image: solr:9-slim\n    deploy:\n      replicas: 2\n    environment:\n      - SOLR_HEAP=2g\n      - ZK_HOST=zoo1:2181,zoo2:2181,zoo3:2181\n      - SOLR_LOG_LEVEL=WARN\n    command:\n      - solr\n      - -c\n      - -f\n"})}),"\n",(0,l.jsx)(n.h3,{id:"monitoring-setup",children:"Monitoring Setup"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# Add monitoring for SOLR\n  solr-exporter:\n    image: solr:9-slim\n    command:\n      - /opt/solr/contrib/prometheus-exporter/bin/solr-exporter\n      - -p 9854\n      - -z zoo1:2181,zoo2:2181,zoo3:2181\n      - -f /opt/solr/contrib/prometheus-exporter/conf/solr-exporter-config.xml\n"})}),"\n",(0,l.jsx)(n.h3,{id:"backup-strategy",children:"Backup Strategy"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Backup configSets\ndocker exec solr1 /opt/solr/bin/solr zk cp zk:/configs /backup/configs -r -z zoo1:2181\n\n# Backup collections\ndocker exec solr1 /opt/solr/bin/solr create_backup -c openregister_nc_f0e53393 -b backup-$(date +%Y%m%d)\n"})}),"\n",(0,l.jsx)(n.h2,{id:"migration-and-upgrades",children:"Migration and Upgrades"}),"\n",(0,l.jsx)(n.h3,{id:"configset-updates",children:"ConfigSet Updates"}),"\n",(0,l.jsx)(n.p,{children:"When system fields need updates:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Update local configSet files"}),"\n",(0,l.jsx)(n.li,{children:"Recreate ZIP package"}),"\n",(0,l.jsx)(n.li,{children:"Upload new configSet version"}),"\n",(0,l.jsx)(n.li,{children:"Reload collection configuration"}),"\n",(0,l.jsx)(n.li,{children:"Validate field changes"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"version-management",children:"Version Management"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Tag configSet versions\ndocker exec master-solr-1 curl -X POST \\\n  "http://localhost:8983/solr/admin/configs?action=UPLOAD&name=openregister_v2&wt=json" \\\n  --data-binary @openregister-configset-v2.zip\n\n# Update collection to use new configSet\ndocker exec master-solr-1 curl \\\n  "http://localhost:8983/solr/admin/collections?action=MODIFYCOLLECTION&collection=openregister_nc_f0e53393&collection.configName=openregister_v2"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsx)(n.h3,{id:"development",children:"Development"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Always test setup process with clean SOLR instance"}),"\n",(0,l.jsx)(n.li,{children:"Validate system fields after each schema change"}),"\n",(0,l.jsx)(n.li,{children:"Use version control for configSet files"}),"\n",(0,l.jsx)(n.li,{children:"Document field purpose and usage patterns"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"production",children:"Production"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Monitor setup success rates and performance"}),"\n",(0,l.jsx)(n.li,{children:"Implement automated configSet backups"}),"\n",(0,l.jsx)(n.li,{children:"Test disaster recovery procedures"}),"\n",(0,l.jsx)(n.li,{children:"Monitor system field usage and performance"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"security",children:"Security"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Restrict SOLR admin interface access"}),"\n",(0,l.jsx)(n.li,{children:"Use authentication in production environments"}),"\n",(0,l.jsx)(n.li,{children:"Implement network-level access controls"}),"\n",(0,l.jsx)(n.li,{children:"Regular security updates for SOLR and ZooKeeper"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"dense-vector-configuration",children:"Dense Vector Configuration"}),"\n",(0,l.jsx)(n.p,{children:"OpenRegister supports Solr 9+ dense vector search for semantic similarity operations. The system automatically configures vector fields when setting up collections."}),"\n",(0,l.jsx)(n.h3,{id:"requirements",children:"Requirements"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solr Version"}),": 9.0+ (dense vector support introduced in Solr 9.0)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Field Type"}),": ",(0,l.jsx)(n.code,{children:"knn_vector"})," (DenseVectorField)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Field Name"}),": ",(0,l.jsx)(n.code,{children:"_embedding_"})," (reserved system field, hardcoded)"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"automatic-configuration",children:"Automatic Configuration"}),"\n",(0,l.jsx)(n.p,{children:"When running Solr setup, the system automatically:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Creates ",(0,l.jsx)(n.code,{children:"knn_vector"})," field type with appropriate dimensions"]}),"\n",(0,l.jsxs)(n.li,{children:["Configures ",(0,l.jsx)(n.code,{children:"_embedding_"})," field in both file and object collections"]}),"\n",(0,l.jsx)(n.li,{children:"Sets up supporting fields for vector metadata"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"field-configuration",children:"Field Configuration"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Vector Field Type"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<fieldType name="knn_vector" class="solr.DenseVectorField" \n           vectorDimension="4096" \n           similarityFunction="cosine" \n           knnAlgorithm="hnsw"/>\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Vector Field"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<field name="_embedding_" type="knn_vector" indexed="true" stored="true" multiValued="false"/>\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Important Notes"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"_embedding_"})," is a reserved system field and cannot be changed"]}),"\n",(0,l.jsxs)(n.li,{children:["Field type must be ",(0,l.jsx)(n.code,{children:"knn_vector"}),", not ",(0,l.jsx)(n.code,{children:"pfloat"})," or other types"]}),"\n",(0,l.jsx)(n.li,{children:"Vector dimensions should match your embedding model (default: 4096 for Ollama)"}),"\n",(0,l.jsx)(n.li,{children:"The field is single-valued (not multiValued) - one vector per document"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"vector-storage",children:"Vector Storage"}),"\n",(0,l.jsx)(n.p,{children:"Vectors are stored directly in existing collections:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Files"}),": Stored in ",(0,l.jsx)(n.code,{children:"fileCollection"})," alongside file chunks"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Objects"}),": Stored in ",(0,l.jsx)(n.code,{children:"objectCollection"})," alongside object data"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"This enables:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Single source of truth for each entity"}),"\n",(0,l.jsx)(n.li,{children:"Full document retrieval without additional lookups"}),"\n",(0,l.jsx)(n.li,{children:"Atomic updates to existing documents"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"knn-search",children:"KNN Search"}),"\n",(0,l.jsx)(n.p,{children:"Once configured, semantic search uses Solr's KNN query parser:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"{!knn f=_embedding_ topK=10}[query_vector_array]\n"})}),"\n",(0,l.jsx)(n.p,{children:"This returns the 10 most similar documents based on cosine similarity."}),"\n",(0,l.jsx)(n.h3,{id:"troubleshooting-1",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsxs)(n.strong,{children:['Error: "multiple values encountered for non multiValued field ',(0,l.jsx)(n.em,{children:"embedding"}),'"']})}),"\n",(0,l.jsxs)(n.p,{children:["This indicates the field was incorrectly configured as ",(0,l.jsx)(n.code,{children:"pfloat"})," instead of ",(0,l.jsx)(n.code,{children:"knn_vector"}),". Solution:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Run Solr setup to fix schema\ndocker exec -u 33 master-nextcloud-1 php occ openregister:solr:manage setup\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Error: Field type not found"})}),"\n",(0,l.jsx)(n.p,{children:"Ensure Solr version is 9.0+ and run setup to create the field type automatically."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Performance Issues"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Verify HNSW indexing is enabled"}),"\n",(0,l.jsx)(n.li,{children:"Check vector dimensions match your embedding model"}),"\n",(0,l.jsx)(n.li,{children:"Monitor Solr performance metrics"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"file-warmup-api",children:"File Warmup API"}),"\n",(0,l.jsx)(n.p,{children:"The File Warmup API provides endpoints for bulk file processing, text extraction, chunking, and SOLR indexing. These endpoints enable efficient batch operations for indexing large numbers of files."}),"\n",(0,l.jsx)(n.h3,{id:"endpoints",children:"Endpoints"}),"\n",(0,l.jsx)(n.h4,{id:"1-warmup-files",children:"1. Warmup Files"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"POST"})," ",(0,l.jsx)(n.code,{children:"/api/solr/warmup/files"})]}),"\n",(0,l.jsx)(n.p,{children:"Bulk process and index files in SOLR file collection."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "max_files": 1000,\n  "batch_size": 100,\n  "file_types": ["application/pdf", "text/plain"],\n  "skip_indexed": true,\n  "mode": "parallel"\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"max_files"})," (optional): Maximum number of files to process (default: 1000)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"batch_size"})," (optional): Number of files to process per batch (default: 100)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"file_types"})," (optional): Array of MIME types to filter (e.g., ",(0,l.jsx)(n.code,{children:'["application/pdf"]'}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"skip_indexed"})," (optional): Skip files already indexed in Solr (default: true)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"mode"}),' (optional): Processing mode - "parallel" or "sequential" (default: "parallel")']}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "File warmup completed",\n  "files_processed": 847,\n  "indexed": 844,\n  "failed": 3,\n  "errors": ["File 123: No extracted text available"],\n  "mode": "parallel"\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"2-index-specific-file",children:"2. Index Specific File"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"POST"})," ",(0,l.jsx)(n.code,{children:"/api/solr/files/{fileId}/index"})]}),"\n",(0,l.jsx)(n.p,{children:"Index a single file in SOLR."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "File indexed successfully",\n  "file_id": 5213\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"3-reindex-all-files",children:"3. Reindex All Files"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"POST"})," ",(0,l.jsx)(n.code,{children:"/api/solr/files/reindex"})]}),"\n",(0,l.jsx)(n.p,{children:"Reindex all files that have completed text extraction."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "max_files": 1000,\n  "batch_size": 100\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "Reindex completed",\n  "files_processed": 500,\n  "indexed": 497,\n  "failed": 3,\n  "errors": []\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"4-get-file-index-statistics",children:"4. Get File Index Statistics"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"GET"})," ",(0,l.jsx)(n.code,{children:"/api/solr/files/stats"})]}),"\n",(0,l.jsx)(n.p,{children:"Get statistics about indexed files."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "total_chunks": 4235,\n  "unique_files": 847,\n  "mime_types": {\n    "application/pdf": 500,\n    "text/plain": 200,\n    "application/vnd.openxmlformats-officedocument.wordprocessingml.document": 147\n  },\n  "collection": "openregister_files"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,l.jsx)(n.h4,{id:"curl-warmup-files",children:"cURL: Warmup Files"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl -X POST -u \'admin:admin\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n    "max_files": 500,\n    "batch_size": 50,\n    "file_types": ["application/pdf"],\n    "skip_indexed": true\n  }\' \\\n  http://master-nextcloud-1/index.php/apps/openregister/api/solr/warmup/files\n'})}),"\n",(0,l.jsx)(n.h4,{id:"curl-index-specific-file",children:"cURL: Index Specific File"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl -X POST -u 'admin:admin' \\\n  http://master-nextcloud-1/index.php/apps/openregister/api/solr/files/5213/index\n"})}),"\n",(0,l.jsx)(n.h4,{id:"curl-get-stats",children:"cURL: Get Stats"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl -u 'admin:admin' \\\n  http://master-nextcloud-1/index.php/apps/openregister/api/solr/files/stats\n"})}),"\n",(0,l.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(n.p,{children:"All endpoints return proper HTTP status codes:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"200"}),": Success"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"422"}),": Unprocessable (e.g., file has no extracted text)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"500"}),": Internal server error"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Error responses include:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": false,\n  "message": "Error description here"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,l.jsxs)(n.p,{children:["The warmup endpoints are implemented in ",(0,l.jsx)(n.code,{children:"SettingsController.php"}),":"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"warmupFiles()"})}),": Gets files that need indexing, filters by MIME type if specified, processes in batches, returns comprehensive results"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"indexFile(int $fileId)"})}),": Indexes a single file, returns success/failure"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"reindexFiles()"})}),": Gets all completed file texts, reindexes in batches, returns statistics"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"getFileIndexStats()"})}),": Queries SOLR for statistics, returns chunk counts and file counts"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"integration-with-frontend",children:"Integration with Frontend"}),"\n",(0,l.jsx)(n.p,{children:"These endpoints are used by:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SOLR Configuration Modal"})," - File warmup UI"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"File Management Dialog"})," - Individual file indexing"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Dashboard"})," - Statistics display"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"published-only-indexing-strategy",children:"Published-Only Indexing Strategy"}),"\n",(0,l.jsxs)(n.p,{children:["OpenRegister implements a ",(0,l.jsx)(n.strong,{children:"published-only indexing strategy"})," for Apache Solr search functionality. This means that only objects with a ",(0,l.jsx)(n.code,{children:"published"})," date are indexed to Solr, ensuring that search results only contain publicly available content."]}),"\n",(0,l.jsx)(n.h3,{id:"implementation-details-1",children:"Implementation Details"}),"\n",(0,l.jsx)(n.h4,{id:"current-behavior",children:"Current Behavior"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Single Object Indexing"}),": The ",(0,l.jsx)(n.code,{children:"indexObject()"})," method checks if an object has a ",(0,l.jsx)(n.code,{children:"published"})," date before indexing"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Bulk Indexing"}),": Both ",(0,l.jsx)(n.code,{children:"bulkIndexFromDatabase()"})," and ",(0,l.jsx)(n.code,{children:"bulkIndexFromDatabaseOptimized()"})," methods filter out unpublished objects"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Search Results"}),": Only published objects appear in search results since unpublished objects are not indexed"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"code-locations",children:"Code Locations"}),"\n",(0,l.jsx)(n.p,{children:"The published-only logic is implemented in:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"lib/Service/GuzzleSolrService.php::indexObject()"})," - Single object indexing"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"lib/Service/GuzzleSolrService.php::bulkIndexFromDatabase()"})," - Bulk indexing (serial mode)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"lib/Service/GuzzleSolrService.php::bulkIndexFromDatabaseOptimized()"})," - Bulk indexing (optimized mode)"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"database-vs-solr-counts",children:"Database vs Solr Counts"}),"\n",(0,l.jsx)(n.p,{children:"The system tracks two different counts:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Published Count"}),": Number of objects in the database with a ",(0,l.jsx)(n.code,{children:"published"})," date (from ",(0,l.jsx)(n.code,{children:"oc_openregister_objects"})," table)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Indexed Count"}),": Number of documents actually indexed in Solr (should match published count)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"These counts are displayed in the Solr Configuration dashboard to help administrators monitor indexing status."}),"\n",(0,l.jsx)(n.h3,{id:"benefits",children:"Benefits"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Relevant Search Results"}),": Users only see content that is meant to be public"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Performance"}),": Smaller Solr index size improves search performance"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Security"}),": Unpublished/draft content is not accidentally exposed through search"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Resource Efficiency"}),": Reduced storage and memory usage in Solr"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"monitoring",children:"Monitoring"}),"\n",(0,l.jsx)(n.h4,{id:"dashboard-statistics",children:"Dashboard Statistics"}),"\n",(0,l.jsx)(n.p,{children:"The Solr Configuration dashboard shows:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Indexed Documents"}),": Number of documents in Solr"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Published Objects Available"}),": Total number of published objects in the database"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"If these numbers don't match, it indicates that some published objects haven't been indexed yet."}),"\n",(0,l.jsx)(n.h4,{id:"logging",children:"Logging"}),"\n",(0,l.jsx)(n.p,{children:"The system logs when unpublished objects are skipped:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Single objects: ",(0,l.jsx)(n.code,{children:"DEBUG"})," level - 'Skipping indexing of unpublished object'"]}),"\n",(0,l.jsxs)(n.li,{children:["Bulk operations: ",(0,l.jsx)(n.code,{children:"INFO"})," level - 'Skipped unpublished objects in batch'"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsxs)(n.p,{children:["No additional configuration is required. The published-only indexing is enabled by default and works automatically based on the ",(0,l.jsx)(n.code,{children:"published"})," field in object entities."]}),"\n",(0,l.jsx)(n.h3,{id:"troubleshooting-2",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h4,{id:"common-issues",children:"Common Issues"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Mismatched Counts"}),": If indexed count < published count"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Run a Solr warmup to re-index all published objects"}),"\n",(0,l.jsx)(n.li,{children:"Check Solr logs for indexing errors"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Objects Not Appearing in Search"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Verify the object has a ",(0,l.jsx)(n.code,{children:"published"})," date set"]}),"\n",(0,l.jsx)(n.li,{children:"Check if the object was indexed after being published"}),"\n",(0,l.jsx)(n.li,{children:"Run a manual re-index if needed"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Performance Issues"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Monitor the published vs indexed ratio"}),"\n",(0,l.jsx)(n.li,{children:"Consider batch size adjustments for bulk operations"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"debugging",children:"Debugging"}),"\n",(0,l.jsx)(n.p,{children:"Enable debug logging to see which objects are being skipped:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// In your Nextcloud config\n'loglevel' => 0, // Debug level\n"})}),"\n",(0,l.jsx)(n.p,{children:"Look for log entries containing:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"'Skipping indexing of unpublished object'"}),"\n",(0,l.jsx)(n.li,{children:"'Skipped unpublished objects in batch'"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"future-considerations",children:"Future Considerations"}),"\n",(0,l.jsx)(n.h4,{id:"todo-full-object-indexing",children:"TODO: Full Object Indexing"}),"\n",(0,l.jsx)(n.p,{children:"There are TODO comments in the code indicating that in the future, we may want to index all objects to Solr for comprehensive search capabilities. This would require:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Access Control"}),": Implementing proper access control in search queries"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Filtering"}),": Adding published/unpublished filters to search results"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Performance"}),": Handling larger index sizes"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Security"}),": Ensuring unpublished content is properly protected"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"collection-specific-endpoints",children:"Collection-Specific Endpoints"}),"\n",(0,l.jsx)(n.p,{children:"OpenRegister uses RESTful collection-specific endpoints for Solr collection management operations. Collection names are specified as URL parameters, following REST principles."}),"\n",(0,l.jsx)(n.h3,{id:"endpoints-1",children:"Endpoints"}),"\n",(0,l.jsx)(n.h4,{id:"1-delete-specific-collection",children:"1. Delete Specific Collection"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-http",children:"DELETE /api/solr/collections/{name}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Controller Method:"})," ",(0,l.jsx)(n.code,{children:"SettingsController::deleteSpecificSolrCollection(string $name)"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl -X DELETE "http://nextcloud.local/index.php/apps/openregister/api/solr/collections/nc_test_collection" \\\n  -u "admin:admin"\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "Collection deleted successfully",\n  "collection": "nc_test_collection"\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"2-clear-specific-collection",children:"2. Clear Specific Collection"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-http",children:"POST /api/solr/collections/{name}/clear\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Controller Method:"})," ",(0,l.jsx)(n.code,{children:"SettingsController::clearSpecificCollection(string $name)"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl -X POST "http://nextcloud.local/index.php/apps/openregister/api/solr/collections/nc_test_collection/clear" \\\n  -u "admin:admin"\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "Collection cleared successfully",\n  "collection": "nc_test_collection"\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"3-reindex-specific-collection",children:"3. Reindex Specific Collection"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-http",children:"POST /api/solr/collections/{name}/reindex\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Controller Method:"})," ",(0,l.jsx)(n.code,{children:"SettingsController::reindexSpecificCollection(string $name)"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl -X POST "http://nextcloud.local/index.php/apps/openregister/api/solr/collections/nc_test_collection/reindex" \\\n  -u "admin:admin"\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "Reindex completed successfully",\n  "stats": {\n    "processed_objects": 1250,\n    "duration_seconds": 4.5\n  },\n  "collection": "nc_test_collection"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"benefits-1",children:"Benefits"}),"\n",(0,l.jsx)(n.h4,{id:"restful-design",children:"RESTful Design"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Collection name is now part of the URL path, following REST principles"}),"\n",(0,l.jsx)(n.li,{children:"Resources are clearly identified by their URLs"}),"\n",(0,l.jsx)(n.li,{children:"HTTP verbs (DELETE, POST) indicate the action"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"improved-api-clarity",children:"Improved API Clarity"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"No ambiguity about which collection is being operated on"}),"\n",(0,l.jsx)(n.li,{children:"Collection name is explicit in every request"}),"\n",(0,l.jsx)(n.li,{children:"Easier to read API logs and debug issues"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"better-error-handling",children:"Better Error Handling"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:'404 errors now correctly indicate "collection not found"'}),"\n",(0,l.jsx)(n.li,{children:"URL validation happens at the routing level"}),"\n",(0,l.jsx)(n.li,{children:"Clearer separation between route parameters and request body"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"migration-from-old-endpoints",children:"Migration from Old Endpoints"}),"\n",(0,l.jsx)(n.p,{children:"The following old endpoints have been removed:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u274c ",(0,l.jsx)(n.code,{children:"POST /api/solr/reindex"})," (replaced by ",(0,l.jsx)(n.code,{children:"/api/solr/collections/{name}/reindex"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:["\u274c ",(0,l.jsx)(n.code,{children:"POST /api/settings/solr/clear"})," (replaced by ",(0,l.jsx)(n.code,{children:"/api/solr/collections/{name}/clear"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:["\u274c ",(0,l.jsx)(n.code,{children:"DELETE /api/solr/collection/delete"})," (replaced by ",(0,l.jsx)(n.code,{children:"DELETE /api/solr/collections/{name}"}),")"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/technical/vector-search-backends",children:"Vector Search Backends"})," - Complete vector backend guide"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/Technical/vectorization-architecture",children:"Vectorization Architecture"})," - How vectors are generated"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/development/solr-development",children:"Solr Development Troubleshooting"})," - Development troubleshooting guide"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"This comprehensive setup process ensures reliable, performant, and maintainable SOLR integration with proper tenant isolation and pre-configured system fields for optimal runtime performance."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var s=i(96540);const l={},t=s.createContext(l);function r(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);