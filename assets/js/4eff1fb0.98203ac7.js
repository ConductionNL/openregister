"use strict";(self.webpackChunkopen_catalogi_docs=self.webpackChunkopen_catalogi_docs||[]).push([[6865],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var i=r(96540);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}},66403:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"fixes/INVERSEDBY_FIXES_SUMMARY","title":"InversedBy Relaties Fixes - Samenvatting","description":"Probleem","source":"@site/docs/fixes/INVERSEDBY_FIXES_SUMMARY.md","sourceDirName":"fixes","slug":"/fixes/INVERSEDBY_FIXES_SUMMARY","permalink":"/docs/fixes/INVERSEDBY_FIXES_SUMMARY","draft":false,"unlisted":false,"editUrl":"https://github.com/conductionnl/openregister/tree/main/website/docs/fixes/INVERSEDBY_FIXES_SUMMARY.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Facet Performance Analysis & Optimization Plan","permalink":"/docs/fixes/FACET_PERFORMANCE_ANALYSIS"},"next":{"title":"Organisatie Schema Fix Summary","permalink":"/docs/fixes/SCHEMA_FIX_SUMMARY"}}');var s=r(74848),l=r(28453);const t={},d="InversedBy Relaties Fixes - Samenvatting",c={},o=[{value:"Probleem",id:"probleem",level:2},{value:"Ge\xefdentificeerde Problemen",id:"ge\xefdentificeerde-problemen",level:2},{value:"1. Onvolledige <code>prepareObjectsForBulkSave</code> methode",id:"1-onvolledige-prepareobjectsforbulksave-methode",level:3},{value:"2. <code>handleBulkInverseRelations</code> werd niet gebruikt",id:"2-handlebulkinverserelations-werd-niet-gebruikt",level:3},{value:"3. BulkController gaf geen context door",id:"3-bulkcontroller-gaf-geen-context-door",level:3},{value:"4. Ontbrekende post-save writeBack",id:"4-ontbrekende-post-save-writeback",level:3},{value:"Verbeterde Workflow",id:"verbeterde-workflow",level:2},{value:"Test Resultaten",id:"test-resultaten",level:2},{value:"CSV Structuur Analyse",id:"csv-structuur-analyse",level:3},{value:"API Test",id:"api-test",level:3},{value:"Impact op Import Functionaliteit",id:"impact-op-import-functionaliteit",level:2},{value:"Voor de Fixes:",id:"voor-de-fixes",level:3},{value:"Na de Fixes:",id:"na-de-fixes",level:3},{value:"Aanbevelingen",id:"aanbevelingen",level:2},{value:"Gebruiksvoorbeeld",id:"gebruiksvoorbeeld",level:2},{value:"Conclusie",id:"conclusie",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"inversedby-relaties-fixes---samenvatting",children:"InversedBy Relaties Fixes - Samenvatting"})}),"\n",(0,s.jsx)(n.h2,{id:"probleem",children:"Probleem"}),"\n",(0,s.jsxs)(n.p,{children:["De ",(0,s.jsx)(n.code,{children:"saveObjects"})," methode in ",(0,s.jsx)(n.code,{children:"ObjectService.php"})," verwerkte inversedBy relaties niet correct tijdens bulk import operaties uit CSV bestanden."]}),"\n",(0,s.jsx)(n.h2,{id:"ge\xefdentificeerde-problemen",children:"Ge\xefdentificeerde Problemen"}),"\n",(0,s.jsxs)(n.h3,{id:"1-onvolledige-prepareobjectsforbulksave-methode",children:["1. Onvolledige ",(0,s.jsx)(n.code,{children:"prepareObjectsForBulkSave"})," methode"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Voor:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// For now, just return the object as-is since SaveObject handler doesn't have prepareObjectForBulkSave\n// TODO: Implement proper object preparation through SaveObject handler\n$preparedObjects[$index] = $object;\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Na:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implementeert pre-validatie cascading"}),"\n",(0,s.jsx)(n.li,{children:"Genereert UUID's waar nodig"}),"\n",(0,s.jsxs)(n.li,{children:["Roept ",(0,s.jsx)(n.code,{children:"handleBulkInverseRelations"})," aan"]}),"\n",(0,s.jsx)(n.li,{children:"Cacht schemas voor performance"}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"2-handlebulkinverserelations-werd-niet-gebruikt",children:["2. ",(0,s.jsx)(n.code,{children:"handleBulkInverseRelations"})," werd niet gebruikt"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Voor:"})," Methode bestond maar werd nooit aangeroepen"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Na:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Aangeroepen in ",(0,s.jsx)(n.code,{children:"prepareObjectsForBulkSave"})]}),"\n",(0,s.jsxs)(n.li,{children:["Verbeterd om te werken zonder ",(0,s.jsx)(n.code,{children:"writeBack"})," vereiste"]}),"\n",(0,s.jsx)(n.li,{children:"Verwerkt inverse relaties binnen de batch"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-bulkcontroller-gaf-geen-context-door",children:"3. BulkController gaf geen context door"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Voor:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"$savedObjects = $this->objectService->saveObjects($objects);\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Na:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"$savedObjects = $this->objectService->saveObjects(\n    objects: $objects,\n    register: $register,\n    schema: $schema,\n    rbac: true,\n    multi: true,\n    validation: true,\n    events: false\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-ontbrekende-post-save-writeback",children:"4. Ontbrekende post-save writeBack"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Voor:"})," Geen writeBack verwerking na bulk save"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Na:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Nieuwe ",(0,s.jsx)(n.code,{children:"handlePostSaveInverseRelations"})," methode"]}),"\n",(0,s.jsx)(n.li,{children:"Gebruikt SaveObject handler's writeBack functionaliteit"}),"\n",(0,s.jsxs)(n.li,{children:["Verwerkt alleen properties met ",(0,s.jsx)(n.code,{children:"writeBack: true"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"verbeterde-workflow",children:"Verbeterde Workflow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Preparation Phase:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Schema caching"}),"\n",(0,s.jsx)(n.li,{children:"UUID generatie"}),"\n",(0,s.jsx)(n.li,{children:"Pre-validatie cascading"}),"\n",(0,s.jsx)(n.li,{children:"Bulk inverse relations verwerking"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Save Phase:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Transform naar database formaat"}),"\n",(0,s.jsx)(n.li,{children:"Bulk save operatie"}),"\n",(0,s.jsx)(n.li,{children:"Object categorisatie (saved/updated)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Post-Save Phase:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["WriteBack verwerking voor properties met ",(0,s.jsx)(n.code,{children:"writeBack: true"})]}),"\n",(0,s.jsx)(n.li,{children:"Error handling per object"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"test-resultaten",children:"Test Resultaten"}),"\n",(0,s.jsx)(n.h3,{id:"csv-structuur-analyse",children:"CSV Structuur Analyse"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"organisatie.csv"})," heeft ",(0,s.jsx)(n.code,{children:"deelnemers"})," kolom (meestal leeg)"]}),"\n",(0,s.jsxs)(n.li,{children:["Schema heeft ",(0,s.jsx)(n.code,{children:"deelnemers"})," met ",(0,s.jsx)(n.code,{children:'inversedBy: "deelnames"'})," en ",(0,s.jsx)(n.code,{children:"writeBack: true"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"deelnames"})," property heeft geen inversedBy configuratie"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"api-test",children:"API Test"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Bulk save API werkt nu correct"}),"\n",(0,s.jsx)(n.li,{children:"Objecten worden daadwerkelijk opgeslagen"}),"\n",(0,s.jsx)(n.li,{children:"InversedBy relaties worden verwerkt in beide richtingen"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"impact-op-import-functionaliteit",children:"Impact op Import Functionaliteit"}),"\n",(0,s.jsx)(n.h3,{id:"voor-de-fixes",children:"Voor de Fixes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CSV import cre\xeberde objecten maar inversedBy relaties werkten niet"}),"\n",(0,s.jsx)(n.li,{children:"Bulk save leek succesvol maar sloeg geen objecten op"}),"\n",(0,s.jsx)(n.li,{children:"Gerelateerde objecten hadden geen terugverwijzingen"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"na-de-fixes",children:"Na de Fixes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CSV import verwerkt inversedBy relaties correct"}),"\n",(0,s.jsx)(n.li,{children:"Bulk save slaat objecten daadwerkelijk op"}),"\n",(0,s.jsx)(n.li,{children:"WriteBack operaties werken voor bidirectionele relaties"}),"\n",(0,s.jsx)(n.li,{children:"Performance verbeterd door schema caching"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"aanbevelingen",children:"Aanbevelingen"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Monitor Performance:"})," De nieuwe schema caching en bulk verwerking zou performance moeten verbeteren, maar monitor bij grote imports"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Test Thoroughly:"})," Test verschillende inversedBy configuraties:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Met en zonder writeBack"}),"\n",(0,s.jsx)(n.li,{children:"Single object vs array relaties"}),"\n",(0,s.jsx)(n.li,{children:"Verschillende schema combinaties"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Documentation Update:"})," Update documentatie over inversedBy configuratie en bulk import gedrag"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error Handling:"})," Verbeter error reporting voor failed inversedBy operations"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"gebruiksvoorbeeld",children:"Gebruiksvoorbeeld"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "objects": [\n    {\n      "@self": {"register": 19, "schema": 105, "id": "org-1"},\n      "naam": "Organisatie 1",\n      "type": "Gemeente"\n    },\n    {\n      "@self": {"register": 19, "schema": 105, "id": "org-2"},\n      "naam": "Organisatie 2", \n      "type": "Gemeente",\n      "deelnemers": ["org-1"]\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Resultaat:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"org-1"})," wordt aangemaakt"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"org-2"})," wordt aangemaakt met ",(0,s.jsx)(n.code,{children:'deelnemers: ["org-1"]'})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"org-1"})," krijgt automatisch ",(0,s.jsx)(n.code,{children:'deelnames: ["org-2"]'})," via writeBack"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"conclusie",children:"Conclusie"}),"\n",(0,s.jsx)(n.p,{children:"De saveObjects methode verwerkt nu correct inversedBy relaties tijdens bulk import operaties. De fixes zorgen ervoor dat CSV imports met gerelateerde objecten correct functioneren en dat bidirectionele relaties automatisch worden onderhouden."})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);