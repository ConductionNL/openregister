<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Features/files" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Files | Open Register</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://openregisters.app/docs/Features/files"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Files | Open Register"><meta data-rh="true" name="description" content="What are Files in Open Register?"><meta data-rh="true" property="og:description" content="What are Files in Open Register?"><link data-rh="true" rel="canonical" href="https://openregisters.app/docs/Features/files"><link data-rh="true" rel="alternate" href="https://openregisters.app/docs/Features/files" hreflang="en"><link data-rh="true" rel="alternate" href="https://openregisters.app/docs/Features/files" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3a202f4d.css">
<script src="/assets/js/runtime~main.e0c01f02.js" defer="defer"></script>
<script src="/assets/js/main.6aa8ac6b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Open Register Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Open Register Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Open Register</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Development/Services">Documentation</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/api">API Documentation</a><a href="https://github.com/conductionnl/openregister" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Development/Services">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/Features">Core Features</a><button aria-label="Collapse sidebar category &#x27;Core Features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/registers">Register</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/schemas">Schemas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/objects">Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/sources">Sources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/search">Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/events">Core Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Features/files">Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/access-control">Acces Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/enhanced-validation-errors">Enhanced Validation Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/organisations">Organisations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/applications">Applications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/configurations">Configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/faceting">Comprehensive Faceting System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/multi-tenancy">Multi-Tenancy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/search-trails">Search Trails</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Technical/vectorization-architecture">Technical</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/UseCases/clientRegisters">UseCases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/api/bulk-operations">api</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/developers/external-app-optimization">developers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/development/tool-registration">development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/features/organisation-roles">features</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/fixes">Fixes Documentation</a><button aria-label="Expand sidebar category &#x27;Fixes Documentation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/technical/MultiTenancyImplementationStatus">technical</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user/ai-conversations">user</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user-guide/importing-data">user-guide</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Features"><span itemprop="name">Core Features</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Files</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Files</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-files-in-open-register">What are Files in Open Register?<a href="#what-are-files-in-open-register" class="hash-link" aria-label="Direct link to What are Files in Open Register?" title="Direct link to What are Files in Open Register?">‚Äã</a></h2>
<p>In Open Register, <strong>Files</strong> are binary data attachments that can be associated with objects. They extend the system beyond structured data to include documents, images, videos, and other file types that are essential for many applications.</p>
<p>Files in Open Register are:</p>
<ul>
<li>Securely stored and managed</li>
<li>Associated with specific objects</li>
<li>Versioned alongside their parent objects</li>
<li>Accessible through a consistent API</li>
<li>Integrated with Nextcloud&#x27;s file management capabilities</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="attaching-files-to-objects">Attaching Files to Objects<a href="#attaching-files-to-objects" class="hash-link" aria-label="Direct link to Attaching Files to Objects" title="Direct link to Attaching Files to Objects">‚Äã</a></h2>
<p>Files can be attached to objects in several ways:</p>
<ol>
<li>Schema-defined file properties: When a schema includes properties of type &#x27;file&#x27;, these are automatically handled during object creation or updates</li>
<li>Direct API attachment: Files can be added to an object after creation using the file attachment API endpoints</li>
<li>Base64 encoded content: Files can be included in object data as base64-encoded strings</li>
<li>URL references: External files can be referenced by URL and will be downloaded and stored locally</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-metadata-and-tagging">File Metadata and Tagging<a href="#file-metadata-and-tagging" class="hash-link" aria-label="Direct link to File Metadata and Tagging" title="Direct link to File Metadata and Tagging">‚Äã</a></h2>
<p>Each file attachment includes rich metadata:</p>
<ul>
<li>Basic properties (name, size, type, extension)</li>
<li>Creation and modification timestamps</li>
<li>Access and download URLs</li>
<li>Checksum for integrity verification</li>
<li>Custom tags for categorization</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tagging-system">Tagging System<a href="#tagging-system" class="hash-link" aria-label="Direct link to Tagging System" title="Direct link to Tagging System">‚Äã</a></h3>
<p>Files can be tagged with both simple labels and key-value pairs:</p>
<ul>
<li>Tags with a colon (&#x27;:&#x27;) are treated as key-value pairs and can be used for advanced filtering and organization</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="version-control">Version Control<a href="#version-control" class="hash-link" aria-label="Direct link to Version Control" title="Direct link to Version Control">‚Äã</a></h2>
<p>The system maintains file versions by:</p>
<ul>
<li>Tracking file modifications with timestamps</li>
<li>Preserving checksums to detect changes</li>
<li>Integrating with the object audit trail system</li>
<li>Supporting file restoration from previous versions</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-and-access-control">Security and Access Control<a href="#security-and-access-control" class="hash-link" aria-label="Direct link to Security and Access Control" title="Direct link to Security and Access Control">‚Äã</a></h2>
<p>File attachments inherit the security model of their parent objects:</p>
<ul>
<li>Files are stored in NextCloud with appropriate permissions</li>
<li>Share links can be generated for controlled external access</li>
<li>Access is managed through the OpenRegister user and group system</li>
<li>Files are associated with the OpenRegister application user for consistent permissions</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-operations">File Operations<a href="#file-operations" class="hash-link" aria-label="Direct link to File Operations" title="Direct link to File Operations">‚Äã</a></h2>
<p>The system supports the following operations on file attachments:</p>
<ul>
<li>Retrieving Files</li>
<li>Updating Files</li>
<li>Deleting Files</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-preview-and-rendering">File Preview and Rendering<a href="#file-preview-and-rendering" class="hash-link" aria-label="Direct link to File Preview and Rendering" title="Direct link to File Preview and Rendering">‚Äã</a></h2>
<p>The system leverages NextCloud&#x27;s preview capabilities for supported file types:</p>
<ul>
<li>Images are displayed as thumbnails</li>
<li>PDFs can be previewed in-browser</li>
<li>Office documents can be viewed with compatible apps</li>
<li>Preview URLs are generated for easy embedding</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integration-with-object-lifecycle">Integration with Object Lifecycle<a href="#integration-with-object-lifecycle" class="hash-link" aria-label="Direct link to Integration with Object Lifecycle" title="Direct link to Integration with Object Lifecycle">‚Äã</a></h2>
<p>File attachments are fully integrated with the object lifecycle:</p>
<ul>
<li>When objects are created, their file folders are automatically provisioned</li>
<li>When objects are updated, file references are maintained</li>
<li>When objects are deleted, associated files can be optionally preserved or removed</li>
<li>File operations are recorded in the object&#x27;s audit trail</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-implementation">Technical Implementation<a href="#technical-implementation" class="hash-link" aria-label="Direct link to Technical Implementation" title="Direct link to Technical Implementation">‚Äã</a></h2>
<p>The file attachment system is implemented through two main service classes:</p>
<ul>
<li>FileService: Handles low-level file operations, folder management, and NextCloud integration</li>
<li>ObjectService: Provides high-level methods for attaching, retrieving, and managing files in the context of objects</li>
</ul>
<p>These services work together to provide a seamless file management experience within the OpenRegister application.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-structure">File Structure<a href="#file-structure" class="hash-link" aria-label="Direct link to File Structure" title="Direct link to File Structure">‚Äã</a></h2>
<div class="redocusaurus redocusaurus-schema"><div class="sc-dycHyt fkKAFm"><div class="sc-kfeOyU fKVBAK"><div class="sc-fLDLck kcATjX"><table class="sc-dVupuq eiOZOK"><tbody><tr class=""><td kind="field" title="id" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">id</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">integer</span></div> <div><div html="&lt;p&gt;Unique identifier of the file in Nextcloud&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>Unique identifier of the file in Nextcloud</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="uuid" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">uuid</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span></div> <div><div html="&lt;p&gt;Unique identifier for the file&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>Unique identifier for the file</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="filename" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">filename</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span></div> <div><div html="&lt;p&gt;Name of the file&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>Name of the file</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="downloadUrl" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">downloadUrl</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span><span class="sc-sediK sc-haUlXw bofVia YIflu"> <!-- -->&lt;<!-- -->uri<!-- -->&gt;<!-- --> </span></div> <div><div html="&lt;p&gt;Direct download URL for the file&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>Direct download URL for the file</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="shareUrl" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">shareUrl</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span><span class="sc-sediK sc-haUlXw bofVia YIflu"> <!-- -->&lt;<!-- -->uri<!-- -->&gt;<!-- --> </span></div> <div><div html="&lt;p&gt;URL to access the file via share link&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>URL to access the file via share link</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="accessUrl" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">accessUrl</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span><span class="sc-sediK sc-haUlXw bofVia YIflu"> <!-- -->&lt;<!-- -->uri<!-- -->&gt;<!-- --> </span></div> <div><div html="&lt;p&gt;URL to access the file&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>URL to access the file</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="extension" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">extension</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span></div> <div><div html="&lt;p&gt;File extension&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>File extension</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="checksum" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">checksum</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span></div> <div><div html="&lt;p&gt;ETag hash for file versioning&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>ETag hash for file versioning</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="source" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">source</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">integer</span></div> <div><div html="&lt;p&gt;Source identifier&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>Source identifier</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="userId" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">userId</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span></div> <div><div html="&lt;p&gt;ID of the user who owns the file&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>ID of the user who owns the file</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="base64" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">base64</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span></div> <div><div html="&lt;p&gt;Base64 encoded content of the file&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>Base64 encoded content of the file</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="filePath" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">filePath</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span></div> <div><div html="&lt;p&gt;Full path to the file in Nextcloud&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>Full path to the file in Nextcloud</p>
</div></div></div></td></tr><tr class=""><td kind="field" title="created" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">created</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span><span class="sc-sediK sc-haUlXw bofVia YIflu"> <!-- -->&lt;<!-- -->date-time<!-- -->&gt;<!-- --> </span></div> <div><div html="&lt;p&gt;ISO 8601 timestamp when file was first shared&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>ISO 8601 timestamp when file was first shared</p>
</div></div></div></td></tr><tr class="last"><td kind="field" title="updated" class="sc-kXOizl sc-dPKAra lhZBSD eArqpj"><span class="sc-gjXmFk jdtOkr"></span><span class="property-name">updated</span></td><td class="sc-fuExOL cgrxxt"><div><div><span class="sc-sediK sc-cAQujh bofVia cMqjKH"></span><span class="sc-sediK sc-haUlXw bofVia YIflu">string</span><span class="sc-sediK sc-haUlXw bofVia YIflu"> <!-- -->&lt;<!-- -->date-time<!-- -->&gt;<!-- --> </span></div> <div><div html="&lt;p&gt;ISO 8601 timestamp of last modification&lt;/p&gt;
" class="sc-dJkDXt sc-eXfTSZ bOBPCh iCfWxP"><p>ISO 8601 timestamp of last modification</p>
</div></div></div></td></tr></tbody></table></div><div class="sc-jbAkgO sc-gNZgCX dyTVJw kBIQEu"><div class="sc-gkCgsS dFtaGR"><div class="sc-loYsQo exYKuj"><div class="sc-eOrxMY fhJHli"><div class="sc-lertIE cfVXnF"><button><div class="sc-fCSSOr kPewJt">Copy</div></button></div><div class="sc-dJkDXt bOBPCh sc-gtlvkJ gKIeoL"><div class="redoc-json"><code><button class="collapser" aria-label="collapse"></button><span class="token punctuation">{</span><span class="ellipsis"></span><ul class="obj collapsible"><li><div class="hoverable"><span class="property token string">"id"</span>: <span class="token number">123</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"uuid"</span>: <span class="token string">&quot;123e4567-e89b-12d3-a456-426614174000&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"filename"</span>: <span class="token string">&quot;profile.jpg&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"downloadUrl"</span>: <span class="token string">&quot;</span><a href="https://example.com/download/123">https://example.com/download/123</a><span class="token string">&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"shareUrl"</span>: <span class="token string">&quot;</span><a href="https://example.com/share/123">https://example.com/share/123</a><span class="token string">&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"accessUrl"</span>: <span class="token string">&quot;</span><a href="https://example.com/access/123">https://example.com/access/123</a><span class="token string">&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"extension"</span>: <span class="token string">&quot;jpg&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"checksum"</span>: <span class="token string">&quot;abc123&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"source"</span>: <span class="token number">1</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"userId"</span>: <span class="token string">&quot;user-12345&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"base64"</span>: <span class="token string">&quot;base64encodedstring&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"filePath"</span>: <span class="token string">&quot;/files/profile.jpg&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"created"</span>: <span class="token string">&quot;2023-02-15T14:30:00Z&quot;</span><span class="token punctuation">,</span></div></li><li><div class="hoverable"><span class="property token string">"updated"</span>: <span class="token string">&quot;2023-05-20T10:15:00Z&quot;</span></div></li></ul><span class="token punctuation">}</span></code></div></div></div></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-files-are-stored">How Files are Stored<a href="#how-files-are-stored" class="hash-link" aria-label="Direct link to How Files are Stored" title="Direct link to How Files are Stored">‚Äã</a></h2>
<p>Open Register provides flexible storage options for files:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-nextcloud-storage">1. Nextcloud Storage<a href="#1-nextcloud-storage" class="hash-link" aria-label="Direct link to 1. Nextcloud Storage" title="Direct link to 1. Nextcloud Storage">‚Äã</a></h3>
<p>By default, files are stored in Nextcloud&#x27;s file system, leveraging its robust file management capabilities, including:</p>
<ul>
<li>Access control</li>
<li>Versioning</li>
<li>Encryption</li>
<li>Collaborative editing</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-external-storage">2. External Storage<a href="#2-external-storage" class="hash-link" aria-label="Direct link to 2. External Storage" title="Direct link to 2. External Storage">‚Äã</a></h3>
<p>For larger deployments or specialized needs, files can be stored in:</p>
<ul>
<li>Object storage systems (S3, MinIO)</li>
<li>Content delivery networks</li>
<li>Specialized document management systems</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-database-storage">3. Database Storage<a href="#3-database-storage" class="hash-link" aria-label="Direct link to 3. Database Storage" title="Direct link to 3. Database Storage">‚Äã</a></h3>
<p>Small files can be stored directly in the database for simplicity and performance.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-features">File Features<a href="#file-features" class="hash-link" aria-label="Direct link to File Features" title="Direct link to File Features">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-versioning">1. Versioning<a href="#1-versioning" class="hash-link" aria-label="Direct link to 1. Versioning" title="Direct link to 1. Versioning">‚Äã</a></h3>
<p>Files maintain version history, allowing you to:</p>
<ul>
<li>Track changes over time</li>
<li>Revert to previous versions</li>
<li>Compare different versions</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-access-control">2. Access Control<a href="#2-access-control" class="hash-link" aria-label="Direct link to 2. Access Control" title="Direct link to 2. Access Control">‚Äã</a></h3>
<p>Files inherit access control from their parent objects, ensuring consistent security:</p>
<ul>
<li>Users who can access an object can access its files</li>
<li>Additional file-specific permissions can be applied</li>
<li>Permissions can be audited</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-metadata">3. Metadata<a href="#3-metadata" class="hash-link" aria-label="Direct link to 3. Metadata" title="Direct link to 3. Metadata">‚Äã</a></h3>
<p>Files support rich metadata to provide context and improve searchability:</p>
<ul>
<li>Standard metadata (creation date, size, type)</li>
<li>Custom metadata specific to your application</li>
<li>Extracted metadata (e.g., EXIF data from images)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-preview-generation">4. Preview Generation<a href="#4-preview-generation" class="hash-link" aria-label="Direct link to 4. Preview Generation" title="Direct link to 4. Preview Generation">‚Äã</a></h3>
<p>Open Register can generate previews for common file types:</p>
<ul>
<li>Thumbnails for images</li>
<li>PDF previews</li>
<li>Document previews</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-content-extraction">5. Content Extraction<a href="#5-content-extraction" class="hash-link" aria-label="Direct link to 5. Content Extraction" title="Direct link to 5. Content Extraction">‚Äã</a></h3>
<p>For supported file types, content can be extracted for indexing and search:</p>
<ul>
<li>Text extraction from documents</li>
<li>OCR for scanned documents and images</li>
<li>Metadata extraction</li>
</ul>
<p><strong>Asynchronous Processing</strong>: Text extraction happens in the background after file upload, ensuring:</p>
<ul>
<li><strong>Fast uploads</strong>: Your file uploads complete instantly without waiting</li>
<li><strong>Non-blocking</strong>: Users don&#x27;t experience delays during file operations</li>
<li><strong>Reliable</strong>: Background jobs automatically handle retries for failed extractions</li>
<li><strong>Resource-efficient</strong>: Processing happens when resources are available</li>
</ul>
<p><strong>Text Extraction Options</strong>:</p>
<p>OpenRegister supports two text extraction engines:</p>
<ol>
<li>
<p><strong>LLPhant (Default)</strong> - PHP-based extraction:</p>
<ul>
<li>‚úì Native support: TXT, MD, HTML, JSON, XML, CSV</li>
<li>‚óã Library support: PDF, DOCX, DOC, XLSX, XLS (requires PhpOffice, PdfParser)</li>
<li>‚ö†Ô∏è Limited: PPTX, ODT, RTF</li>
<li>‚úó No support: Image files (JPG, PNG, GIF, WebP)</li>
<li>Best for: Privacy-conscious environments, regular documents</li>
<li>Cost: Free (included)</li>
</ul>
</li>
<li>
<p><strong>Dolphin AI</strong> - Advanced AI-powered extraction:</p>
<ul>
<li>‚úì All document formats with superior quality</li>
<li>‚úì OCR for scanned documents and images (JPG, PNG, GIF, WebP)</li>
<li>‚úì Advanced table extraction</li>
<li>‚úì Formula recognition</li>
<li>‚úì Multi-language OCR</li>
<li>Best for: Complex documents, scanned materials, images with text</li>
<li>Cost: API subscription required</li>
</ul>
</li>
</ol>
<p><strong>Extraction Scope Options</strong>:</p>
<ul>
<li><strong>None</strong>: Text extraction disabled</li>
<li><strong>All files</strong>: Extract from all uploaded files</li>
<li><strong>Files in folders</strong>: Extract only from files in specific folders</li>
<li><strong>Files attached to objects</strong>: Extract only from files linked to objects (recommended)</li>
</ul>
<p><strong>Typical Processing Times</strong>:</p>
<ul>
<li>Text files: &lt; 1 second</li>
<li>PDFs (LLPhant): 2-10 seconds</li>
<li>PDFs (Dolphin): 3-15 seconds</li>
<li>Large documents or OCR: 10-60 seconds</li>
<li>Images with OCR (Dolphin): 5-20 seconds</li>
</ul>
<p>You can configure text extraction in Settings ‚Üí File Configuration. Check extraction status in the file&#x27;s metadata after upload.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="technical-implementation-1">Technical Implementation<a href="#technical-implementation-1" class="hash-link" aria-label="Direct link to Technical Implementation" title="Direct link to Technical Implementation">‚Äã</a></h3>
<p><strong>Background Job Processing</strong>:</p>
<p>Text extraction uses Nextcloud&#x27;s background job system for reliable, async processing:</p>
<ol>
<li><strong>File Upload</strong> - User uploads a file</li>
<li><strong>Job Queuing</strong> - &#x27;FileChangeListener&#x27; automatically queues &#x27;FileTextExtractionJob&#x27;</li>
<li><strong>Job Execution</strong> - Background job system processes the file when resources are available</li>
<li><strong>Text Extraction</strong> - Selected extractor (LLPhant or Dolphin) processes the file</li>
<li><strong>Chunking</strong> - Text is automatically split into chunks with overlap (1000 chars per chunk, 200 char overlap)</li>
<li><strong>Storage</strong> - Extracted text and chunks stored in &#x27;FileText&#x27; entity for reuse</li>
<li><strong>Completion</strong> - Status updated to &#x27;completed&#x27; or &#x27;failed&#x27;</li>
</ol>
<p><strong>Note</strong>: Text extraction is now <strong>fully independent of SOLR</strong>. Chunks are generated during extraction and stored in the database, making them reusable for SOLR indexing, vector embeddings, AI processing, or any other service that needs chunked text.</p>
<p><strong>File Type Compatibility Matrix</strong>:</p>
<p><strong>LLPhant Support:</strong></p>
<ul>
<li>‚úì <strong>Native</strong> (TXT, MD, HTML, JSON, XML, CSV) - Perfect quality, very fast</li>
<li>‚óã <strong>Library</strong> (PDF, DOCX, DOC, XLSX, XLS) - Good quality, medium speed</li>
<li>‚ö†Ô∏è <strong>Limited</strong> (PPTX, ODT, RTF) - Basic text only, use Dolphin for better results</li>
<li>‚úó <strong>No Support</strong> (JPG, PNG, GIF, WebP) - Requires Dolphin with OCR</li>
</ul>
<p><strong>Dolphin AI Support:</strong></p>
<ul>
<li>‚úì All formats with superior quality</li>
<li>‚úì OCR for scanned documents and images</li>
<li>‚úì Table extraction with structure preserved</li>
<li>‚úì Formula recognition (LaTeX format)</li>
<li>‚úì Multi-language support</li>
<li>‚úì Layout understanding (multi-column, etc.)</li>
</ul>
<p><strong>OCR-Specific Use Cases (Dolphin only)</strong>:</p>
<ol>
<li><strong>Document Digitization</strong> - Scanning paper archives into searchable text</li>
<li><strong>Receipt Processing</strong> - Photo receipts from mobile devices</li>
<li><strong>Screenshot Analysis</strong> - Extract text from application screenshots</li>
<li><strong>Infographic Text</strong> - Extract text from images with embedded text</li>
<li><strong>Historical Documents</strong> - Digitize old scanned materials</li>
</ol>
<p><strong>Quality Requirements for OCR</strong>:</p>
<ul>
<li>Minimum: 150 DPI resolution</li>
<li>Recommended: 300+ DPI</li>
<li>Clear, high-contrast images</li>
<li>Minimal blur or distortion</li>
<li>Properly oriented (not rotated)</li>
</ul>
<p><strong>Extraction Configuration Options</strong>:</p>
<p>Configure in Settings ‚Üí File Configuration:</p>
<ol>
<li>
<p><strong>Text Extractor Selection</strong>:</p>
<ul>
<li>LLPhant (default) - Local, free, privacy-friendly</li>
<li>Dolphin - Advanced AI, requires API key</li>
</ul>
</li>
<li>
<p><strong>Extraction Scope</strong>:</p>
<ul>
<li>None - Disabled</li>
<li>All files - Every uploaded file</li>
<li>Files in folders - Specific folders only</li>
<li>Files attached to objects - Only object attachments (recommended)</li>
</ul>
</li>
<li>
<p><strong>Extraction Mode</strong>:</p>
<ul>
<li>Background (default) - Async via background jobs</li>
<li>Immediate - Synchronous during upload (slower)</li>
<li>Manual - Triggered by admin action only</li>
</ul>
</li>
<li>
<p><strong>Enabled File Types</strong>:</p>
<ul>
<li>Select which file extensions to process</li>
<li>Different for LLPhant vs Dolphin</li>
<li>Enable OCR formats (images) only if using Dolphin</li>
</ul>
</li>
</ol>
<p><strong>Integration Tests</strong>:</p>
<p>The file text extraction system includes comprehensive integration tests:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Run file extraction tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit tests/Integration/FileTextExtractionIntegrationTest.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Test cases covered:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - File upload queues background job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Background job execution completes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Text extraction end-to-end with content verification</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Multiple file format support (TXT, MD, JSON)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Extraction metadata recording (status, method, timestamps)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Monitoring Extraction</strong>:</p>
<p>Check extraction status via logs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Watch extraction progress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker logs -f nextcloud-container | grep FileTextExtractionJob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check for errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker logs nextcloud-container | grep &#x27;extraction failed&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># View extraction statistics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Settings ‚Üí File Configuration ‚Üí Statistics section</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="files-management-page">Files Management Page<a href="#files-management-page" class="hash-link" aria-label="Direct link to Files Management Page" title="Direct link to Files Management Page">‚Äã</a></h2>
<p>The Files page provides a centralized view of all files tracked in the text extraction system.</p>
<p><strong>Accessing the Files Page</strong>:</p>
<p>Navigate to <strong>Files</strong> in the main menu to view all files with their extraction status.</p>
<p><strong>Features</strong>:</p>
<ol>
<li>
<p><strong>File List Table</strong>:</p>
<ul>
<li>File name and path</li>
<li>File type and size</li>
<li>Extraction status (Pending, Processing, Completed, Failed)</li>
<li>Number of text chunks created</li>
<li>Last extraction timestamp</li>
</ul>
</li>
<li>
<p><strong>Status Indicators</strong>:</p>
<ul>
<li>üü† <strong>Pending</strong>: File discovered but not yet extracted</li>
<li>üîµ <strong>Processing</strong>: Extraction in progress</li>
<li>üü¢ <strong>Completed</strong>: Successfully extracted</li>
<li>üî¥ <strong>Failed</strong>: Extraction error occurred</li>
</ul>
</li>
<li>
<p><strong>File Actions</strong>:</p>
<ul>
<li><strong>Retry</strong>: Re-extract failed files</li>
<li><strong>View Error</strong>: See detailed error message for failed extractions</li>
</ul>
</li>
<li>
<p><strong>Pagination</strong>:</p>
<ul>
<li>Browse through large file lists (50 files per page)</li>
<li>Navigate between pages</li>
</ul>
</li>
<li>
<p><strong>Refresh</strong>:</p>
<ul>
<li>Update the list to see latest extraction status</li>
</ul>
</li>
</ol>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Monitor extraction progress across all files</li>
<li>Identify and retry failed extractions</li>
<li>View error details for troubleshooting</li>
<li>Verify which files have been processed</li>
</ul>
<p><strong>Core File Extraction API</strong>:</p>
<p>OpenRegister provides dedicated API endpoints for file text extraction (moved from settings to core functionality):</p>
<ul>
<li><code>GET /api/files</code> - List all tracked files with extraction status</li>
<li><code>GET /api/files/{id}</code> - Get single file extraction information</li>
<li><code>POST /api/files/{id}/extract</code> - Extract text from specific file</li>
<li><code>POST /api/files/extract</code> - Extract all pending files (batch processing)</li>
<li><code>POST /api/files/retry-failed</code> - Retry all failed extractions</li>
<li><code>GET /api/files/stats</code> - Get extraction statistics</li>
</ul>
<p><strong>Smart Re-Extraction</strong>:</p>
<p>The system automatically detects when files need re-extraction by comparing:</p>
<ul>
<li>File modification time (&#x27;mtime&#x27; from Nextcloud&#x27;s &#x27;oc_filecache&#x27;)</li>
<li>Last extraction time (&#x27;extractedAt&#x27; from &#x27;oc_openregister_file_texts&#x27;)</li>
</ul>
<p>If &#x27;mtime &gt; extractedAt&#x27;, the file is re-extracted to ensure content is up-to-date.</p>
<p><strong>File Tracking Table</strong>:</p>
<p>Extracted text and metadata are stored in &#x27;oc_openregister_file_texts&#x27; with:</p>
<ul>
<li>&#x27;file_id&#x27; - Links to Nextcloud&#x27;s &#x27;oc_filecache&#x27; table</li>
<li>&#x27;extraction_status&#x27; - pending, processing, completed, failed</li>
<li>&#x27;extractedAt&#x27; - Timestamp of last extraction</li>
<li>&#x27;text_content&#x27; - Full extracted text</li>
<li>&#x27;text_length&#x27; - Character count</li>
<li>&#x27;chunked&#x27; - Whether text has been chunked</li>
<li>&#x27;chunk_count&#x27; - Number of chunks created</li>
<li>&#x27;chunks_json&#x27; - JSON array of text chunks with offsets (new in v0.2.7)</li>
<li>&#x27;extraction_method&#x27; - LLPhant or Dolphin</li>
<li>Plus SOLR indexing and vectorization tracking</li>
</ul>
<p><strong>Chunking Details</strong>: Each chunk in &#x27;chunks_json&#x27; contains the chunk text, start offset, and end offset. This allows for precise text retrieval and consistent chunking across all services.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-files">Working with Files<a href="#working-with-files" class="hash-link" aria-label="Direct link to Working with Files" title="Direct link to Working with Files">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uploading-files">Uploading Files<a href="#uploading-files" class="hash-link" aria-label="Direct link to Uploading Files" title="Direct link to Uploading Files">‚Äã</a></h3>
<p>Files can be uploaded and attached to objects:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /api/objects/{id}/files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: multipart/form-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file: [binary data]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata: {&quot;author&quot;: &quot;Legal Department&quot;, &quot;securityLevel&quot;: &quot;confidential&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="retrieving-files">Retrieving Files<a href="#retrieving-files" class="hash-link" aria-label="Direct link to Retrieving Files" title="Direct link to Retrieving Files">‚Äã</a></h3>
<p>You can download a file:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/files/{id}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Or get file metadata:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/files/{id}/metadata</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="listing-files-for-an-object">Listing Files for an Object<a href="#listing-files-for-an-object" class="hash-link" aria-label="Direct link to Listing Files for an Object" title="Direct link to Listing Files for an Object">‚Äã</a></h3>
<p>You can retrieve all files associated with an object:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/objects/files/{objectId}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-files">Updating Files<a href="#updating-files" class="hash-link" aria-label="Direct link to Updating Files" title="Direct link to Updating Files">‚Äã</a></h3>
<p>Files can be updated in two ways:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-update-file-content">1. Update File Content<a href="#1-update-file-content" class="hash-link" aria-label="Direct link to 1. Update File Content" title="Direct link to 1. Update File Content">‚Äã</a></h4>
<p>Upload a new version of the file:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT /api/objects/{register}/{schema}/{objectId}/files/{fileId}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;content&#x27;: &#x27;[base64 encoded content or raw content]&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;tags&#x27;: [&#x27;tag1&#x27;, &#x27;tag2&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-update-metadata-only">2. Update Metadata Only<a href="#2-update-metadata-only" class="hash-link" aria-label="Direct link to 2. Update Metadata Only" title="Direct link to 2. Update Metadata Only">‚Äã</a></h4>
<p>Update only the file metadata (tags) without changing content:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT /api/objects/{register}/{schema}/{objectId}/files/{fileId}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;tags&#x27;: [&#x27;updated-tag1&#x27;, &#x27;updated-tag2&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note: The &#x27;content&#x27; parameter is optional. If omitted, only the metadata will be updated without modifying the file content itself.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deleting-files">Deleting Files<a href="#deleting-files" class="hash-link" aria-label="Direct link to Deleting Files" title="Direct link to Deleting Files">‚Äã</a></h3>
<p>Files can be deleted when no longer needed:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DELETE /api/files/{id}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-relationships">File Relationships<a href="#file-relationships" class="hash-link" aria-label="Direct link to File Relationships" title="Direct link to File Relationships">‚Äã</a></h2>
<p>Files have important relationships with other core concepts:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="files-and-objects">Files and Objects<a href="#files-and-objects" class="hash-link" aria-label="Direct link to Files and Objects" title="Direct link to Files and Objects">‚Äã</a></h3>
<ul>
<li>Files are attached to objects</li>
<li>An object can have multiple files</li>
<li>Files inherit permissions from their parent object</li>
<li>Files are versioned alongside their parent object</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="files-and-schemas">Files and Schemas<a href="#files-and-schemas" class="hash-link" aria-label="Direct link to Files and Schemas" title="Direct link to Files and Schemas">‚Äã</a></h3>
<ul>
<li>Schemas can define expectations for file attachments</li>
<li>File validation can be specified in schemas (allowed types, max size)</li>
<li>Schemas can define required file attachments</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="files-and-registers">Files and Registers<a href="#files-and-registers" class="hash-link" aria-label="Direct link to Files and Registers" title="Direct link to Files and Registers">‚Äã</a></h3>
<ul>
<li>Registers can be configured with different file storage options</li>
<li>File storage policies can be defined at the register level</li>
<li>Registers can have quotas for file storage</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-document-management">1. Document Management<a href="#1-document-management" class="hash-link" aria-label="Direct link to 1. Document Management" title="Direct link to 1. Document Management">‚Äã</a></h3>
<p>Attach important documents to business objects:</p>
<ul>
<li>Contracts to customer records</li>
<li>Invoices to order records</li>
<li>Specifications to product records</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-media-management">2. Media Management<a href="#2-media-management" class="hash-link" aria-label="Direct link to 2. Media Management" title="Direct link to 2. Media Management">‚Äã</a></h3>
<p>Store and manage media assets:</p>
<ul>
<li>Product images</li>
<li>Marketing materials</li>
<li>Training videos</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-evidence-collection">3. Evidence Collection<a href="#3-evidence-collection" class="hash-link" aria-label="Direct link to 3. Evidence Collection" title="Direct link to 3. Evidence Collection">‚Äã</a></h3>
<p>Maintain evidence for regulatory or legal purposes:</p>
<ul>
<li>Compliance documentation</li>
<li>Audit evidence</li>
<li>Legal case files</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-technical-documentation">4. Technical Documentation<a href="#4-technical-documentation" class="hash-link" aria-label="Direct link to 4. Technical Documentation" title="Direct link to 4. Technical Documentation">‚Äã</a></h3>
<p>Manage technical documents:</p>
<ul>
<li>User manuals</li>
<li>Technical specifications</li>
<li>Installation guides</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-file-features">Advanced File Features<a href="#advanced-file-features" class="hash-link" aria-label="Direct link to Advanced File Features" title="Direct link to Advanced File Features">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-auto-share-configuration">1. Auto-Share Configuration<a href="#1-auto-share-configuration" class="hash-link" aria-label="Direct link to 1. Auto-Share Configuration" title="Direct link to 1. Auto-Share Configuration">‚Äã</a></h3>
<p>File properties can be configured to automatically share uploaded files publicly. This is useful for assets that need to be accessible without authentication, such as product images or public documents.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-via-ui">Configuration via UI<a href="#configuration-via-ui" class="hash-link" aria-label="Direct link to Configuration via UI" title="Direct link to Configuration via UI">‚Äã</a></h4>
<p>When editing a schema in the OpenRegister UI:</p>
<ol>
<li>Select a property with type &#x27;file&#x27; or &#x27;array&#x27; with items type &#x27;file&#x27;</li>
<li>In the property actions menu, expand the &#x27;File Configuration&#x27; section</li>
<li>Check the &#x27;Auto-Share Files&#x27; checkbox</li>
<li>Save the schema</li>
</ol>
<p>Files uploaded to this property will now be automatically publicly shared.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-via-api">Configuration via API<a href="#configuration-via-api" class="hash-link" aria-label="Direct link to Configuration via API" title="Direct link to Configuration via API">‚Äã</a></h4>
<p>In your schema definition, add the &#x27;autoPublish&#x27; option to file properties:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;properties&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;productImage&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;autoPublish&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;allowedTypes&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">&#x27;image/jpeg&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;image/png&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;maxSize&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5242880</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When &#x27;autoPublish&#x27; is set to &#x27;true&#x27;, files uploaded to this property will automatically:</p>
<ul>
<li>Create a public share link</li>
<li>Set the &#x27;published&#x27; timestamp</li>
<li>Generate a public &#x27;accessUrl&#x27; and &#x27;downloadUrl&#x27;</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="important-property-level-vs-schema-level-autopublish">Important: Property-Level vs Schema-Level autoPublish<a href="#important-property-level-vs-schema-level-autopublish" class="hash-link" aria-label="Direct link to Important: Property-Level vs Schema-Level autoPublish" title="Direct link to Important: Property-Level vs Schema-Level autoPublish">‚Äã</a></h4>
<p>‚ö†Ô∏è <strong>Don&#x27;t confuse these two different &#x27;autoPublish&#x27; settings:</strong></p>
<p><strong>1. Property-Level autoPublish</strong> (this section):</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;properties&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;productImage&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;autoPublish&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ‚Üê Controls if FILES are published</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Controls whether files uploaded to this specific property are automatically shared publicly.</p>
<p><strong>2. Schema-Level autoPublish</strong> (different setting):</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;configuration&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;autoPublish&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ‚Üê Controls if OBJECTS are published</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Controls whether the object entity itself is published (has nothing to do with file sharing).</p>
<p><strong>These are completely separate settings</strong> with different purposes. Setting one does NOT affect the other.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-response">Example Response<a href="#example-response" class="hash-link" aria-label="Direct link to Example Response" title="Direct link to Example Response">‚Äã</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;id&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;</span><span class="token number" style="color:#36acaa">12345</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;title&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;Product A&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;productImage&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;id&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">789</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;title&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;product-a.jpg&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;accessUrl&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//your-domain.com/index.php/s/AbCdEfG123&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;downloadUrl&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//your-domain.com/index.php/s/AbCdEfG123/download&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;published&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;</span><span class="token number" style="color:#36acaa">2024</span><span class="token number" style="color:#36acaa">-01</span><span class="token plain">-15T10</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">30</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain">+</span><span class="token number" style="color:#36acaa">00</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;size&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">245678</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;image/jpeg&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-authenticated-file-access">2. Authenticated File Access<a href="#2-authenticated-file-access" class="hash-link" aria-label="Direct link to 2. Authenticated File Access" title="Direct link to 2. Authenticated File Access">‚Äã</a></h3>
<p>Files that are not publicly shared still have &#x27;accessUrl&#x27; and &#x27;downloadUrl&#x27; properties, but these URLs require authentication. This allows frontend applications to:</p>
<ul>
<li>Display file previews for logged-in users</li>
<li>Provide download links that work within authenticated sessions</li>
<li>Maintain security while offering convenient access</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authenticated-urls">Authenticated URLs<a href="#authenticated-urls" class="hash-link" aria-label="Direct link to Authenticated URLs" title="Direct link to Authenticated URLs">‚Äã</a></h4>
<p>Non-shared files return URLs with the following format:</p>
<ul>
<li><strong>Access URL</strong>: <code>/index.php/core/preview?fileId={fileId}&amp;x=1920&amp;y=1080&amp;a=1</code></li>
<li><strong>Download URL</strong>: <code>/index.php/apps/openregister/api/files/{fileId}/download</code></li>
</ul>
<p>These URLs require the user to be authenticated to Nextcloud.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-response-non-shared-file">Example Response (Non-Shared File)<a href="#example-response-non-shared-file" class="hash-link" aria-label="Direct link to Example Response (Non-Shared File)" title="Direct link to Example Response (Non-Shared File)">‚Äã</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;attachment&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;id&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">456</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;title&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;confidential-report.pdf&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;accessUrl&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//your-domain.com/index.php/core/preview?fileId=456&amp;x=1920&amp;y=1080&amp;a=1&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;downloadUrl&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//your-domain.com/index.php/apps/openregister/api/files/456/download&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;published&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;size&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234567</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;application/pdf&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-logoimage-metadata-from-file-properties">3. Logo/Image Metadata from File Properties<a href="#3-logoimage-metadata-from-file-properties" class="hash-link" aria-label="Direct link to 3. Logo/Image Metadata from File Properties" title="Direct link to 3. Logo/Image Metadata from File Properties">‚Äã</a></h3>
<p>When a schema is configured to extract metadata fields like &#x27;image&#x27; or &#x27;logo&#x27; from file properties, the system automatically extracts the public share URL (or authenticated URL if not shared) and stores it in the object metadata.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">‚Äã</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;properties&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;logo&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;allowedTypes&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">&#x27;image/png&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;image/jpeg&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;autoPublish&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;configuration&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;objectImageField&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;logo&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="result">Result<a href="#result" class="hash-link" aria-label="Direct link to Result" title="Direct link to Result">‚Äã</a></h4>
<p>The object&#x27;s &#x27;@self.image&#x27; field will contain the share URL:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;id&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;</span><span class="token number" style="color:#36acaa">12345</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;title&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;Company A&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;logo&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;id&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">789</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;accessUrl&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//your-domain.com/index.php/s/XyZ789&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;image/png&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;@self&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;name&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;Company A&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;image&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//your-domain.com/index.php/s/XyZ789&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This makes it easy to display company logos, product images, or other visual metadata in listings and search results.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-file-deletion-via-api">4. File Deletion via API<a href="#4-file-deletion-via-api" class="hash-link" aria-label="Direct link to 4. File Deletion via API" title="Direct link to 4. File Deletion via API">‚Äã</a></h3>
<p>Files can be deleted by setting the file property to &#x27;null&#x27; (for single file properties) or an empty array (for array file properties).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="single-file-deletion">Single File Deletion<a href="#single-file-deletion" class="hash-link" aria-label="Direct link to Single File Deletion" title="Direct link to Single File Deletion">‚Äã</a></h4>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT /api/objects/{register}/{schema}/{id}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;title&#x27;: &#x27;Updated Title&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;attachment&#x27;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will:</p>
<ul>
<li>Delete the file from Nextcloud storage</li>
<li>Remove the file record from the database</li>
<li>Set the &#x27;attachment&#x27; property to &#x27;null&#x27; in the object data</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="file-array-deletion">File Array Deletion<a href="#file-array-deletion" class="hash-link" aria-label="Direct link to File Array Deletion" title="Direct link to File Array Deletion">‚Äã</a></h4>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT /api/objects/{register}/{schema}/{id}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;title&#x27;: &#x27;Updated Gallery&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;images&#x27;: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will:</p>
<ul>
<li>Delete all files in the array from Nextcloud storage</li>
<li>Remove all file records from the database</li>
<li>Set the &#x27;images&#x27; property to an empty array in the object data</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases-1">Use Cases<a href="#use-cases-1" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases">‚Äã</a></h4>
<ul>
<li><strong>Privacy Compliance</strong>: Remove sensitive files upon user request</li>
<li><strong>Storage Management</strong>: Clean up unused files</li>
<li><strong>Data Lifecycle</strong>: Remove temporary or expired files</li>
<li><strong>Error Correction</strong>: Remove incorrectly uploaded files</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">‚Äã</a></h2>
<ol>
<li><strong>Define File Types</strong>: Establish clear guidelines for what file types are allowed</li>
<li><strong>Set Size Limits</strong>: Define appropriate size limits for different file types</li>
<li><strong>Use Metadata</strong>: Add relevant metadata to improve searchability and context</li>
<li><strong>Consider Storage</strong>: Choose appropriate storage backends based on file types and access patterns</li>
<li><strong>Implement Retention Policies</strong>: Define how long files should be kept</li>
<li><strong>Plan for Backup</strong>: Ensure files are included in backup strategies</li>
<li><strong>Consider Performance</strong>: Optimize file storage for your access patterns</li>
<li><strong>Use Auto-Publish Wisely</strong>: Only enable property-level &#x27;autoPublish&#x27; for files that should be publicly accessible. Remember: property &#x27;autoPublish&#x27; (file sharing) is different from schema &#x27;autoPublish&#x27; (object publishing)</li>
<li><strong>Document File Deletion</strong>: Maintain audit trails when files are deleted for compliance</li>
<li><strong>Handle Authentication</strong>: Use authenticated URLs for sensitive files</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">‚Äã</a></h2>
<p>Files in Open Register bridge the gap between structured data and unstructured content, providing a comprehensive solution for managing all types of information in your application. With advanced features like auto-sharing, authenticated access, metadata extraction, and flexible deletion options, Open Register creates a unified system where all your data‚Äîstructured and unstructured‚Äîworks together seamlessly.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-architecture">Technical Architecture<a href="#technical-architecture" class="hash-link" aria-label="Direct link to Technical Architecture" title="Direct link to Technical Architecture">‚Äã</a></h2>
<p>This section provides detailed visualization of the file handling system&#x27;s architecture and data flow.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-upload-and-processing-flow">File Upload and Processing Flow<a href="#file-upload-and-processing-flow" class="hash-link" aria-label="Direct link to File Upload and Processing Flow" title="Direct link to File Upload and Processing Flow">‚Äã</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant SaveObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant FileService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Nextcloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant DB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant BgJob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Extractor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Solr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Client-&gt;&gt;API: POST /objects with file data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    API-&gt;&gt;ObjectService: saveObject(data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService-&gt;&gt;SaveObject: handle(data, uploadedFiles)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SaveObject: 1. Detect file properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SaveObject-&gt;&gt;SaveObject: detectFileProperties(schema)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SaveObject: 2. Process file data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SaveObject-&gt;&gt;SaveObject: processFileProperty(fileData)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt Base64 data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SaveObject-&gt;&gt;SaveObject: decodeBase64()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SaveObject-&gt;&gt;SaveObject: fetchFromURL()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else File object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SaveObject-&gt;&gt;SaveObject: validateFileObject()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SaveObject: 3. Create file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SaveObject-&gt;&gt;FileService: createFile(objectEntity, data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileService-&gt;&gt;FileService: determineFolder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileService-&gt;&gt;Nextcloud: createFolder(path)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Nextcloud--&gt;&gt;FileService: Folder created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileService-&gt;&gt;Nextcloud: writeFile(path, content)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Nextcloud--&gt;&gt;FileService: File ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileService-&gt;&gt;FileService: applyAutoTags()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileService-&gt;&gt;FileService: createShareLink()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileService--&gt;&gt;SaveObject: File metadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SaveObject: 4. Update object data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SaveObject-&gt;&gt;SaveObject: replaceFileDataWithIds()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SaveObject-&gt;&gt;DB: INSERT/UPDATE object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DB--&gt;&gt;SaveObject: Object saved</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SaveObject--&gt;&gt;ObjectService: ObjectEntity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService--&gt;&gt;API: Response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    API--&gt;&gt;Client: Object with file IDs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over BgJob: Background Processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Nextcloud-&gt;&gt;BgJob: FileChangeListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BgJob-&gt;&gt;Extractor: extractText(fileId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt LLPhant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Extractor-&gt;&gt;Extractor: extractWithLLPhant()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Dolphin AI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Extractor-&gt;&gt;Extractor: extractWithDolphin()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Extractor--&gt;&gt;BgJob: Extracted text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BgJob-&gt;&gt;DB: Store extracted text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BgJob-&gt;&gt;Solr: Index file chunks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Solr--&gt;&gt;BgJob: Indexed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-property-processing-pipeline">File Property Processing Pipeline<a href="#file-property-processing-pipeline" class="hash-link" aria-label="Direct link to File Property Processing Pipeline" title="Direct link to File Property Processing Pipeline">‚Äã</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Object with File Property] --&gt; B{Property Type}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|type=file| C[Single File]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|type=array items.type=file| D[Multiple Files]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; E{Data Type?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; E</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|Base64 String| F[Decode Base64]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|URL String| G[Fetch from URL]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|File Object| H[Validate File Object]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|File ID| I[Load Existing File]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; J[Validate MIME Type]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; J</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; J</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; J</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; K{Size Check?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt;|Too Large| L[Reject Upload]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt;|OK| M[Create File Entity]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt; N[Determine Folder Path]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt; O[/register/schema/object_uuid/]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; P[Write to Nextcloud]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; Q[Generate Filename]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; R[Apply Auto Tags]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    R --&gt; S{Auto Publish?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S --&gt;|Yes| T[Create Share Link]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S --&gt;|No| U[Skip Sharing]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    T --&gt; V[Store File Metadata]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    U --&gt; V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V --&gt; W[Return File ID]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    W --&gt; X[Update Object Data]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; Y[Return Error]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style J fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style P fill:#ffe1e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style T fill:#fff4e1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="text-extraction-process">Text Extraction Process<a href="#text-extraction-process" class="hash-link" aria-label="Direct link to Text Extraction Process" title="Direct link to Text Extraction Process">‚Äã</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant NC as Nextcloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Listener as FileChangeListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Job as FileTextExtractionJob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Service as FileTextExtractionService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant LLPhant as LLPhant Extractor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Dolphin as Dolphin AI API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant DB as Database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Solr as Solr Index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over NC: File uploaded/modified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NC-&gt;&gt;Listener: post_create / post_update event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Listener-&gt;&gt;Listener: Check extraction scope</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt Scope matches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Listener-&gt;&gt;Job: Queue FileTextExtractionJob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Job--&gt;&gt;Listener: Job queued</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Scope doesn&#x27;t match</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Listener-&gt;&gt;Listener: Skip extraction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over Job: Background job execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Job-&gt;&gt;Service: extractText(fileId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Service-&gt;&gt;Service: Check extraction mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt Mode=background</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service-&gt;&gt;Service: Process immediately</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Mode=immediate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service-&gt;&gt;Service: Process in request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Mode=manual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service-&gt;&gt;Service: Skip until manual trigger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Service-&gt;&gt;DB: Get file info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DB--&gt;&gt;Service: File metadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Service-&gt;&gt;Service: Validate file type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt LLPhant Selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service-&gt;&gt;LLPhant: extract(filePath)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alt Native format (TXT, MD, HTML)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LLPhant-&gt;&gt;LLPhant: Read directly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else PDF/DOCX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LLPhant-&gt;&gt;LLPhant: Use library parser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else Image (JPG, PNG)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LLPhant-&gt;&gt;LLPhant: Not supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LLPhant--&gt;&gt;Service: Extracted text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Dolphin AI Selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service-&gt;&gt;Dolphin: POST /extract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dolphin-&gt;&gt;Dolphin: AI processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alt Document</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Dolphin-&gt;&gt;Dolphin: Text + layout extraction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Dolphin-&gt;&gt;Dolphin: OCR processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dolphin--&gt;&gt;Service: Extracted text + metadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Service-&gt;&gt;Service: Chunk document</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Service-&gt;&gt;DB: Store FileText entity with chunks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DB--&gt;&gt;Service: Stored</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over Service: Chunks stored in DB for reuse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over Service: SOLR indexing is separate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Service-&gt;&gt;DB: Update status=completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DB--&gt;&gt;Service: Success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Service--&gt;&gt;Job: Extraction complete</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-storage-architecture">File Storage Architecture<a href="#file-storage-architecture" class="hash-link" aria-label="Direct link to File Storage Architecture" title="Direct link to File Storage Architecture">‚Äã</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[File Upload] --&gt; B[FileService]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C{Storage Backend?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|Nextcloud| D[Nextcloud Files API]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|S3| E[S3 Compatible Storage]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|Database| F[Direct DB Storage]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; G[Folder Structure]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; H[/openregister/]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; I[/register_id/]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; J[/schema_id/]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; K[/object_uuid/]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; L[file_timestamp.ext]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; M[Bucket Structure]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt; N[openregister/register/schema/object/file]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; O[file_data BLOB]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; P[File Metadata]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt; P</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; P</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; Q[(File Registry)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; R[file_id]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; S[file_path]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; T[share_link]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; U[checksum]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; V[tags]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style B fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style Q fill:#ffe1e1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-type-compatibility-matrix">File Type Compatibility Matrix<a href="#file-type-compatibility-matrix" class="hash-link" aria-label="Direct link to File Type Compatibility Matrix" title="Direct link to File Type Compatibility Matrix">‚Äã</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[File Type] --&gt; B{Extraction Engine}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|LLPhant| C[LLPhant Support]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|Dolphin AI| D[Dolphin Support]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; E[Native: TXT, MD, HTML, JSON, XML, CSV]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; F[Library: PDF, DOCX, DOC, XLSX, XLS]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; G[Limited: PPTX, ODT, RTF]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; H[Not Supported: Images JPG, PNG, GIF, WebP]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; I[Full Support: All Documents]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; J[OCR: Images JPG, PNG, GIF, WebP]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; K[Advanced: Tables, Formulas]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; L[Multi-language OCR]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; M[‚úÖ Instant]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; N[‚úÖ 2-10s]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; O[‚ö†Ô∏è May Fail]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; P[‚ùå No Support]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; Q[‚úÖ 3-15s]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; R[‚úÖ 5-20s OCR]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; S[‚úÖ Superior Quality]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; T[‚úÖ 100+ Languages]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style C fill:#fff4e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style D fill:#e1ffe1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-text-extraction-settings">File Text Extraction Settings<a href="#file-text-extraction-settings" class="hash-link" aria-label="Direct link to File Text Extraction Settings" title="Direct link to File Text Extraction Settings">‚Äã</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph LR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Settings] --&gt; B{Extraction Engine}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|llphant| C[LLPhant Extractor]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|dolphin| D[Dolphin AI API]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A --&gt; E{Extraction Scope}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|none| F[Disabled]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|all| G[All Files]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|folders| H[Specific Folders]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt;|objects| I[Object Files Only]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A --&gt; J{Extraction Mode}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|background| K[Async Processing]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|immediate| L[Sync Processing]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|manual| M[Manual Trigger]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; N{File Type}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt;|Supported| O[Extract Text]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt;|Unsupported| P[Skip Extraction]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; Q[Store in FileText]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; R[Index in Solr]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style B fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style E fill:#fff4e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style J fill:#ffe1e1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-chunking-for-solr">File Chunking for Solr<a href="#file-chunking-for-solr" class="hash-link" aria-label="Direct link to File Chunking for Solr" title="Direct link to File Chunking for Solr">‚Äã</a></h3>
<p><strong>Note</strong>: As of v0.2.7, chunking happens during text extraction, not during SOLR indexing. Chunks are stored in the database and reused.</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Text Extraction] --&gt; B[Chunk Document]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C{Chunking Strategy}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|Recursive Character| D[Smart splitting by paragraphs/sentences]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|Fixed Size| E[1000 chars per chunk + 200 overlap]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; F[Create Chunks]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; G[Store in Database]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; H[chunks_json column]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; I[Chunk 1: 0-1000]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; J[Chunk 2: 900-1900]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; K[Chunk 3: 1800-2800]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; L[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subgraph SOLR_Indexing[SOLR Indexing - Reads Pre-Chunked Data]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        M[Read chunks_json from DB]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        M --&gt; N[Parse JSON chunks]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        N --&gt; O[Solr Documents]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; P[Index Fields]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; Q[file_id]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; R[chunk_index]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; S[chunk_text]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; T[chunk_start_offset]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; U[chunk_end_offset]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; V[(Solr Index)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    R --&gt; V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S --&gt; V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    T --&gt; V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    U --&gt; V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style G fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style H fill:#ffe1e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style V fill:#e1ffe1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-characteristics">Performance Characteristics<a href="#performance-characteristics" class="hash-link" aria-label="Direct link to Performance Characteristics" title="Direct link to Performance Characteristics">‚Äã</a></h3>
<p><strong>File Upload Performance:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Small files (&lt;1MB):      ~100-200ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Medium files (1-10MB):   ~500ms-2s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Large files (&gt;10MB):     ~2-10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Very large (&gt;100MB):     ~10-60s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Text Extraction Performance:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">LLPhant:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- TXT/MD/HTML:    &lt;1s    (instant)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- PDF (10 pages): 2-5s   (library parsing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- DOCX:           3-8s   (library parsing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Images:         N/A    (not supported)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dolphin AI:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- TXT/MD/HTML:    1-2s   (API latency)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- PDF (10 pages): 5-10s  (AI processing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- DOCX:           4-8s   (AI processing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Images (OCR):   5-15s  (OCR + AI)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Chunking and Indexing:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Text chunking:     &lt;100ms  for 100KB text (now part of extraction)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Solr indexing:     ~50-200ms per document (reads pre-chunked data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch indexing:    ~500ms for 100 chunks (faster with pre-chunked data)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note</strong>: Since v0.2.7, chunking is performed once during text extraction and stored in the database. This makes SOLR indexing faster and allows chunks to be reused for vector embeddings, AI processing, or any other service that needs chunked text.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-examples">Code Examples<a href="#code-examples" class="hash-link" aria-label="Direct link to Code Examples" title="Direct link to Code Examples">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="processing-file-upload">Processing File Upload<a href="#processing-file-upload" class="hash-link" aria-label="Direct link to Processing File Upload" title="Direct link to Processing File Upload">‚Äã</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use OCA\OpenRegister\Service\FileService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create file from base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$fileMetadata = $fileService-&gt;createFile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectEntity: $object,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fileData: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;content&#x27; =&gt; &#x27;data:image/jpeg;base64,/9j/4AAQ...&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;tags&#x27; =&gt; [&#x27;profile&#x27;, &#x27;avatar&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create file from URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$fileMetadata = $fileService-&gt;createFile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectEntity: $object,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fileData: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;url&#x27; =&gt; &#x27;https://example.com/document.pdf&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;tags&#x27; =&gt; [&#x27;imported&#x27;, &#x27;external&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Access file metadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$fileId = $fileMetadata[&#x27;id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$shareLinkUrl = $fileMetadata[&#x27;accessUrl&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$downloadUrl = $fileMetadata[&#x27;downloadUrl&#x27;];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="text-extraction">Text Extraction<a href="#text-extraction" class="hash-link" aria-label="Direct link to Text Extraction" title="Direct link to Text Extraction">‚Äã</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use OCA\OpenRegister\Service\FileTextExtractionService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Extract text from file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$extractionService-&gt;extractText($fileId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get extraction status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$fileText = $fileTextMapper-&gt;findByFileId($fileId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status = $fileText-&gt;getExtractionStatus(); // &#x27;pending&#x27;, &#x27;processing&#x27;, &#x27;completed&#x27;, &#x27;failed&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$text = $fileText-&gt;getTextContent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Manually trigger extraction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$extractionService-&gt;queueExtraction($fileId);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="searching-file-content">Searching File Content<a href="#searching-file-content" class="hash-link" aria-label="Direct link to Searching File Content" title="Direct link to Searching File Content">‚Äã</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Search across file content in Solr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$results = $solrService-&gt;searchFiles([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_search&#x27; =&gt; &#x27;contract terms&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;mime_type&#x27; =&gt; &#x27;application/pdf&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_limit&#x27; =&gt; 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Access chunk results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($results[&#x27;hits&#x27;] as $hit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $fileId = $hit[&#x27;file_id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $chunkIndex = $hit[&#x27;chunk_index&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $text = $hit[&#x27;chunk_text&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $highlighted = $hit[&#x27;highlighted_text&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Run file handling tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit tests/Service/FileServiceTest.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Test text extraction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit tests/Service/FileTextExtractionServiceTest.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Test specific scenarios</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit --filter testBase64FileUpload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit --filter testTextExtraction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit --filter testFileChunking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Integration tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit tests/Integration/FileIntegrationTest.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Test Coverage:</strong></p>
<ul>
<li>File upload (base64, URL, file object)</li>
<li>File property processing</li>
<li>Text extraction (LLPhant, Dolphin)</li>
<li>Chunking and Solr indexing</li>
<li>File deletion</li>
<li>Share link generation</li>
<li>Auto-tagging</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/conductionnl/openregister/tree/main/website/docs/Features/files.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Features/events"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Core Features</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Features/access-control"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Acces Control</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-are-files-in-open-register" class="table-of-contents__link toc-highlight">What are Files in Open Register?</a></li><li><a href="#attaching-files-to-objects" class="table-of-contents__link toc-highlight">Attaching Files to Objects</a></li><li><a href="#file-metadata-and-tagging" class="table-of-contents__link toc-highlight">File Metadata and Tagging</a><ul><li><a href="#tagging-system" class="table-of-contents__link toc-highlight">Tagging System</a></li></ul></li><li><a href="#version-control" class="table-of-contents__link toc-highlight">Version Control</a></li><li><a href="#security-and-access-control" class="table-of-contents__link toc-highlight">Security and Access Control</a></li><li><a href="#file-operations" class="table-of-contents__link toc-highlight">File Operations</a></li><li><a href="#file-preview-and-rendering" class="table-of-contents__link toc-highlight">File Preview and Rendering</a></li><li><a href="#integration-with-object-lifecycle" class="table-of-contents__link toc-highlight">Integration with Object Lifecycle</a></li><li><a href="#technical-implementation" class="table-of-contents__link toc-highlight">Technical Implementation</a></li><li><a href="#file-structure" class="table-of-contents__link toc-highlight">File Structure</a></li><li><a href="#how-files-are-stored" class="table-of-contents__link toc-highlight">How Files are Stored</a><ul><li><a href="#1-nextcloud-storage" class="table-of-contents__link toc-highlight">1. Nextcloud Storage</a></li><li><a href="#2-external-storage" class="table-of-contents__link toc-highlight">2. External Storage</a></li><li><a href="#3-database-storage" class="table-of-contents__link toc-highlight">3. Database Storage</a></li></ul></li><li><a href="#file-features" class="table-of-contents__link toc-highlight">File Features</a><ul><li><a href="#1-versioning" class="table-of-contents__link toc-highlight">1. Versioning</a></li><li><a href="#2-access-control" class="table-of-contents__link toc-highlight">2. Access Control</a></li><li><a href="#3-metadata" class="table-of-contents__link toc-highlight">3. Metadata</a></li><li><a href="#4-preview-generation" class="table-of-contents__link toc-highlight">4. Preview Generation</a></li><li><a href="#5-content-extraction" class="table-of-contents__link toc-highlight">5. Content Extraction</a></li><li><a href="#technical-implementation-1" class="table-of-contents__link toc-highlight">Technical Implementation</a></li></ul></li><li><a href="#files-management-page" class="table-of-contents__link toc-highlight">Files Management Page</a></li><li><a href="#working-with-files" class="table-of-contents__link toc-highlight">Working with Files</a><ul><li><a href="#uploading-files" class="table-of-contents__link toc-highlight">Uploading Files</a></li><li><a href="#retrieving-files" class="table-of-contents__link toc-highlight">Retrieving Files</a></li><li><a href="#listing-files-for-an-object" class="table-of-contents__link toc-highlight">Listing Files for an Object</a></li><li><a href="#updating-files" class="table-of-contents__link toc-highlight">Updating Files</a></li><li><a href="#deleting-files" class="table-of-contents__link toc-highlight">Deleting Files</a></li></ul></li><li><a href="#file-relationships" class="table-of-contents__link toc-highlight">File Relationships</a><ul><li><a href="#files-and-objects" class="table-of-contents__link toc-highlight">Files and Objects</a></li><li><a href="#files-and-schemas" class="table-of-contents__link toc-highlight">Files and Schemas</a></li><li><a href="#files-and-registers" class="table-of-contents__link toc-highlight">Files and Registers</a></li></ul></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a><ul><li><a href="#1-document-management" class="table-of-contents__link toc-highlight">1. Document Management</a></li><li><a href="#2-media-management" class="table-of-contents__link toc-highlight">2. Media Management</a></li><li><a href="#3-evidence-collection" class="table-of-contents__link toc-highlight">3. Evidence Collection</a></li><li><a href="#4-technical-documentation" class="table-of-contents__link toc-highlight">4. Technical Documentation</a></li></ul></li><li><a href="#advanced-file-features" class="table-of-contents__link toc-highlight">Advanced File Features</a><ul><li><a href="#1-auto-share-configuration" class="table-of-contents__link toc-highlight">1. Auto-Share Configuration</a></li><li><a href="#2-authenticated-file-access" class="table-of-contents__link toc-highlight">2. Authenticated File Access</a></li><li><a href="#3-logoimage-metadata-from-file-properties" class="table-of-contents__link toc-highlight">3. Logo/Image Metadata from File Properties</a></li><li><a href="#4-file-deletion-via-api" class="table-of-contents__link toc-highlight">4. File Deletion via API</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#technical-architecture" class="table-of-contents__link toc-highlight">Technical Architecture</a><ul><li><a href="#file-upload-and-processing-flow" class="table-of-contents__link toc-highlight">File Upload and Processing Flow</a></li><li><a href="#file-property-processing-pipeline" class="table-of-contents__link toc-highlight">File Property Processing Pipeline</a></li><li><a href="#text-extraction-process" class="table-of-contents__link toc-highlight">Text Extraction Process</a></li><li><a href="#file-storage-architecture" class="table-of-contents__link toc-highlight">File Storage Architecture</a></li><li><a href="#file-type-compatibility-matrix" class="table-of-contents__link toc-highlight">File Type Compatibility Matrix</a></li><li><a href="#file-text-extraction-settings" class="table-of-contents__link toc-highlight">File Text Extraction Settings</a></li><li><a href="#file-chunking-for-solr" class="table-of-contents__link toc-highlight">File Chunking for Solr</a></li><li><a href="#performance-characteristics" class="table-of-contents__link toc-highlight">Performance Characteristics</a></li><li><a href="#code-examples" class="table-of-contents__link toc-highlight">Code Examples</a></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/conductionnl/openregister" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 for <a href="https://openwebconcept.nl">Open Webconcept</a> by <a href="https://conduction.nl">Conduction B.V.</a></div></div></div></footer></div>
</body>
</html>