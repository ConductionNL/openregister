<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Features/faceting" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Comprehensive Faceting System | Open Register</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://openregisters.app/docs/Features/faceting"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Comprehensive Faceting System | Open Register"><meta data-rh="true" name="description" content="This document describes the new Elasticsearch-inspired faceting system implemented for the OpenRegister application. The system provides powerful, flexible faceting capabilities that support both metadata and object field facets with enumerated values and range buckets."><meta data-rh="true" property="og:description" content="This document describes the new Elasticsearch-inspired faceting system implemented for the OpenRegister application. The system provides powerful, flexible faceting capabilities that support both metadata and object field facets with enumerated values and range buckets."><link data-rh="true" rel="canonical" href="https://openregisters.app/docs/Features/faceting"><link data-rh="true" rel="alternate" href="https://openregisters.app/docs/Features/faceting" hreflang="en"><link data-rh="true" rel="alternate" href="https://openregisters.app/docs/Features/faceting" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3a202f4d.css">
<script src="/assets/js/runtime~main.7c9b7be8.js" defer="defer"></script>
<script src="/assets/js/main.8e6b3835.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Open Register Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Open Register Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Open Register</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Integrations">Documentation</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/api">API Documentation</a><a href="https://github.com/conductionnl/openregister" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Integrations">Integrations Overview</a><button aria-label="Expand sidebar category &#x27;Integrations Overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Development/Services">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/Features">Core Features</a><button aria-label="Collapse sidebar category &#x27;Core Features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/registers">Register</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/schemas">Schemas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/objects">Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/sources">Sources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/ai">AI Chat Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/search">Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/events">Core Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/files">Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/access-control">Acces Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/enhanced-validation-errors">Enhanced Validation Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/organisations">Organisations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/applications">Applications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/documentation-system">Documentation System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/archiving-and-metadata-feature-summary">Archiving &amp; Metadata Feature Summary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/configurations">Configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Features/faceting">Comprehensive Faceting System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/multi-tenancy">Multi-Tenancy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Features/webhooks">Webhooks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Technical/vectorization-architecture">Technical</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/UseCases/clientRegisters">UseCases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/api/bulk-operations">api</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/developers/external-app-optimization">developers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/development/deeplinking-spot">development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/features/ai">features</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/technical/vector-search-backends">technical</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user/ai-conversations">user</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user-guide/configuration/api-tokens">user-guide</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Features"><span itemprop="name">Core Features</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Comprehensive Faceting System</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Comprehensive Faceting System</h1></header>
<p>This document describes the new Elasticsearch-inspired faceting system implemented for the OpenRegister application. The system provides powerful, flexible faceting capabilities that support both metadata and object field facets with enumerated values and range buckets.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>The faceting system provides a modern, user-friendly approach to building faceted search interfaces. It supports:</p>
<ul>
<li><strong>Disjunctive faceting</strong> - Facet options don&#x27;t disappear when selected</li>
<li><strong>Multiple facet types</strong> - Terms, date histograms, and numeric ranges</li>
<li><strong>Metadata and object field facets</strong> - Both table columns and JSON data</li>
<li><strong>Facetable field discovery</strong> - Automatic detection of available faceting options</li>
<li><strong>Elasticsearch-style API</strong> - Familiar structure for developers</li>
<li><strong>Performance optimization</strong> - Efficient database queries with proper indexing</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-features">Key Features<a href="#key-features" class="hash-link" aria-label="Direct link to Key Features" title="Direct link to Key Features">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-disjunctive-faceting">1. Disjunctive Faceting<a href="#1-disjunctive-faceting" class="hash-link" aria-label="Direct link to 1. Disjunctive Faceting" title="Direct link to 1. Disjunctive Faceting">​</a></h3>
<p>Each facet shows counts as if its own filter were not applied. This prevents facet options from disappearing when selected, providing a better user experience.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-multiple-facet-types">2. Multiple Facet Types<a href="#2-multiple-facet-types" class="hash-link" aria-label="Direct link to 2. Multiple Facet Types" title="Direct link to 2. Multiple Facet Types">​</a></h3>
<ul>
<li><strong>Terms aggregation</strong> - For categorical data (status, priority, etc.)</li>
<li><strong>Date histogram</strong> - For time-based data with configurable intervals</li>
<li><strong>Range aggregation</strong> - For numeric data with custom buckets</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-dual-data-sources">3. Dual Data Sources<a href="#3-dual-data-sources" class="hash-link" aria-label="Direct link to 3. Dual Data Sources" title="Direct link to 3. Dual Data Sources">​</a></h3>
<ul>
<li><strong>Metadata facets</strong> - Based on ObjectEntity table columns (@self)</li>
<li><strong>Object field facets</strong> - Based on JSON object data</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-enhanced-labels-with-caching">4. Enhanced Labels with Caching<a href="#4-enhanced-labels-with-caching" class="hash-link" aria-label="Direct link to 4. Enhanced Labels with Caching" title="Direct link to 4. Enhanced Labels with Caching">​</a></h3>
<p>Automatic resolution of register, schema, organisation IDs, and object UUIDs to human-readable names using an optimized caching mechanism. The system intelligently detects UUIDs in any facet and resolves them to object names (naam, name, title, etc.) using batch loading and multi-tier caching. Facet buckets are automatically sorted alphabetically by label for consistent, user-friendly display.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="uuid-resolution-technical-implementation">UUID Resolution Technical Implementation<a href="#uuid-resolution-technical-implementation" class="hash-link" aria-label="Direct link to UUID Resolution Technical Implementation" title="Direct link to UUID Resolution Technical Implementation">​</a></h4>
<p>The faceting system includes intelligent UUID-to-name resolution that works automatically:</p>
<p><strong>Resolution Process:</strong></p>
<ol>
<li><strong>UUID Detection</strong> - Identifies bucket values containing hyphens (UUID format)</li>
<li><strong>Lazy Service Loading</strong> - ObjectCacheService loaded from container only when needed</li>
<li><strong>Batch Resolution</strong> - All UUIDs in facets resolved in a single database query</li>
<li><strong>Multi-Tier Caching</strong> - Checks in-memory cache → distributed cache → database</li>
<li><strong>Name Extraction</strong> - Searches common name fields (naam, name, title, contractNummer, achternaam)</li>
<li><strong>Alphabetical Sorting</strong> - Facets sorted by resolved labels (case-insensitive A-Z)</li>
<li><strong>Graceful Fallback</strong> - Uses UUID if name cannot be resolved</li>
</ol>
<p><strong>Example Transformation:</strong></p>
<p>Before UUID resolution:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;value&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;01c26b42-e047</span><span class="token number" style="color:#36acaa">-4322</span><span class="token plain">-95ba-46d53a1696c0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;count&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;label&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;01c26b42-e047</span><span class="token number" style="color:#36acaa">-4322</span><span class="token plain">-95ba-46d53a1696c0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After UUID resolution:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;value&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;01c26b42-e047</span><span class="token number" style="color:#36acaa">-4322</span><span class="token plain">-95ba-46d53a1696c0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;count&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;label&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &#x27;Component Name Here&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Performance Characteristics:</strong></p>
<ul>
<li><strong>Batch queries</strong>: All UUIDs resolved in one DB query (no N+1 problem)</li>
<li><strong>Cached</strong>: &lt;10ms for cached names</li>
<li><strong>Uncached</strong>: &lt;100ms for 100 UUIDs (batch DB query)</li>
<li><strong>Lazy loading</strong>: Service only loaded when facets contain UUIDs</li>
</ul>
<p><strong>Service Integration:</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Lazy-loading pattern to avoid circular dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private function getObjectCacheService(): ?ObjectCacheService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($this-&gt;objectCacheServiceAttempted) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return $this-&gt;objectCacheService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $this-&gt;objectCacheServiceAttempted = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;objectCacheService = \OC::$server-&gt;get(ObjectCacheService::class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;logger-&gt;debug(&#x27;ObjectCacheService loaded successfully&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (\Exception $e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;logger-&gt;warning(&#x27;ObjectCacheService not available for UUID resolution&#x27;, [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;error&#x27; =&gt; $e-&gt;getMessage()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $this-&gt;objectCacheService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This ensures the service is only loaded when facets containing UUIDs are encountered, avoiding performance overhead for regular facets.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-facetable-field-discovery">5. Facetable Field Discovery<a href="#5-facetable-field-discovery" class="hash-link" aria-label="Direct link to 5. Facetable Field Discovery" title="Direct link to 5. Facetable Field Discovery">​</a></h3>
<p>Automatic analysis of available fields and their characteristics to help frontends build dynamic facet interfaces.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="facetable-field-discovery">Facetable Field Discovery<a href="#facetable-field-discovery" class="hash-link" aria-label="Direct link to Facetable Field Discovery" title="Direct link to Facetable Field Discovery">​</a></h2>
<p>The system includes powerful discovery capabilities that analyze your data to determine which fields can be used for faceting and what types of facets are appropriate.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="discovery-api">Discovery API<a href="#discovery-api" class="hash-link" aria-label="Direct link to Discovery API" title="Direct link to Discovery API">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Get facetable fields for a specific context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facetableFields = $objectService-&gt;getFacetableFields($baseQuery, $sampleSize);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Example with context filters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$baseQuery = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; 1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_search&#x27; =&gt; &#x27;customer&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facetableFields = $objectService-&gt;getFacetableFields($baseQuery, 100);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="discovery-response-structure">Discovery Response Structure<a href="#discovery-response-structure" class="hash-link" aria-label="Direct link to Discovery Response Structure" title="Direct link to Discovery Response Structure">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;register&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;categorical&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;description&#x27; =&gt; &#x27;Register that contains the object&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;facet_types&#x27; =&gt; [&#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;has_labels&#x27; =&gt; true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sample_values&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;value&#x27; =&gt; 1, &#x27;label&#x27; =&gt; &#x27;Publications Register&#x27;, &#x27;count&#x27; =&gt; 150],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;value&#x27; =&gt; 2, &#x27;label&#x27; =&gt; &#x27;Events Register&#x27;, &#x27;count&#x27; =&gt; 75]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;created&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;date&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;description&#x27; =&gt; &#x27;Date and time when the object was created&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;facet_types&#x27; =&gt; [&#x27;date_histogram&#x27;, &#x27;range&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;intervals&#x27; =&gt; [&#x27;day&#x27;, &#x27;week&#x27;, &#x27;month&#x27;, &#x27;year&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;has_labels&#x27; =&gt; false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;date_range&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;min&#x27; =&gt; &#x27;2023-01-01 00:00:00&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;max&#x27; =&gt; &#x27;2024-12-31 23:59:59&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;object_fields&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;status&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;string&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;description&#x27; =&gt; &#x27;Object field: status&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;facet_types&#x27; =&gt; [&#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;cardinality&#x27; =&gt; &#x27;low&#x27;,  // ≤50 unique values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sample_values&#x27; =&gt; [&#x27;published&#x27;, &#x27;draft&#x27;, &#x27;archived&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;appearance_rate&#x27; =&gt; 85  // Count of objects containing this field</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;priority&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;integer&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;description&#x27; =&gt; &#x27;Object field: priority&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;facet_types&#x27; =&gt; [&#x27;range&#x27;, &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;cardinality&#x27; =&gt; &#x27;numeric&#x27;,  // Numeric field type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sample_values&#x27; =&gt; [&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;appearance_rate&#x27; =&gt; 72  // Count of objects containing this field</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="field-properties-explained">Field Properties Explained<a href="#field-properties-explained" class="hash-link" aria-label="Direct link to Field Properties Explained" title="Direct link to Field Properties Explained">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-terms">Key Terms<a href="#key-terms" class="hash-link" aria-label="Direct link to Key Terms" title="Direct link to Key Terms">​</a></h4>
<p><strong><code>appearance_rate</code></strong>: The actual count of objects (from the analyzed sample) that contain this field. For example, if 100 objects were analyzed and 85 contained the &#x27;status&#x27; field, the appearance_rate would be 85. This is not a percentage but an absolute count.</p>
<p><strong><code>cardinality</code></strong>: Indicates the uniqueness characteristics of field values:</p>
<ul>
<li><code>&#x27;low&#x27;</code> - String fields with ≤50 unique values (suitable for terms facets)</li>
<li><code>&#x27;numeric&#x27;</code> - Integer, float, or numeric string fields</li>
<li><code>&#x27;binary&#x27;</code> - Boolean fields (true/false values only)</li>
<li>Not set for date fields (they use intervals instead)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="field-types-and-characteristics">Field Types and Characteristics<a href="#field-types-and-characteristics" class="hash-link" aria-label="Direct link to Field Types and Characteristics" title="Direct link to Field Types and Characteristics">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-fields-self">Metadata Fields (@self)<a href="#metadata-fields-self" class="hash-link" aria-label="Direct link to Metadata Fields (@self)" title="Direct link to Metadata Fields (@self)">​</a></h4>
<p>Predefined fields from the ObjectEntity table:</p>
<ul>
<li><strong>register</strong> - Categorical with labels from register table</li>
<li><strong>schema</strong> - Categorical with labels from schema table</li>
<li><strong>uuid</strong> - Identifier field (usually not suitable for faceting)</li>
<li><strong>owner</strong> - Categorical user field</li>
<li><strong>organisation</strong> - Categorical organisation field</li>
<li><strong>application</strong> - Categorical application field</li>
<li><strong>created/updated/published/depublished</strong> - Date fields with range support</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="object-fields">Object Fields<a href="#object-fields" class="hash-link" aria-label="Direct link to Object Fields" title="Direct link to Object Fields">​</a></h4>
<p>Dynamically discovered from JSON object data:</p>
<ul>
<li><strong>string</strong> - Text fields (low cardinality suitable for terms facets)</li>
<li><strong>integer/float</strong> - Numeric fields (suitable for range and terms facets)</li>
<li><strong>date</strong> - Date fields (suitable for date_histogram and range facets)</li>
<li><strong>boolean</strong> - Binary fields (suitable for terms facets)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="discovery-configuration">Discovery Configuration<a href="#discovery-configuration" class="hash-link" aria-label="Direct link to Discovery Configuration" title="Direct link to Discovery Configuration">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="field-analysis-parameters">Field Analysis Parameters<a href="#field-analysis-parameters" class="hash-link" aria-label="Direct link to Field Analysis Parameters" title="Direct link to Field Analysis Parameters">​</a></h4>
<ul>
<li><strong>Sample Size</strong> - Number of objects to analyze (default: 100)</li>
<li><strong>Appearance Threshold</strong> - Minimum percentage of objects that must contain the field (default: 10%)</li>
<li><strong>Cardinality Threshold</strong> - Maximum unique values for terms facets (default: 50)</li>
<li><strong>Recursion Depth</strong> - Maximum nesting level to analyze (default: 2)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="field-filtering">Field Filtering<a href="#field-filtering" class="hash-link" aria-label="Direct link to Field Filtering" title="Direct link to Field Filtering">​</a></h4>
<p>The discovery system automatically filters out:</p>
<ul>
<li>System fields (starting with @ or _)</li>
<li>Nested objects and arrays of objects</li>
<li>High cardinality string fields (more than 50 unique values)</li>
<li>Fields appearing in less than 10% of objects</li>
<li>Fields with inconsistent types (less than 70% type consistency)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-integration">API Integration<a href="#api-integration" class="hash-link" aria-label="Direct link to API Integration" title="Direct link to API Integration">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="discovery-parameter">Discovery Parameter<a href="#discovery-parameter" class="hash-link" aria-label="Direct link to Discovery Parameter" title="Direct link to Discovery Parameter">​</a></h4>
<p>Add <code>_facetable=true</code> to any search endpoint to include facetable field information:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/objects?_facetable=true&amp;limit=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Response includes additional <code>facetable</code> property:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;results&#x27; =&gt; [],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;total&#x27; =&gt; 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;facetable&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [...],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;object_fields&#x27; =&gt; [...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-facet-configuration">Dynamic Facet Configuration<a href="#dynamic-facet-configuration" class="hash-link" aria-label="Direct link to Dynamic Facet Configuration" title="Direct link to Dynamic Facet Configuration">​</a></h4>
<p>Use discovery results to build facet configurations:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Frontend example: Build facet config from discovery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">buildFacetConfig</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">facetableFields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">_facets</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">&#x27;@self&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Add metadata facets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facetableFields</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">field</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> info</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facet_types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_facets</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facet_types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;date_histogram&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_facets</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;date_histogram&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;month&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Add object field facets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facetableFields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">object_fields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">field</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> info</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facet_types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_facets</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facet_types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;range&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_facets</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;range&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">ranges</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateRanges</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sample_values</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-structure">API Structure<a href="#api-structure" class="hash-link" aria-label="Direct link to API Structure" title="Direct link to API Structure">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-query-structure">Basic Query Structure<a href="#basic-query-structure" class="hash-link" aria-label="Direct link to Basic Query Structure" title="Direct link to Basic Query Structure">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Search filters (same as searchObjects)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;register&#x27; =&gt; 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;schema&#x27; =&gt; 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;status&#x27; =&gt; &#x27;active&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_search&#x27; =&gt; &#x27;customer&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Facet configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Metadata facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;register&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;schema&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;created&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;type&#x27; =&gt; &#x27;date_histogram&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;interval&#x27; =&gt; &#x27;month&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Object field facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;priority&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;price&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;range&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;ranges&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;to&#x27; =&gt; 100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;from&#x27; =&gt; 100, &#x27;to&#x27; =&gt; 500],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;from&#x27; =&gt; 500]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $objectService-&gt;getFacetsForObjects($query);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="response-structure">Response Structure<a href="#response-structure" class="hash-link" aria-label="Direct link to Response Structure" title="Direct link to Response Structure">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;register&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;type&#x27; =&gt; &#x27;terms&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;buckets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    [&#x27;key&#x27; =&gt; 1, &#x27;doc_count&#x27; =&gt; 150, &#x27;label&#x27; =&gt; &#x27;Register Name&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    [&#x27;key&#x27; =&gt; 2, &#x27;doc_count&#x27; =&gt; 75, &#x27;label&#x27; =&gt; &#x27;Other Register&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;created&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;type&#x27; =&gt; &#x27;date_histogram&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;interval&#x27; =&gt; &#x27;month&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;buckets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    [&#x27;key&#x27; =&gt; &#x27;2024-01&#x27;, &#x27;doc_count&#x27; =&gt; 45],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    [&#x27;key&#x27; =&gt; &#x27;2024-02&#x27;, &#x27;doc_count&#x27; =&gt; 67]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;status&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;terms&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;buckets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;key&#x27; =&gt; &#x27;active&#x27;, &#x27;doc_count&#x27; =&gt; 134],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;key&#x27; =&gt; &#x27;inactive&#x27;, &#x27;doc_count&#x27; =&gt; 45]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;price&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;range&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;buckets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;key&#x27; =&gt; &#x27;0-100&#x27;, &#x27;from&#x27; =&gt; 0, &#x27;to&#x27; =&gt; 100, &#x27;doc_count&#x27; =&gt; 120],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;key&#x27; =&gt; &#x27;100-500&#x27;, &#x27;from&#x27; =&gt; 100, &#x27;to&#x27; =&gt; 500, &#x27;doc_count&#x27; =&gt; 80],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;key&#x27; =&gt; &#x27;500+&#x27;, &#x27;from&#x27; =&gt; 500, &#x27;doc_count&#x27; =&gt; 15]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="facet-types">Facet Types<a href="#facet-types" class="hash-link" aria-label="Direct link to Facet Types" title="Direct link to Facet Types">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-terms-aggregation">1. Terms Aggregation<a href="#1-terms-aggregation" class="hash-link" aria-label="Direct link to 1. Terms Aggregation" title="Direct link to 1. Terms Aggregation">​</a></h3>
<p>For categorical data like status, priority, category, etc.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;priority&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;register&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;schema&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Response:</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;status&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27; =&gt; &#x27;terms&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;buckets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;active&#x27;, &#x27;doc_count&#x27; =&gt; 134],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;pending&#x27;, &#x27;doc_count&#x27; =&gt; 45],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;inactive&#x27;, &#x27;doc_count&#x27; =&gt; 23]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-date-histogram">2. Date Histogram<a href="#2-date-histogram" class="hash-link" aria-label="Direct link to 2. Date Histogram" title="Direct link to 2. Date Histogram">​</a></h3>
<p>For time-based data with configurable intervals.</p>
<p><strong>Supported intervals:</strong> <code>day</code>, <code>week</code>, <code>month</code>, <code>year</code></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;event_date&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;type&#x27; =&gt; &#x27;date_histogram&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;interval&#x27; =&gt; &#x27;month&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;created&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;date_histogram&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;interval&#x27; =&gt; &#x27;week&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Response:</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;event_date&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27; =&gt; &#x27;date_histogram&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;interval&#x27; =&gt; &#x27;month&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;buckets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;2024-01&#x27;, &#x27;doc_count&#x27; =&gt; 45],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;2024-02&#x27;, &#x27;doc_count&#x27; =&gt; 67],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;2024-03&#x27;, &#x27;doc_count&#x27; =&gt; 52]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-range-aggregation">3. Range Aggregation<a href="#3-range-aggregation" class="hash-link" aria-label="Direct link to 3. Range Aggregation" title="Direct link to 3. Range Aggregation">​</a></h3>
<p>For numeric data with custom buckets.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;price&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;type&#x27; =&gt; &#x27;range&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;ranges&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&#x27;to&#x27; =&gt; 100],                    // 0-100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&#x27;from&#x27; =&gt; 100, &#x27;to&#x27; =&gt; 500],     // 100-500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&#x27;from&#x27; =&gt; 500, &#x27;to&#x27; =&gt; 1000],    // 500-1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&#x27;from&#x27; =&gt; 1000]                  // 1000+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Response:</strong></p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;price&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27; =&gt; &#x27;range&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;buckets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;0-100&#x27;, &#x27;to&#x27; =&gt; 100, &#x27;doc_count&#x27; =&gt; 120],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;100-500&#x27;, &#x27;from&#x27; =&gt; 100, &#x27;to&#x27; =&gt; 500, &#x27;doc_count&#x27; =&gt; 80],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;500-1000&#x27;, &#x27;from&#x27; =&gt; 500, &#x27;to&#x27; =&gt; 1000, &#x27;doc_count&#x27; =&gt; 35],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [&#x27;key&#x27; =&gt; &#x27;1000+&#x27;, &#x27;from&#x27; =&gt; 1000, &#x27;doc_count&#x27; =&gt; 15]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-examples">Usage Examples<a href="#usage-examples" class="hash-link" aria-label="Direct link to Usage Examples" title="Direct link to Usage Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumerated-facets">Basic Enumerated Facets<a href="#basic-enumerated-facets" class="hash-link" aria-label="Direct link to Basic Enumerated Facets" title="Direct link to Basic Enumerated Facets">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; 1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;status&#x27; =&gt; &#x27;active&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;register&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;schema&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;priority&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $objectService-&gt;getFacetsForObjects($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Use facet data for UI checkboxes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($facets[&#x27;facets&#x27;][&#x27;status&#x27;][&#x27;buckets&#x27;] as $bucket) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $selected = ($bucket[&#x27;key&#x27;] === &#x27;active&#x27;) ? &#x27;checked&#x27; : &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;&lt;input type=&#x27;checkbox&#x27; {$selected}&gt; {$bucket[&#x27;key&#x27;]} ({$bucket[&#x27;doc_count&#x27;]})\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="date-timeline-facets">Date Timeline Facets<a href="#date-timeline-facets" class="hash-link" aria-label="Direct link to Date Timeline Facets" title="Direct link to Date Timeline Facets">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;created&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;type&#x27; =&gt; &#x27;date_histogram&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;interval&#x27; =&gt; &#x27;month&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $objectService-&gt;getFacetsForObjects($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Use for timeline visualization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($facets[&#x27;facets&#x27;][&#x27;@self&#x27;][&#x27;created&#x27;][&#x27;buckets&#x27;] as $bucket) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;{$bucket[&#x27;key&#x27;]}: {$bucket[&#x27;doc_count&#x27;]} objects\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="price-range-facets">Price Range Facets<a href="#price-range-facets" class="hash-link" aria-label="Direct link to Price Range Facets" title="Direct link to Price Range Facets">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;price&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;type&#x27; =&gt; &#x27;range&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;ranges&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;to&#x27; =&gt; 100],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;from&#x27; =&gt; 100, &#x27;to&#x27; =&gt; 500],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                [&#x27;from&#x27; =&gt; 500]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $objectService-&gt;getFacetsForObjects($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Use for price filter UI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($facets[&#x27;facets&#x27;][&#x27;price&#x27;][&#x27;buckets&#x27;] as $bucket) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $from = $bucket[&#x27;from&#x27;] ?? 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $to = $bucket[&#x27;to&#x27;] ?? &#x27;∞&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;€{$from} - €{$to}: {$bucket[&#x27;doc_count&#x27;]} items\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integration-with-search">Integration with Search<a href="#integration-with-search" class="hash-link" aria-label="Direct link to Integration with Search" title="Direct link to Integration with Search">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="combined-search-and-facets">Combined Search and Facets<a href="#combined-search-and-facets" class="hash-link" aria-label="Direct link to Combined Search and Facets" title="Direct link to Combined Search and Facets">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Search filters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;register&#x27; =&gt; [1, 2, 3],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;organisation&#x27; =&gt; &#x27;IS NOT NULL&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;status&#x27; =&gt; [&#x27;active&#x27;, &#x27;pending&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_search&#x27; =&gt; &#x27;important customer&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_published&#x27; =&gt; true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Pagination</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_limit&#x27; =&gt; 25,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_page&#x27; =&gt; 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Facet configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;register&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;schema&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;priority&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get complete paginated results with facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$result = $objectService-&gt;searchObjectsPaginated($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Result contains:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// - results: Array of objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// - total: Total count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// - page/pages: Pagination info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// - facets: Facet data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disjunctive-faceting-example">Disjunctive Faceting Example<a href="#disjunctive-faceting-example" class="hash-link" aria-label="Direct link to Disjunctive Faceting Example" title="Direct link to Disjunctive Faceting Example">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// User has selected register=1 and status=&#x27;active&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; 1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;status&#x27; =&gt; &#x27;active&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;priority&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $objectService-&gt;getFacetsForObjects($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Register facet shows ALL registers (not just register 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Status facet shows ALL statuses (not just &#x27;active&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Priority facet shows counts for register=1 AND status=&#x27;active&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// This allows users to change their register or status selection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// without losing the ability to see other options</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="schema-based-facet-configuration">Schema-Based Facet Configuration<a href="#schema-based-facet-configuration" class="hash-link" aria-label="Direct link to Schema-Based Facet Configuration" title="Direct link to Schema-Based Facet Configuration">​</a></h2>
<p>The faceting system supports schema-driven facet discovery, allowing you to define which fields are facetable directly in your schema definitions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="schema-property-configuration">Schema Property Configuration<a href="#schema-property-configuration" class="hash-link" aria-label="Direct link to Schema Property Configuration" title="Direct link to Schema Property Configuration">​</a></h3>
<p>Fields are marked as facetable in schema properties using the <code>facetable</code> flag:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Status&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Current status of the item&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;facetable&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;example&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;active&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;priority&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;integer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Priority Level&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Priority from 1 to 10&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;facetable&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;minimum&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;maximum&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;created_date&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;format&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;date&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Creation Date&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;When the item was created&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;facetable&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;internal_notes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Internal Notes&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Notes for internal use only&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;facetable&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-facet-type-detection">Automatic Facet Type Detection<a href="#automatic-facet-type-detection" class="hash-link" aria-label="Direct link to Automatic Facet Type Detection" title="Direct link to Automatic Facet Type Detection">​</a></h3>
<p>Based on schema property definitions, the system automatically determines appropriate facet types:</p>
<ul>
<li>
<p><strong>String fields</strong>:</p>
<ul>
<li>Regular strings → <code>terms</code> facet</li>
<li>Date/datetime format → <code>date_histogram</code> and <code>range</code> facets</li>
<li>Email/URI/UUID format → <code>terms</code> facet</li>
</ul>
</li>
<li>
<p><strong>Numeric fields</strong> (integer/number): <code>range</code> and <code>terms</code> facets</p>
</li>
<li>
<p><strong>Boolean fields</strong>: <code>terms</code> facet</p>
</li>
<li>
<p><strong>Array fields</strong>: <code>terms</code> facet</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="schema-based-discovery-benefits">Schema-Based Discovery Benefits<a href="#schema-based-discovery-benefits" class="hash-link" aria-label="Direct link to Schema-Based Discovery Benefits" title="Direct link to Schema-Based Discovery Benefits">​</a></h3>
<p><strong>Performance Advantages:</strong></p>
<ul>
<li>No object data analysis required - discovery is instant</li>
<li>Consistent behavior - facets always available based on schema design</li>
<li>No sampling overhead - works regardless of data volume</li>
<li>Efficient - eliminates runtime field discovery queries</li>
</ul>
<p><strong>Consistency:</strong></p>
<ul>
<li>Facets are always available based on schema, not data content</li>
<li>No need to worry about sample sizes for discovery</li>
<li>Predictable facet availability across all registers</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="backend-implementation">Backend Implementation<a href="#backend-implementation" class="hash-link" aria-label="Direct link to Backend Implementation" title="Direct link to Backend Implementation">​</a></h3>
<p>The system uses schema-based facet discovery through:</p>
<ol>
<li><strong>Schema Analysis</strong>: Pre-computes facet configuration when schema is saved</li>
<li><strong>Facet Configuration Storage</strong>: Stores facet metadata in schema entity</li>
<li><strong>Efficient Retrieval</strong>: Fast lookup without object data analysis</li>
</ol>
<p><strong>Core Components:</strong></p>
<ul>
<li><code>ObjectEntityMapper::getFacetableFieldsFromSchemas()</code> - Schema-based discovery</li>
<li><code>Schema::regenerateFacetsFromProperties()</code> - Automatic facet configuration</li>
<li><code>MariaDbFacetHandler</code> - Handles JSON object field facets</li>
<li><code>MetaDataFacetHandler</code> - Handles database table column facets</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-considerations">Performance Considerations<a href="#performance-considerations" class="hash-link" aria-label="Direct link to Performance Considerations" title="Direct link to Performance Considerations">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-impact">Performance Impact<a href="#performance-impact" class="hash-link" aria-label="Direct link to Performance Impact" title="Direct link to Performance Impact">​</a></h3>
<p>Real-world performance testing shows the following response time impacts:</p>
<ul>
<li><strong>Regular API calls</strong> - Baseline response time</li>
<li><strong>With faceting (<code>_facets</code>)</strong> - Adds approximately <strong>~10ms</strong></li>
<li><strong>With discovery (<code>_facetable=true</code>)</strong> - Adds approximately <strong>~15ms</strong></li>
<li><strong>Combined faceting + discovery</strong> - Adds approximately <strong>~25ms</strong> total</li>
</ul>
<p>These measurements are based on typical datasets and may vary depending on:</p>
<ul>
<li>Database size and object complexity</li>
<li>Number of facet fields being analyzed</li>
<li>Sample size used for discovery (default: 100 objects)</li>
<li>Server hardware and database configuration</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-operations">Asynchronous Operations<a href="#asynchronous-operations" class="hash-link" aria-label="Direct link to Asynchronous Operations" title="Direct link to Asynchronous Operations">​</a></h3>
<p>For improved performance when using multiple operations (facets + facetable discovery), the system provides asynchronous methods that run database operations concurrently using ReactPHP.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performance-benefits">Performance Benefits<a href="#performance-benefits" class="hash-link" aria-label="Direct link to Performance Benefits" title="Direct link to Performance Benefits">​</a></h4>
<p>Instead of sequential execution (~50ms total):</p>
<ol>
<li>Facetable discovery: ~15ms</li>
<li>Search results: ~10ms</li>
<li>Facets: ~10ms</li>
<li>Count: ~5ms</li>
</ol>
<p>Operations run concurrently, reducing total time to ~15ms (longest operation).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="available-methods">Available Methods<a href="#available-methods" class="hash-link" aria-label="Direct link to Available Methods" title="Direct link to Available Methods">​</a></h4>
<p><strong><code>searchObjectsPaginatedAsync(array $query): PromiseInterface</code></strong></p>
<ul>
<li>Returns a ReactPHP promise that resolves to the same structure as <code>searchObjectsPaginated()</code></li>
<li>Runs search, count, facets, and facetable discovery concurrently</li>
<li>Ideal for async/await patterns or promise chains</li>
</ul>
<p><strong><code>searchObjectsPaginatedSync(array $query): array</code></strong></p>
<ul>
<li>Convenience method that executes the async version and waits for results</li>
<li>Provides performance benefits while maintaining synchronous interface</li>
<li>Drop-in replacement for <code>searchObjectsPaginated()</code> with better performance</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="usage-examples-1">Usage Examples<a href="#usage-examples-1" class="hash-link" aria-label="Direct link to Usage Examples" title="Direct link to Usage Examples">​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Async with promise handling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$promise = $objectService-&gt;searchObjectsPaginatedAsync($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$promise-&gt;then(function ($results) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Handle results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $results;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Sync interface with async performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$results = $objectService-&gt;searchObjectsPaginatedSync($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Traditional sync method (slower for multiple operations)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$results = $objectService-&gt;searchObjectsPaginated($query);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use-async-methods">When to Use Async Methods<a href="#when-to-use-async-methods" class="hash-link" aria-label="Direct link to When to Use Async Methods" title="Direct link to When to Use Async Methods">​</a></h4>
<ul>
<li><strong>Use async methods when</strong>: Requesting both facets and facetable discovery</li>
<li><strong>Use sync methods when</strong>: Only requesting search results or single operation</li>
<li><strong>Performance gain</strong>: Most significant with <code>_facets</code> + <code>_facetable=true</code> combinations</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimizations">Optimizations<a href="#optimizations" class="hash-link" aria-label="Direct link to Optimizations" title="Direct link to Optimizations">​</a></h3>
<ol>
<li><strong>Database-level aggregations</strong> - Uses SQL GROUP BY for efficiency</li>
<li><strong>Indexed fields</strong> - Metadata facets use indexed table columns</li>
<li><strong>Disjunctive queries</strong> - Optimized to exclude only the relevant filter</li>
<li><strong>Count optimization</strong> - Uses COUNT(*) instead of selecting all data</li>
<li><strong>Schema-based discovery</strong> - No object data analysis required, instant discovery</li>
<li><strong>Database indexes</strong> - Critical indexes on <code>deleted</code>, <code>published</code>, <code>created</code>, <code>updated</code>, <code>organisation</code>, <code>owner</code></li>
<li><strong>Query batching</strong> - Combines multiple facets where possible to reduce database round trips</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-index-optimization">Database Index Optimization<a href="#database-index-optimization" class="hash-link" aria-label="Direct link to Database Index Optimization" title="Direct link to Database Index Optimization">​</a></h3>
<p>For optimal facet performance, ensure these indexes exist:</p>
<p><strong>Critical Indexes:</strong></p>
<ul>
<li><code>deleted</code> - Used in every query for lifecycle filtering</li>
<li><code>published</code> - Used for publication status filtering</li>
<li><code>created</code>, <code>updated</code> - Common facet fields</li>
<li><code>organisation</code>, <code>owner</code> - Common facet fields</li>
<li>Composite indexes for filter combinations</li>
</ul>
<p><strong>Performance Targets:</strong></p>
<ul>
<li><strong>With Indexes</strong>: 0.5-1 second for complex facet queries</li>
<li><strong>Without Indexes</strong>: 7+ seconds for same queries</li>
<li><strong>Register/Schema/Organisation facets</strong>: 50-100ms each (with proper indexes)</li>
<li><strong>JSON field facets</strong>: Performance varies by dataset size</li>
</ul>
<p><strong>Quick Performance Wins:</strong></p>
<ol>
<li>Apply database migrations to add critical indexes</li>
<li>Use schema-based discovery instead of object analysis</li>
<li>Limit facet scope to essential fields</li>
<li>Use <code>_limit=0</code> for facet-only queries</li>
<li>Remove <code>_facetable=true</code> if not needed (saves ~15ms)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h3>
<ol>
<li><strong>Use metadata facets when possible</strong> - They perform better than JSON field facets</li>
<li><strong>Limit range buckets</strong> - Too many ranges can impact performance</li>
<li><strong>Consider caching</strong> - Facet results can be cached for frequently accessed data</li>
<li><strong>Index JSON fields</strong> - Consider adding indexes for frequently faceted JSON fields</li>
<li><strong>Use <code>_facetable</code> sparingly</strong> - Only request facetable discovery when building dynamic interfaces</li>
<li><strong>Optimize sample size</strong> - Balance accuracy vs performance for facetable discovery (default: 100 objects)</li>
<li><strong>Cache facetable results</strong> - Store discovery results for repeated interface building</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="migration-from-legacy-system">Migration from Legacy System<a href="#migration-from-legacy-system" class="hash-link" aria-label="Direct link to Migration from Legacy System" title="Direct link to Migration from Legacy System">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="old-approach">Old Approach<a href="#old-approach" class="hash-link" aria-label="Direct link to Old Approach" title="Direct link to Old Approach">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Legacy faceting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$config = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;filters&#x27; =&gt; [&#x27;register&#x27; =&gt; 1, &#x27;status&#x27; =&gt; &#x27;active&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_queries&#x27; =&gt; [&#x27;status&#x27;, &#x27;priority&#x27;, &#x27;category&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $objectService-&gt;getFacets($config[&#x27;filters&#x27;], $config[&#x27;search&#x27;]);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-approach">New Approach<a href="#new-approach" class="hash-link" aria-label="Direct link to New Approach" title="Direct link to New Approach">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// New comprehensive faceting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; 1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;status&#x27; =&gt; &#x27;active&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;priority&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;category&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $objectService-&gt;getFacetsForObjects($query);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="backward-compatibility">Backward Compatibility<a href="#backward-compatibility" class="hash-link" aria-label="Direct link to Backward Compatibility" title="Direct link to Backward Compatibility">​</a></h3>
<p>The system maintains backward compatibility. If no <code>_facets</code> configuration is provided, it falls back to the legacy <code>getFacets</code> method.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ui-integration-examples">UI Integration Examples<a href="#ui-integration-examples" class="hash-link" aria-label="Direct link to UI Integration Examples" title="Direct link to UI Integration Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-facet-discovery">Dynamic Facet Discovery<a href="#dynamic-facet-discovery" class="hash-link" aria-label="Direct link to Dynamic Facet Discovery" title="Direct link to Dynamic Facet Discovery">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// React component that discovers and builds facets dynamically</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">DynamicFacetInterface</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> baseQuery </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">facetableFields</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setFacetableFields</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">facetData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setFacetData</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">filters</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setFilters</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Discover available facetable fields</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">discoverFacets</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/api/objects?_facetable=true&amp;limit=0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">baseQuery</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">setFacetableFields</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facetable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Build initial facet configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> facetConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buildFacetConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facetable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Get actual facet data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> facetResponse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/api/objects&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">assign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseQuery</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> facetConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> facetData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> facetResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">setFacetData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facetData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facets</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">discoverFacets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">baseQuery</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">buildFacetConfig</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">facetableFields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">_facets</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">&#x27;@self&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Add metadata facets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facetableFields</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">field</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> info</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facet_types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_facets</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facet_types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;date_histogram&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_facets</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;date_histogram&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;month&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Add object field facets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facetableFields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">object_fields</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">field</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> info</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">facet_types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_facets</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">facetableFields </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">facetData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Loading</span><span class="token plain"> facets</span><span class="token spread operator" style="color:#393A34">...</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;dynamic-facets&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Available</span><span class="token plain"> </span><span class="token maybe-class-name">Filters</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">h2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">/* Metadata facets */</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facetData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">field</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> facet</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">FacetFilter</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;@self.&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          field</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;@self.&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          facet</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          fieldInfo</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facetableFields</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          onFilterChange</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">handleFilterChange</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">/* Object field facets */</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">facetData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">key</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@self&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">field</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> facet</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">FacetFilter</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          field</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          facet</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          fieldInfo</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facetableFields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">object_fields</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          onFilterChange</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">handleFilterChange</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enhanced-facet-component">Enhanced Facet Component<a href="#enhanced-facet-component" class="hash-link" aria-label="Direct link to Enhanced Facet Component" title="Direct link to Enhanced Facet Component">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Enhanced facet component with discovery information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">FacetFilter</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> field</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> facet</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> fieldInfo</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> onFilterChange </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;facet-filter&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">h3</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">fieldInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">description </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">span className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;facet-info&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">fieldInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">fieldInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">appearance_rate</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> objects</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">span</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">h3</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;terms&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;checkbox-list&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">buckets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">bucket</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">label key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;checkbox&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                onChange</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onFilterChange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">label</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">results</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">label</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;range&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;range-list&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">buckets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">bucket</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              onClick</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onFilterChange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bucket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">results</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;date_histogram&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;timeline&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;interval-selector&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">fieldInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">intervals</span><span class="token operator" style="color:#393A34">?.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">interval</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">interval</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                onClick</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">changeInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> interval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">interval</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">facet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">buckets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">bucket</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;timeline-item&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">span</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">span</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">span</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">results</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">span</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">fieldInfo</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">sample_values </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;sample-values&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">small</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Sample</span><span class="token plain"> values</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">fieldInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sample_values</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;, &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">small</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">div</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="php-controller-example">PHP Controller Example<a href="#php-controller-example" class="hash-link" aria-label="Direct link to PHP Controller Example" title="Direct link to PHP Controller Example">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class SearchController extends Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function search(Request $request): JsonResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Extract filters from request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;register&#x27; =&gt; $request-&gt;get(&#x27;register&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;schema&#x27; =&gt; $request-&gt;get(&#x27;schema&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;status&#x27; =&gt; $request-&gt;get(&#x27;status&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;_search&#x27; =&gt; $request-&gt;get(&#x27;q&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;_page&#x27; =&gt; $request-&gt;get(&#x27;page&#x27;, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;_limit&#x27; =&gt; $request-&gt;get(&#x27;limit&#x27;, 20),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Facet configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &#x27;register&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &#x27;schema&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;priority&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;category&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $result = $this-&gt;objectService-&gt;searchObjectsPaginated($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Add facetable field discovery if requested</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if ($request-&gt;get(&#x27;_facetable&#x27;) === &#x27;true&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            $baseQuery = $query;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            unset($baseQuery[&#x27;_facets&#x27;], $baseQuery[&#x27;_limit&#x27;], $baseQuery[&#x27;_page&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            $result[&#x27;facetable&#x27;] = $this-&gt;objectService-&gt;getFacetableFields(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                $baseQuery, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                (int) $request-&gt;get(&#x27;_sample_size&#x27;, 100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new JsonResponse($result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function getFacetableFields(Request $request): JsonResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $baseQuery = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;@self&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;register&#x27; =&gt; $request-&gt;get(&#x27;register&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;schema&#x27; =&gt; $request-&gt;get(&#x27;schema&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;_search&#x27; =&gt; $request-&gt;get(&#x27;q&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $sampleSize = (int) $request-&gt;get(&#x27;sample_size&#x27;, 100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $facetableFields = $this-&gt;objectService-&gt;getFacetableFields($baseQuery, $sampleSize);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new JsonResponse([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;facetable&#x27; =&gt; $facetableFields,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;sample_size&#x27; =&gt; $sampleSize,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;base_query&#x27; =&gt; $baseQuery</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unit-test-examples">Unit Test Examples<a href="#unit-test-examples" class="hash-link" aria-label="Direct link to Unit Test Examples" title="Direct link to Unit Test Examples">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class FacetingTest extends TestCase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function testBasicTermsFacet(): void</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $facets = $this-&gt;objectService-&gt;getFacetsForObjects($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;facets&#x27;, $facets);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;status&#x27;, $facets[&#x27;facets&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(&#x27;terms&#x27;, $facets[&#x27;facets&#x27;][&#x27;status&#x27;][&#x27;type&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertIsArray($facets[&#x27;facets&#x27;][&#x27;status&#x27;][&#x27;buckets&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function testDisjunctiveFaceting(): void</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Create test data with different statuses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;createTestObjects([&#x27;status&#x27; =&gt; &#x27;active&#x27;], 10);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;createTestObjects([&#x27;status&#x27; =&gt; &#x27;inactive&#x27;], 5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $query = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;status&#x27; =&gt; &#x27;active&#x27;,  // Filter by active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;_facets&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;status&#x27; =&gt; [&#x27;type&#x27; =&gt; &#x27;terms&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $facets = $this-&gt;objectService-&gt;getFacetsForObjects($query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Should show both active AND inactive in facets (disjunctive)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $statusBuckets = $facets[&#x27;facets&#x27;][&#x27;status&#x27;][&#x27;buckets&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertCount(2, $statusBuckets);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $activeCount = $this-&gt;findBucketByKey($statusBuckets, &#x27;active&#x27;)[&#x27;results&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $inactiveCount = $this-&gt;findBucketByKey($statusBuckets, &#x27;inactive&#x27;)[&#x27;results&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(10, $activeCount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(5, $inactiveCount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function testFacetableFieldDiscovery(): void</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Create test objects with various field types</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;createTestObjects([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;status&#x27; =&gt; &#x27;active&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;priority&#x27; =&gt; 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;created_date&#x27; =&gt; &#x27;2024-01-15&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;is_featured&#x27; =&gt; true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ], 5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;createTestObjects([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;status&#x27; =&gt; &#x27;inactive&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;priority&#x27; =&gt; 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;created_date&#x27; =&gt; &#x27;2024-02-20&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;is_featured&#x27; =&gt; false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ], 3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $baseQuery = [&#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; 1]];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $facetableFields = $this-&gt;objectService-&gt;getFacetableFields($baseQuery, 50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Check structure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;@self&#x27;, $facetableFields);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;object_fields&#x27;, $facetableFields);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Check metadata fields</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;register&#x27;, $facetableFields[&#x27;@self&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(&#x27;categorical&#x27;, $facetableFields[&#x27;@self&#x27;][&#x27;register&#x27;][&#x27;type&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertContains(&#x27;terms&#x27;, $facetableFields[&#x27;@self&#x27;][&#x27;register&#x27;][&#x27;facet_types&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Check object fields</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;status&#x27;, $facetableFields[&#x27;object_fields&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(&#x27;string&#x27;, $facetableFields[&#x27;object_fields&#x27;][&#x27;status&#x27;][&#x27;type&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertContains(&#x27;terms&#x27;, $facetableFields[&#x27;object_fields&#x27;][&#x27;status&#x27;][&#x27;facet_types&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;priority&#x27;, $facetableFields[&#x27;object_fields&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(&#x27;integer&#x27;, $facetableFields[&#x27;object_fields&#x27;][&#x27;priority&#x27;][&#x27;type&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertContains(&#x27;range&#x27;, $facetableFields[&#x27;object_fields&#x27;][&#x27;priority&#x27;][&#x27;facet_types&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;is_featured&#x27;, $facetableFields[&#x27;object_fields&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(&#x27;boolean&#x27;, $facetableFields[&#x27;object_fields&#x27;][&#x27;is_featured&#x27;][&#x27;type&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertContains(&#x27;terms&#x27;, $facetableFields[&#x27;object_fields&#x27;][&#x27;is_featured&#x27;][&#x27;facet_types&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function testFacetableFieldFiltering(): void</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Create objects with high cardinality field (should be filtered out)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for ($i = 0; $i &lt; 100; $i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            $this-&gt;createTestObjects([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;unique_id&#x27; =&gt; &#x27;id_&#x27; . $i,  // High cardinality</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;category&#x27; =&gt; &#x27;cat_&#x27; . ($i % 3)  // Low cardinality</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ], 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $facetableFields = $this-&gt;objectService-&gt;getFacetableFields([], 100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // High cardinality field should be filtered out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayNotHasKey(&#x27;unique_id&#x27;, $facetableFields[&#x27;object_fields&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Low cardinality field should be included</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;category&#x27;, $facetableFields[&#x27;object_fields&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertEquals(&#x27;low&#x27;, $facetableFields[&#x27;object_fields&#x27;][&#x27;category&#x27;][&#x27;cardinality&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function testFacetableFieldAppearanceThreshold(): void</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Create objects where some fields appear in less than 10% of objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;createTestObjects([&#x27;common_field&#x27; =&gt; &#x27;value1&#x27;], 50);  // 100% appearance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;createTestObjects([&#x27;rare_field&#x27; =&gt; &#x27;value2&#x27;], 2);     // 4% appearance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $facetableFields = $this-&gt;objectService-&gt;getFacetableFields([], 50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Common field should be included</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayHasKey(&#x27;common_field&#x27;, $facetableFields[&#x27;object_fields&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Rare field should be filtered out (below 10% threshold)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;assertArrayNotHasKey(&#x27;rare_field&#x27;, $facetableFields[&#x27;object_fields&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="caching-and-label-resolution">Caching and Label Resolution<a href="#caching-and-label-resolution" class="hash-link" aria-label="Direct link to Caching and Label Resolution" title="Direct link to Caching and Label Resolution">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-1">Overview<a href="#overview-1" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h3>
<p>The faceting system includes an intelligent caching mechanism that resolves metadata field IDs (registers, schemas, organisations) and object UUIDs to human-readable names without sacrificing performance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="label-resolution-process">Label Resolution Process<a href="#label-resolution-process" class="hash-link" aria-label="Direct link to Label Resolution Process" title="Direct link to Label Resolution Process">​</a></h4>
<p>When facets are returned, the system automatically resolves IDs and UUIDs to human-readable names:</p>
<p><strong>For metadata fields</strong> (&#x27;_register&#x27;, &#x27;_schema&#x27;, &#x27;_organisation&#x27;):</p>
<ol>
<li><strong>Collects IDs</strong> from all facet buckets for batch processing</li>
<li><strong>Batch loads entities</strong> using optimized database queries</li>
<li><strong>Caches results</strong> to prevent repeated database calls</li>
<li><strong>Resolves labels</strong> by mapping IDs to entity names/titles</li>
<li><strong>Sorts alphabetically</strong> by label for consistent ordering (case-insensitive A-Z)</li>
</ol>
<p><strong>For object fields</strong> (any field containing UUIDs):</p>
<ol>
<li><strong>Detects UUIDs</strong> by checking for hyphenated values</li>
<li><strong>Batch resolves</strong> using ObjectCacheService.getMultipleObjectNames()</li>
<li><strong>Searches caches</strong> (in-memory and distributed) before database</li>
<li><strong>Extracts names</strong> from common fields (naam, name, title, etc.)</li>
<li><strong>Sorts alphabetically</strong> by resolved names for user-friendly display</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-response">Example Response<a href="#example-response" class="hash-link" aria-label="Direct link to Example Response" title="Direct link to Example Response">​</a></h4>
<p><strong>Before label resolution:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;_register&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;buckets&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">114474</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8794</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>After label resolution (alphabetically sorted):</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;_register&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;buckets&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8794</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Events Register&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">114474</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Publications Register&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note:</strong> Buckets are sorted alphabetically by label (A-Z), not by count or value.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sorting-behavior">Sorting Behavior<a href="#sorting-behavior" class="hash-link" aria-label="Direct link to Sorting Behavior" title="Direct link to Sorting Behavior">​</a></h4>
<p>All term-based facets are automatically sorted alphabetically by label:</p>
<p><strong>Metadata facets</strong> (<code>_register</code>, <code>_schema</code>, <code>_organisation</code>):</p>
<ul>
<li>Sorted by resolved entity names (e.g., &quot;Events Register&quot;, &quot;Publications Register&quot;)</li>
<li>Case-insensitive alphabetical order (A, a, B, b, etc.)</li>
</ul>
<p><strong>Object field facets</strong> (status, category, type, etc.):</p>
<ul>
<li>Sorted by their resolved labels (UUIDs converted to object names)</li>
<li>Case-insensitive alphabetical order</li>
<li>Numeric strings sorted as text (e.g., &quot;1&quot;, &quot;10&quot;, &quot;2&quot;)</li>
<li>UUIDs automatically resolved to human-readable object names using ObjectCacheService</li>
</ul>
<p><strong>Date histogram facets</strong>:</p>
<ul>
<li>Not sorted alphabetically (chronological order maintained)</li>
</ul>
<p><strong>Range facets</strong>:</p>
<ul>
<li>Not sorted alphabetically (range order maintained)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="caching-strategy">Caching Strategy<a href="#caching-strategy" class="hash-link" aria-label="Direct link to Caching Strategy" title="Direct link to Caching Strategy">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="static-caching-saveobjects">Static Caching (SaveObjects)<a href="#static-caching-saveobjects" class="hash-link" aria-label="Direct link to Static Caching (SaveObjects)" title="Direct link to Static Caching (SaveObjects)">​</a></h4>
<p>Used during bulk save operations:</p>
<ul>
<li><strong>Schema Cache</strong> - Stores loaded schemas to avoid repeated DB queries</li>
<li><strong>Register Cache</strong> - Stores loaded registers to avoid repeated DB queries</li>
<li><strong>Lifetime</strong> - Lasts for the duration of the save operation</li>
<li><strong>Clearing</strong> - Automatically cleared after bulk operation completes</li>
</ul>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Example: Schema caching during bulk save</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$schema = $this-&gt;loadSchemaWithCache($schemaId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Subsequent calls for same $schemaId return cached instance</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="entity-caching-objectservice">Entity Caching (ObjectService)<a href="#entity-caching-objectservice" class="hash-link" aria-label="Direct link to Entity Caching (ObjectService)" title="Direct link to Entity Caching (ObjectService)">​</a></h4>
<p>Used during object retrieval and faceting:</p>
<ul>
<li><strong>getCachedEntities()</strong> - Generic caching method for schemas/registers</li>
<li><strong>Batch Loading</strong> - Fetches multiple entities in a single query</li>
<li><strong>Fallback Mechanism</strong> - Falls back to DB if cache unavailable</li>
</ul>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Example: Batch loading registers for facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$registers = $this-&gt;getCachedEntities(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;register&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $registerIds, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [$this-&gt;registerMapper, &#x27;findMultiple&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mapper-optimizations">Mapper Optimizations<a href="#mapper-optimizations" class="hash-link" aria-label="Direct link to Mapper Optimizations" title="Direct link to Mapper Optimizations">​</a></h4>
<p>Specialized batch loading methods:</p>
<ul>
<li><strong>findMultipleOptimized()</strong> - Single query for multiple IDs</li>
<li><strong>Returns keyed array</strong> - ID =&gt; Entity for fast lookups</li>
<li><strong>Used by facet processing</strong> - Resolves labels efficiently</li>
</ul>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Example: Optimized batch loading</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$schemas = $this-&gt;schemaMapper-&gt;findMultipleOptimized([1, 2, 3]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Result: [1 =&gt; Schema1, 2 =&gt; Schema2, 3 =&gt; Schema3]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="uuid-resolution-for-object-field-facets">UUID Resolution for Object Field Facets<a href="#uuid-resolution-for-object-field-facets" class="hash-link" aria-label="Direct link to UUID Resolution for Object Field Facets" title="Direct link to UUID Resolution for Object Field Facets">​</a></h4>
<p>When object fields contain references to other objects via UUIDs, the system automatically resolves them to human-readable names:</p>
<p><strong>How it works:</strong></p>
<ol>
<li><strong>Detect UUIDs</strong> - Identifies values that look like UUIDs (contain hyphens)</li>
<li><strong>Batch lookup</strong> - Uses <code>ObjectCacheService.getMultipleObjectNames()</code> for efficient batch retrieval</li>
<li><strong>Cache first</strong> - Checks in-memory and distributed caches before database</li>
<li><strong>Multi-source</strong> - Searches both organisations and objects tables</li>
<li><strong>Name extraction</strong> - Uses common name fields (naam, name, title, contractNummer, achternaam)</li>
<li><strong>Fallback gracefully</strong> - Uses UUID if name cannot be resolved</li>
</ol>
<p><strong>Example transformation:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Before UUID resolution:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customer&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;buckets&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;f47ac10b-58cc-4372-a567-0e02b2c3d479&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;f47ac10b-58cc-4372-a567-0e02b2c3d479&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// After UUID resolution (alphabetically sorted):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customer&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;buckets&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;f47ac10b-58cc-4372-a567-0e02b2c3d479&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Acme Corporation&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Performance considerations:</strong></p>
<ul>
<li><strong>Cached UUIDs</strong> - Already resolved names retrieved instantly from cache</li>
<li><strong>Batch loading</strong> - New UUIDs loaded together in a single query</li>
<li><strong>Persistent cache</strong> - Resolved names stored in distributed cache for all users</li>
<li><strong>Minimal overhead</strong> - Only processes values that look like UUIDs (contain hyphens)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-benefits-1">Performance Benefits<a href="#performance-benefits-1" class="hash-link" aria-label="Direct link to Performance Benefits" title="Direct link to Performance Benefits">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="without-caching">Without Caching<a href="#without-caching" class="hash-link" aria-label="Direct link to Without Caching" title="Direct link to Without Caching">​</a></h4>
<ul>
<li><strong>1 query per unique ID</strong> in facet results</li>
<li><strong>N+1 query problem</strong> for large facet sets</li>
<li><strong>Response time</strong> increases linearly with unique values</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="with-caching">With Caching<a href="#with-caching" class="hash-link" aria-label="Direct link to With Caching" title="Direct link to With Caching">​</a></h4>
<ul>
<li><strong>1 query for all IDs</strong> per facet field</li>
<li><strong>No redundant queries</strong> for same entities</li>
<li><strong>Consistent performance</strong> regardless of facet size</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="real-world-impact">Real-World Impact<a href="#real-world-impact" class="hash-link" aria-label="Direct link to Real-World Impact" title="Direct link to Real-World Impact">​</a></h4>
<p>For a facet with 20 unique register IDs:</p>
<ul>
<li><strong>Without caching</strong>: 20 separate queries = ~500ms</li>
<li><strong>With caching</strong>: 1 batch query = ~25ms</li>
<li><strong>Performance gain</strong>: 20x faster</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-details">Implementation Details<a href="#implementation-details" class="hash-link" aria-label="Direct link to Implementation Details" title="Direct link to Implementation Details">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="facet-processing-pipeline">Facet Processing Pipeline<a href="#facet-processing-pipeline" class="hash-link" aria-label="Direct link to Facet Processing Pipeline" title="Direct link to Facet Processing Pipeline">​</a></h4>
<ol>
<li><strong>SOLR returns raw facets</strong> with numeric IDs</li>
<li><strong>processFacetResponse()</strong> detects metadata fields</li>
<li><strong>formatMetadataFacetData()</strong> called for register/schema/organisation</li>
<li><strong>resolveRegisterLabels()/resolveSchemaLabels()</strong> batch load entities</li>
<li><strong>Labels mapped to buckets</strong> before returning to frontend</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-flow-diagram">Code Flow Diagram<a href="#code-flow-diagram" class="hash-link" aria-label="Direct link to Code Flow Diagram" title="Direct link to Code Flow Diagram">​</a></h4>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant API as API Request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant GS as GuzzleSolrService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Cache as Entity Cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Mapper as RegisterMapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant DB as Database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    API-&gt;&gt;GS: getFacets with _facets=extend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GS-&gt;&gt;GS: Build facet query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GS-&gt;&gt;GS: Execute SOLR query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GS-&gt;&gt;GS: processFacetResponse()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt Metadata Field with Label Resolution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GS-&gt;&gt;GS: formatMetadataFacetData()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GS-&gt;&gt;GS: Extract IDs from buckets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GS-&gt;&gt;GS: resolveRegisterLabels([5,6])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GS-&gt;&gt;Cache: getCachedEntities(&#x27;register&#x27;, [5,6])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alt Cache Miss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cache-&gt;&gt;Mapper: findMultipleOptimized([5,6])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Mapper-&gt;&gt;DB: SELECT * WHERE id IN (5,6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB--&gt;&gt;Mapper: Register entities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Mapper--&gt;&gt;Cache: [5=&gt;Reg5, 6=&gt;Reg6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cache-&gt;&gt;Cache: Store in cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cache--&gt;&gt;GS: [5=&gt;Reg5, 6=&gt;Reg6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GS-&gt;&gt;GS: Map labels to buckets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else Regular Field</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GS-&gt;&gt;GS: formatFacetData()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GS--&gt;&gt;API: Facets with resolved labels</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="which-fields-get-label-resolution">Which Fields Get Label Resolution<a href="#which-fields-get-label-resolution" class="hash-link" aria-label="Direct link to Which Fields Get Label Resolution" title="Direct link to Which Fields Get Label Resolution">​</a></h4>
<p><strong>Always Resolved:</strong></p>
<ul>
<li>&#x27;_register&#x27; → Register title</li>
<li>&#x27;_schema&#x27; → Schema title or name</li>
<li>&#x27;_organisation&#x27; → Organisation name</li>
</ul>
<p><strong>Never Resolved:</strong></p>
<ul>
<li>&#x27;_created&#x27;, &#x27;_updated&#x27; → Date fields use dates as labels</li>
<li>&#x27;_application&#x27; → String values remain as-is</li>
<li>Object fields → Use raw values as labels</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="facet-bucket-limits">Facet Bucket Limits<a href="#facet-bucket-limits" class="hash-link" aria-label="Direct link to Facet Bucket Limits" title="Direct link to Facet Bucket Limits">​</a></h4>
<p>The system limits the number of buckets (unique values) returned per facet to prevent performance issues:</p>
<p><strong>Default limit:</strong> 1000 buckets per facet</p>
<ul>
<li>Metadata facets (<code>_register</code>, <code>_schema</code>, <code>_organisation</code>): 1000 buckets</li>
<li>Object field facets (status, category, type, etc.): 1000 buckets</li>
</ul>
<p><strong>Why limit buckets?</strong></p>
<ul>
<li>Prevents excessive memory usage</li>
<li>Keeps API responses manageable</li>
<li>Ensures consistent performance</li>
</ul>
<p><strong>Need more buckets?</strong>
You can modify the limit in <code>GuzzleSolrService.php</code>:</p>
<ul>
<li>Line 7851: Metadata fields</li>
<li>Line 7876: Object fields</li>
<li>Line 7906: Fallback facets</li>
<li>Line 8231: buildTermsFacet() method (accepts <code>$limit</code> parameter)</li>
</ul>
<p><strong>For unlimited buckets</strong>, set <code>&#x27;limit&#x27; =&gt; -1</code> (use with caution!):</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$facetConfig = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27; =&gt; &#x27;terms&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;field&#x27; =&gt; &#x27;self_register&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;limit&#x27; =&gt; -1, // Unlimited buckets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;mincount&#x27; =&gt; 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note:</strong> Very large facet sets may impact:</p>
<ul>
<li>API response time</li>
<li>Frontend rendering performance</li>
<li>Memory usage on both server and client</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-caching">Disabling Caching<a href="#disabling-caching" class="hash-link" aria-label="Direct link to Disabling Caching" title="Direct link to Disabling Caching">​</a></h4>
<p>Caching is currently always enabled, but can be modified by changing the &#x27;getCachedEntities()&#x27; method implementation:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private function getCachedEntities(...): array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Current: Always use fallback (cache disabled)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return call_user_func($fallbackFunc, $ids);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // To enable caching: Implement cache logic here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="customizing-label-format">Customizing Label Format<a href="#customizing-label-format" class="hash-link" aria-label="Direct link to Customizing Label Format" title="Direct link to Customizing Label Format">​</a></h4>
<p>Modify the resolve methods to customize label formatting:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private function resolveSchemaLabels(array $ids): array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Current: Uses title or name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $labels[$id] = $schema-&gt;getTitle() ?? $schema-&gt;getName() ?? &quot;Schema $id&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Customize: Add more information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $labels[$id] = $schema-&gt;getTitle() . &#x27; (&#x27; . $schema-&gt;getVersion() . &#x27;)&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="labels-showing-as-ids">Labels Showing as IDs<a href="#labels-showing-as-ids" class="hash-link" aria-label="Direct link to Labels Showing as IDs" title="Direct link to Labels Showing as IDs">​</a></h4>
<p>If facet labels are showing numeric IDs instead of names:</p>
<ol>
<li>Verify the field is in the metadata fields list (&#x27;_register&#x27;, &#x27;_schema&#x27;, &#x27;_organisation&#x27;)</li>
<li>Check database has entities with those IDs</li>
<li>Ensure entities have &#x27;title&#x27;/&#x27;name&#x27; properties set</li>
<li>Review logs for label resolution errors</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performance-issues">Performance Issues<a href="#performance-issues" class="hash-link" aria-label="Direct link to Performance Issues" title="Direct link to Performance Issues">​</a></h4>
<p>If facet queries are slow:</p>
<ol>
<li>Ensure batch loading methods are being used</li>
<li>Check database indexes on ID columns</li>
<li>Consider implementing actual caching in &#x27;getCachedEntities()&#x27;</li>
<li>Monitor number of unique IDs per facet</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cache-invalidation">Cache Invalidation<a href="#cache-invalidation" class="hash-link" aria-label="Direct link to Cache Invalidation" title="Direct link to Cache Invalidation">​</a></h4>
<p>If stale labels appear after entity updates:</p>
<ol>
<li>Static cache clears automatically after operations</li>
<li>For persistent cache (when implemented), clear on entity updates</li>
<li>Consider cache TTL for production deployments</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>The new faceting system provides a powerful, flexible, and user-friendly approach to building faceted search interfaces. It combines the best practices from modern search systems like Elasticsearch with the specific needs of the OpenRegister application.</p>
<p>Key benefits:</p>
<ul>
<li><strong>Better UX</strong> - Disjunctive faceting prevents options from disappearing</li>
<li><strong>More flexible</strong> - Supports multiple facet types and data sources</li>
<li><strong>Better performance</strong> - Optimized database queries and intelligent caching</li>
<li><strong>Smart label resolution</strong> - Automatic conversion of IDs to human-readable names</li>
<li><strong>Modern API</strong> - Familiar structure for developers</li>
<li><strong>Backward compatible</strong> - Existing code continues to work</li>
<li><strong>Dynamic discovery</strong> - Automatic detection of facetable fields helps build intelligent interfaces</li>
<li><strong>Database-oriented</strong> - All analysis happens at the database level for optimal performance</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="facetable-discovery-benefits">Facetable Discovery Benefits<a href="#facetable-discovery-benefits" class="hash-link" aria-label="Direct link to Facetable Discovery Benefits" title="Direct link to Facetable Discovery Benefits">​</a></h3>
<p>The facetable field discovery system provides several key advantages:</p>
<ol>
<li><strong>Dynamic Interface Building</strong> - Frontends can automatically discover and build facet interfaces without hardcoding field lists</li>
<li><strong>Data-Driven Configuration</strong> - Facet types and options are determined by analyzing actual data</li>
<li><strong>Context Awareness</strong> - Discovery respects current filters to show relevant faceting options</li>
<li><strong>Performance Optimization</strong> - Database-level analysis ensures efficient field discovery</li>
<li><strong>Type Intelligence</strong> - Automatic detection of field types enables appropriate facet configurations</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-recommendations">Usage Recommendations<a href="#usage-recommendations" class="hash-link" aria-label="Direct link to Usage Recommendations" title="Direct link to Usage Recommendations">​</a></h3>
<ol>
<li><strong>Use <code>_facetable=true</code></strong> for initial interface discovery</li>
<li><strong>Cache discovery results</strong> for frequently accessed configurations</li>
<li><strong>Combine with regular faceting</strong> for complete search interfaces</li>
<li><strong>Leverage sample data</strong> to show users what to expect</li>
<li><strong>Respect appearance rates</strong> to focus on commonly used fields</li>
</ol>
<p>The system is designed to grow with your application&#x27;s needs while maintaining excellent performance and user experience. The addition of facetable discovery makes it even easier to build intelligent, data-driven search interfaces that adapt to your content automatically.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-architecture">Technical Architecture<a href="#technical-architecture" class="hash-link" aria-label="Direct link to Technical Architecture" title="Direct link to Technical Architecture">​</a></h2>
<p>This section provides detailed visualization of the faceting system&#x27;s architecture and data flow.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="faceting-request-flow">Faceting Request Flow<a href="#faceting-request-flow" class="hash-link" aria-label="Direct link to Faceting Request Flow" title="Direct link to Faceting Request Flow">​</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ObjectService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant FacetService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant SolrService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Solr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Client-&gt;&gt;API: GET /api/objects?_facetable=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    API-&gt;&gt;ObjectService: findObjects(_facetable=true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over ObjectService: Check if faceting requested</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService-&gt;&gt;FacetService: getFacetableFields(query)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over FacetService: Analyze schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FacetService-&gt;&gt;FacetService: getSchemaFacets()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FacetService-&gt;&gt;FacetService: discoverObjectFields()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FacetService--&gt;&gt;ObjectService: Facetable field definitions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService-&gt;&gt;SolrService: searchObjects(query + facets)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SolrService: Build facet query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;SolrService: buildJsonFacetQuery()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;SolrService: buildTermsFacet()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;SolrService: buildDateHistogramFacet()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;Solr: POST /collection/select + json.facet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Solr--&gt;&gt;SolrService: Facet results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SolrService: Process facet response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;SolrService: processFacetResponse()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SolrService: UUID Resolution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;SolrService: detectUUIDs()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;Cache: getCachedObjects(uuids)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Cache--&gt;&gt;SolrService: Cached names</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;SolrService: resolveRemainingUUIDs()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over SolrService: Sort alphabetically</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService-&gt;&gt;SolrService: sortFacetsAlphabetically()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SolrService--&gt;&gt;ObjectService: Enriched facet data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectService--&gt;&gt;API: Results + Facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    API--&gt;&gt;Client: JSON Response</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="facet-processing-pipeline-1">Facet Processing Pipeline<a href="#facet-processing-pipeline-1" class="hash-link" aria-label="Direct link to Facet Processing Pipeline" title="Direct link to Facet Processing Pipeline">​</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Faceting Request] --&gt; B{_facetable parameter?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|true| C[Get Facetable Fields]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|false| D[Skip Faceting]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; E[Schema Analysis]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; F[Get Pre-computed Facets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; G[Discover Object Fields]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; H[Merge Facet Definitions]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; I[Build Solr Facet Query]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; J{Facet Type?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|Terms| K[buildTermsFacet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|Date Histogram| L[buildDateHistogramFacet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|Range| M[buildRangeFacet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; N[Execute Solr Query]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt; O[Solr Returns Buckets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; P[Process Facet Response]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; Q{Contains UUIDs?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt;|Yes| R[UUID Resolution]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt;|No| S[Format Buckets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    R --&gt; T[Check Cache]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    T --&gt; U{In Cache?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    U --&gt;|Yes| V[Use Cached Names]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    U --&gt;|No| W[Batch Load from DB]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    W --&gt; X[Cache Results]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V --&gt; Y[Merge with Buckets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X --&gt; Y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Y --&gt; Z[Sort Alphabetically]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S --&gt; Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Z --&gt; AA[Return Enriched Facets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style I fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style R fill:#ffe1e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style T fill:#fff4e1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uuid-resolution-process">UUID Resolution Process<a href="#uuid-resolution-process" class="hash-link" aria-label="Direct link to UUID Resolution Process" title="Direct link to UUID Resolution Process">​</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph LR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Facet Buckets] --&gt; B{Detect UUIDs}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|UUID Pattern Found| C[Extract UUID List]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|No UUIDs| D[Return Original]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; E[Lazy Load ObjectCacheService]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; F{Service Available?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt;|No| G[Use UUIDs as Labels]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt;|Yes| H[Batch Load Objects]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; I[Check Memory Cache]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; J{In Memory?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|Yes| K[Use Cached]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt;|No| L[Check Distributed Cache]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; M{In Cache?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt;|Yes| N[Use Cached]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt;|No| O[Load from Database]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; P[Extract Name Fields]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P --&gt; Q[naam, name, title, etc.]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; R[Merge with Buckets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt; R</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Q --&gt; S[Cache Result]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S --&gt; R</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    R --&gt; T[Sort by Label A-Z]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    T --&gt; U[Return Enriched Facets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style E fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style I fill:#fff4e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style L fill:#fff4e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style O fill:#ffe1e1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disjunctive-faceting-implementation">Disjunctive Faceting Implementation<a href="#disjunctive-faceting-implementation" class="hash-link" aria-label="Direct link to Disjunctive Faceting Implementation" title="Direct link to Disjunctive Faceting Implementation">​</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[User Applies Filter] --&gt; B[Status=published]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C[Build Facet Queries]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; D{For Each Facet}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; E[Status Facet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; F[Category Facet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; G[Priority Facet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over E: Exclude its own filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; H[Domain Filter without Status]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; I[Apply: Category + Priority]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over F: Exclude its own filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; J[Domain Filter without Category]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; K[Apply: Status + Priority]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note over G: Exclude its own filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; L[Domain Filter without Priority]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; M[Apply: Status + Category]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; N[Execute Solr Queries]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    N --&gt; O[Merge Results]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    O --&gt; P[All Options Remain Visible]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style C fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style O fill:#e1ffe1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="facet-type-selection-logic">Facet Type Selection Logic<a href="#facet-type-selection-logic" class="hash-link" aria-label="Direct link to Facet Type Selection Logic" title="Direct link to Facet Type Selection Logic">​</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[Analyze Field] --&gt; B{Field Type?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|String| C{Cardinality?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|Numeric| D[Terms + Range]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|Date| E[Date Histogram + Range]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt;|Boolean| F[Terms Only]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|Low ≤50| G[Terms Facet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|High &gt;50| H[Not Suitable]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; I[categorical]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; J[numeric]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; K[date]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; L[binary]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; M[Skip Faceting]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; N[Return Facet Config]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt; O[Exclude from Facets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style B fill:#e1f5ff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style N fill:#e1ffe1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="caching-strategy-1">Caching Strategy<a href="#caching-strategy-1" class="hash-link" aria-label="Direct link to Caching Strategy" title="Direct link to Caching Strategy">​</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[UUID Resolution Request] --&gt; B[Check Memory Cache]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C{Exists?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|Yes| D[Return &lt;10ms]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt;|No| E[Check Distributed Cache]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; F{Exists?}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt;|Yes| G[Return &lt;50ms]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt;|No| H[Database Query]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H --&gt; I[Batch Load Objects]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    I --&gt; J[Extract Names]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    J --&gt; K[Store in Distributed Cache]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    K --&gt; L[Store in Memory Cache]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    L --&gt; M[Return &lt;100ms for 100 UUIDs]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; N[Facet Response]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    M --&gt; N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style B fill:#fff4e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style E fill:#fff4e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style H fill:#ffe1e1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style N fill:#e1ffe1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-characteristics">Performance Characteristics<a href="#performance-characteristics" class="hash-link" aria-label="Direct link to Performance Characteristics" title="Direct link to Performance Characteristics">​</a></h3>
<p><strong>Facet Query Performance:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Without Faceting:    ~50ms  (search only)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">With Faceting:       ~80ms  (search + 5 facets)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">With UUID Resolution: ~120ms (search + 5 facets + 100 UUID resolutions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">With Full Caching:   ~60ms  (search + 5 facets + cached UUIDs)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Caching Impact:</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Memory Cache Hit:     &lt;10ms   per UUID resolution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Distributed Cache:    &lt;50ms   per batch (100 UUIDs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Database Query:       &lt;100ms  per batch (100 UUIDs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No Cache:             ~1000ms for 100 individual queries</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-examples">Code Examples<a href="#code-examples" class="hash-link" aria-label="Direct link to Code Examples" title="Direct link to Code Examples">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="building-custom-facet-query">Building Custom Facet Query<a href="#building-custom-facet-query" class="hash-link" aria-label="Direct link to Building Custom Facet Query" title="Direct link to Building Custom Facet Query">​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use OCA\OpenRegister\Service\FacetService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get facetable fields</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facetableFields = $facetService-&gt;getFacetableFields([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;@self&#x27; =&gt; [&#x27;register&#x27; =&gt; 5],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_search&#x27; =&gt; &#x27;budget&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">], 100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Build facet configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;status&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;type&#x27; =&gt; &#x27;terms&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;field&#x27; =&gt; &#x27;status_s&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;limit&#x27; =&gt; 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;created&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;type&#x27; =&gt; &#x27;date_histogram&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;field&#x27; =&gt; &#x27;self_created&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;interval&#x27; =&gt; &#x27;month&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Execute search with facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$results = $objectService-&gt;findObjects([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_source&#x27; =&gt; &#x27;index&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facetable&#x27; =&gt; true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;_facets&#x27; =&gt; $facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="processing-facet-results">Processing Facet Results<a href="#processing-facet-results" class="hash-link" aria-label="Direct link to Processing Facet Results" title="Direct link to Processing Facet Results">​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Access facet data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$facets = $results[&#x27;facets&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($facets[&#x27;@self&#x27;] as $fieldName =&gt; $facetData) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Facet: &quot; . $facetData[&#x27;description&#x27;] . &quot;\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foreach ($facetData[&#x27;data&#x27;] as $bucket) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;  - &quot; . $bucket[&#x27;label&#x27;] . &quot;: &quot; . $bucket[&#x27;count&#x27;] . &quot;\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Process object field facets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($facets[&#x27;object_fields&#x27;] as $fieldName =&gt; $facetData) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Object Field: &quot; . $fieldName . &quot;\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foreach ($facetData[&#x27;data&#x27;] as $bucket) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;  - &quot; . $bucket[&#x27;value&#x27;] . &quot;: &quot; . $bucket[&#x27;count&#x27;] . &quot;\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-1">Testing<a href="#testing-1" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Run faceting tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit tests/Service/FacetServiceTest.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Test specific scenarios</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit --filter testDisjunctiveFaceting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit --filter testUUIDResolution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit --filter testFacetDiscovery</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Integration tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor/bin/phpunit tests/Integration/FacetIntegrationTest.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Test Coverage:</strong></p>
<ul>
<li>Facet type detection</li>
<li>UUID resolution and caching</li>
<li>Disjunctive faceting behavior</li>
<li>Alphabetical sorting</li>
<li>Date histogram buckets</li>
<li>Range aggregations</li>
<li>Performance benchmarks</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/conductionnl/openregister/tree/main/website/docs/Features/faceting.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Features/configurations"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Configurations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Features/multi-tenancy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Multi-Tenancy</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#key-features" class="table-of-contents__link toc-highlight">Key Features</a><ul><li><a href="#1-disjunctive-faceting" class="table-of-contents__link toc-highlight">1. Disjunctive Faceting</a></li><li><a href="#2-multiple-facet-types" class="table-of-contents__link toc-highlight">2. Multiple Facet Types</a></li><li><a href="#3-dual-data-sources" class="table-of-contents__link toc-highlight">3. Dual Data Sources</a></li><li><a href="#4-enhanced-labels-with-caching" class="table-of-contents__link toc-highlight">4. Enhanced Labels with Caching</a></li><li><a href="#5-facetable-field-discovery" class="table-of-contents__link toc-highlight">5. Facetable Field Discovery</a></li></ul></li><li><a href="#facetable-field-discovery" class="table-of-contents__link toc-highlight">Facetable Field Discovery</a><ul><li><a href="#discovery-api" class="table-of-contents__link toc-highlight">Discovery API</a></li><li><a href="#discovery-response-structure" class="table-of-contents__link toc-highlight">Discovery Response Structure</a></li><li><a href="#field-properties-explained" class="table-of-contents__link toc-highlight">Field Properties Explained</a></li><li><a href="#field-types-and-characteristics" class="table-of-contents__link toc-highlight">Field Types and Characteristics</a></li><li><a href="#discovery-configuration" class="table-of-contents__link toc-highlight">Discovery Configuration</a></li><li><a href="#api-integration" class="table-of-contents__link toc-highlight">API Integration</a></li></ul></li><li><a href="#api-structure" class="table-of-contents__link toc-highlight">API Structure</a><ul><li><a href="#basic-query-structure" class="table-of-contents__link toc-highlight">Basic Query Structure</a></li><li><a href="#response-structure" class="table-of-contents__link toc-highlight">Response Structure</a></li></ul></li><li><a href="#facet-types" class="table-of-contents__link toc-highlight">Facet Types</a><ul><li><a href="#1-terms-aggregation" class="table-of-contents__link toc-highlight">1. Terms Aggregation</a></li><li><a href="#2-date-histogram" class="table-of-contents__link toc-highlight">2. Date Histogram</a></li><li><a href="#3-range-aggregation" class="table-of-contents__link toc-highlight">3. Range Aggregation</a></li></ul></li><li><a href="#usage-examples" class="table-of-contents__link toc-highlight">Usage Examples</a><ul><li><a href="#basic-enumerated-facets" class="table-of-contents__link toc-highlight">Basic Enumerated Facets</a></li><li><a href="#date-timeline-facets" class="table-of-contents__link toc-highlight">Date Timeline Facets</a></li><li><a href="#price-range-facets" class="table-of-contents__link toc-highlight">Price Range Facets</a></li></ul></li><li><a href="#integration-with-search" class="table-of-contents__link toc-highlight">Integration with Search</a><ul><li><a href="#combined-search-and-facets" class="table-of-contents__link toc-highlight">Combined Search and Facets</a></li><li><a href="#disjunctive-faceting-example" class="table-of-contents__link toc-highlight">Disjunctive Faceting Example</a></li></ul></li><li><a href="#schema-based-facet-configuration" class="table-of-contents__link toc-highlight">Schema-Based Facet Configuration</a><ul><li><a href="#schema-property-configuration" class="table-of-contents__link toc-highlight">Schema Property Configuration</a></li><li><a href="#automatic-facet-type-detection" class="table-of-contents__link toc-highlight">Automatic Facet Type Detection</a></li><li><a href="#schema-based-discovery-benefits" class="table-of-contents__link toc-highlight">Schema-Based Discovery Benefits</a></li><li><a href="#backend-implementation" class="table-of-contents__link toc-highlight">Backend Implementation</a></li></ul></li><li><a href="#performance-considerations" class="table-of-contents__link toc-highlight">Performance Considerations</a><ul><li><a href="#performance-impact" class="table-of-contents__link toc-highlight">Performance Impact</a></li><li><a href="#asynchronous-operations" class="table-of-contents__link toc-highlight">Asynchronous Operations</a></li><li><a href="#optimizations" class="table-of-contents__link toc-highlight">Optimizations</a></li><li><a href="#database-index-optimization" class="table-of-contents__link toc-highlight">Database Index Optimization</a></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li></ul></li><li><a href="#migration-from-legacy-system" class="table-of-contents__link toc-highlight">Migration from Legacy System</a><ul><li><a href="#old-approach" class="table-of-contents__link toc-highlight">Old Approach</a></li><li><a href="#new-approach" class="table-of-contents__link toc-highlight">New Approach</a></li><li><a href="#backward-compatibility" class="table-of-contents__link toc-highlight">Backward Compatibility</a></li></ul></li><li><a href="#ui-integration-examples" class="table-of-contents__link toc-highlight">UI Integration Examples</a><ul><li><a href="#dynamic-facet-discovery" class="table-of-contents__link toc-highlight">Dynamic Facet Discovery</a></li><li><a href="#enhanced-facet-component" class="table-of-contents__link toc-highlight">Enhanced Facet Component</a></li><li><a href="#php-controller-example" class="table-of-contents__link toc-highlight">PHP Controller Example</a></li></ul></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a><ul><li><a href="#unit-test-examples" class="table-of-contents__link toc-highlight">Unit Test Examples</a></li></ul></li><li><a href="#caching-and-label-resolution" class="table-of-contents__link toc-highlight">Caching and Label Resolution</a><ul><li><a href="#overview-1" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a></li><li><a href="#caching-strategy" class="table-of-contents__link toc-highlight">Caching Strategy</a></li><li><a href="#performance-benefits-1" class="table-of-contents__link toc-highlight">Performance Benefits</a></li><li><a href="#implementation-details" class="table-of-contents__link toc-highlight">Implementation Details</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a><ul><li><a href="#facetable-discovery-benefits" class="table-of-contents__link toc-highlight">Facetable Discovery Benefits</a></li><li><a href="#usage-recommendations" class="table-of-contents__link toc-highlight">Usage Recommendations</a></li></ul></li><li><a href="#technical-architecture" class="table-of-contents__link toc-highlight">Technical Architecture</a><ul><li><a href="#faceting-request-flow" class="table-of-contents__link toc-highlight">Faceting Request Flow</a></li><li><a href="#facet-processing-pipeline-1" class="table-of-contents__link toc-highlight">Facet Processing Pipeline</a></li><li><a href="#uuid-resolution-process" class="table-of-contents__link toc-highlight">UUID Resolution Process</a></li><li><a href="#disjunctive-faceting-implementation" class="table-of-contents__link toc-highlight">Disjunctive Faceting Implementation</a></li><li><a href="#facet-type-selection-logic" class="table-of-contents__link toc-highlight">Facet Type Selection Logic</a></li><li><a href="#caching-strategy-1" class="table-of-contents__link toc-highlight">Caching Strategy</a></li><li><a href="#performance-characteristics" class="table-of-contents__link toc-highlight">Performance Characteristics</a></li><li><a href="#code-examples" class="table-of-contents__link toc-highlight">Code Examples</a></li><li><a href="#testing-1" class="table-of-contents__link toc-highlight">Testing</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/conductionnl/openregister" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 for <a href="https://openwebconcept.nl">Open Webconcept</a> by <a href="https://conduction.nl">Conduction B.V.</a></div></div></div></footer></div>
</body>
</html>